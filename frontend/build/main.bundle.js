var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.createTemplateTagFirstArg=function(a){return a.raw=a};$jscomp.createTemplateTagFirstArgWithRaw=function(a,b){a.raw=b;return a};$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.makeIterator=function(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};
$jscomp.arrayFromIterator=function(a){for(var b,c=[];!(b=a.next()).done;)c.push(b.value);return c};$jscomp.arrayFromIterable=function(a){return a instanceof Array?a:$jscomp.arrayFromIterator($jscomp.makeIterator(a))};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;
$jscomp.objectCreate=$jscomp.ASSUME_ES5||"function"==typeof Object.create?Object.create:function(a){var b=function(){};b.prototype=a;return new b};$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){if(a==Array.prototype||a==Object.prototype)return a;a[b]=c.value;return a};
$jscomp.getGlobal=function(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<a.length;++b){var c=a[b];if(c&&c.Math==Math)return c}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};
$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(a,b){var c=$jscomp.propertyToPolyfillSymbol[b];if(null==c)return a[b];c=a[c];return void 0!==c?c:a[b]};$jscomp.polyfill=function(a,b,c,d){b&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(a,b,c,d):$jscomp.polyfillUnisolated(a,b,c,d))};
$jscomp.polyfillUnisolated=function(a,b,c,d){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];if(!(e in c))return;c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})};
$jscomp.polyfillIsolated=function(a,b,c,d){var e=a.split(".");a=1===e.length;d=e[0];d=!a&&d in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var f=0;f<e.length-1;f++){var g=e[f];if(!(g in d))return;d=d[g]}e=e[e.length-1];c=$jscomp.IS_SYMBOL_NATIVE&&"es6"===c?d[e]:null;b=b(c);null!=b&&(a?$jscomp.defineProperty($jscomp.polyfills,e,{configurable:!0,writable:!0,value:b}):b!==c&&(void 0===$jscomp.propertyToPolyfillSymbol[e]&&(c=1E9*Math.random()>>>0,$jscomp.propertyToPolyfillSymbol[e]=$jscomp.IS_SYMBOL_NATIVE?
$jscomp.global.Symbol(e):$jscomp.POLYFILL_PREFIX+c+"$"+e),$jscomp.defineProperty(d,$jscomp.propertyToPolyfillSymbol[e],{configurable:!0,writable:!0,value:b})))};
$jscomp.getConstructImplementation=function(){function a(){function c(){}new c;Reflect.construct(c,[],function(){});return new c instanceof c}if($jscomp.TRUST_ES6_POLYFILLS&&"undefined"!=typeof Reflect&&Reflect.construct){if(a())return Reflect.construct;var b=Reflect.construct;return function(c,d,e){c=b(c,d);e&&Reflect.setPrototypeOf(c,e.prototype);return c}}return function(c,d,e){void 0===e&&(e=c);e=$jscomp.objectCreate(e.prototype||Object.prototype);return Function.prototype.apply.call(c,e,d)||
e}};$jscomp.construct={valueOf:$jscomp.getConstructImplementation}.valueOf();$jscomp.underscoreProtoCanBeSet=function(){var a={a:!0},b={};try{return b.__proto__=a,b.a}catch(c){}return!1};$jscomp.setPrototypeOf=$jscomp.TRUST_ES6_POLYFILLS&&"function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null;
$jscomp.inherits=function(a,b){a.prototype=$jscomp.objectCreate(b.prototype);a.prototype.constructor=a;if($jscomp.setPrototypeOf){var c=$jscomp.setPrototypeOf;c(a,b)}else for(c in b)if("prototype"!=c)if(Object.defineProperties){var d=Object.getOwnPropertyDescriptor(b,c);d&&Object.defineProperty(a,c,d)}else a[c]=b[c];a.superClass_=b.prototype};$jscomp.generator={};
$jscomp.generator.ensureIteratorResultIsObject_=function(a){if(!(a instanceof Object))throw new TypeError("Iterator result "+a+" is not an object");};$jscomp.generator.Context=function(){this.isRunning_=!1;this.yieldAllIterator_=null;this.yieldResult=void 0;this.nextAddress=1;this.finallyAddress_=this.catchAddress_=0;this.finallyContexts_=this.abruptCompletion_=null};
$jscomp.generator.Context.prototype.start_=function(){if(this.isRunning_)throw new TypeError("Generator is already running");this.isRunning_=!0};$jscomp.generator.Context.prototype.stop_=function(){this.isRunning_=!1};$jscomp.generator.Context.prototype.jumpToErrorHandler_=function(){this.nextAddress=this.catchAddress_||this.finallyAddress_};$jscomp.generator.Context.prototype.next_=function(a){this.yieldResult=a};
$jscomp.generator.Context.prototype.throw_=function(a){this.abruptCompletion_={exception:a,isException:!0};this.jumpToErrorHandler_()};$jscomp.generator.Context.prototype.return=function(a){this.abruptCompletion_={return:a};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.jumpThroughFinallyBlocks=function(a){this.abruptCompletion_={jumpTo:a};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.yield=function(a,b){this.nextAddress=b;return{value:a}};
$jscomp.generator.Context.prototype.yieldAll=function(a,b){a=$jscomp.makeIterator(a);var c=a.next();$jscomp.generator.ensureIteratorResultIsObject_(c);if(c.done)this.yieldResult=c.value,this.nextAddress=b;else return this.yieldAllIterator_=a,this.yield(c.value,b)};$jscomp.generator.Context.prototype.jumpTo=function(a){this.nextAddress=a};$jscomp.generator.Context.prototype.jumpToEnd=function(){this.nextAddress=0};
$jscomp.generator.Context.prototype.setCatchFinallyBlocks=function(a,b){this.catchAddress_=a;void 0!=b&&(this.finallyAddress_=b)};$jscomp.generator.Context.prototype.setFinallyBlock=function(a){this.catchAddress_=0;this.finallyAddress_=a||0};$jscomp.generator.Context.prototype.leaveTryBlock=function(a,b){this.nextAddress=a;this.catchAddress_=b||0};
$jscomp.generator.Context.prototype.enterCatchBlock=function(a){this.catchAddress_=a||0;a=this.abruptCompletion_.exception;this.abruptCompletion_=null;return a};$jscomp.generator.Context.prototype.enterFinallyBlock=function(a,b,c){c?this.finallyContexts_[c]=this.abruptCompletion_:this.finallyContexts_=[this.abruptCompletion_];this.catchAddress_=a||0;this.finallyAddress_=b||0};
$jscomp.generator.Context.prototype.leaveFinallyBlock=function(a,b){b=this.finallyContexts_.splice(b||0)[0];if(b=this.abruptCompletion_=this.abruptCompletion_||b){if(b.isException)return this.jumpToErrorHandler_();void 0!=b.jumpTo&&this.finallyAddress_<b.jumpTo?(this.nextAddress=b.jumpTo,this.abruptCompletion_=null):this.nextAddress=this.finallyAddress_}else this.nextAddress=a};$jscomp.generator.Context.prototype.forIn=function(a){return new $jscomp.generator.Context.PropertyIterator(a)};
$jscomp.generator.Context.PropertyIterator=function(a){this.object_=a;this.properties_=[];for(var b in a)this.properties_.push(b);this.properties_.reverse()};$jscomp.generator.Context.PropertyIterator.prototype.getNext=function(){for(;0<this.properties_.length;){var a=this.properties_.pop();if(a in this.object_)return a}return null};$jscomp.generator.Engine_=function(a){this.context_=new $jscomp.generator.Context;this.program_=a};
$jscomp.generator.Engine_.prototype.next_=function(a){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_.next,a,this.context_.next_);this.context_.next_(a);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.return_=function(a){this.context_.start_();var b=this.context_.yieldAllIterator_;if(b)return this.yieldAllStep_("return"in b?b["return"]:function(c){return{value:c,done:!0}},a,this.context_.return);this.context_.return(a);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.throw_=function(a){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_["throw"],a,this.context_.next_);this.context_.throw_(a);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.yieldAllStep_=function(a,b,c){try{var d=a.call(this.context_.yieldAllIterator_,b);$jscomp.generator.ensureIteratorResultIsObject_(d);if(!d.done)return this.context_.stop_(),d;var e=d.value}catch(f){return this.context_.yieldAllIterator_=null,this.context_.throw_(f),this.nextStep_()}this.context_.yieldAllIterator_=null;c.call(this.context_,e);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.nextStep_=function(){for(;this.context_.nextAddress;)try{var a=this.program_(this.context_);if(a)return this.context_.stop_(),{value:a.value,done:!1}}catch(b){this.context_.yieldResult=void 0,this.context_.throw_(b)}this.context_.stop_();if(this.context_.abruptCompletion_){a=this.context_.abruptCompletion_;this.context_.abruptCompletion_=null;if(a.isException)throw a.exception;return{value:a.return,done:!0}}return{value:void 0,done:!0}};
$jscomp.generator.Generator_=function(a){this.next=function(b){return a.next_(b)};this.throw=function(b){return a.throw_(b)};this.return=function(b){return a.return_(b)};this[Symbol.iterator]=function(){return this}};$jscomp.generator.createGenerator=function(a,b){b=new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(b));$jscomp.setPrototypeOf&&a.prototype&&$jscomp.setPrototypeOf(b,a.prototype);return b};
$jscomp.asyncExecutePromiseGenerator=function(a){function b(d){return a.next(d)}function c(d){return a.throw(d)}return new Promise(function(d,e){function f(g){g.done?d(g.value):Promise.resolve(g.value).then(b,c).then(f,e)}f(a.next())})};$jscomp.asyncExecutePromiseGeneratorFunction=function(a){return $jscomp.asyncExecutePromiseGenerator(a())};$jscomp.asyncExecutePromiseGeneratorProgram=function(a){return $jscomp.asyncExecutePromiseGenerator(new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(a)))};
$jscomp.polyfill("Reflect",function(a){return a?a:{}},"es6","es3");$jscomp.polyfill("Reflect.construct",function(a){return $jscomp.construct},"es6","es3");$jscomp.polyfill("Reflect.setPrototypeOf",function(a){if(a)return a;if($jscomp.setPrototypeOf){var b=$jscomp.setPrototypeOf;return function(c,d){try{return b(c,d),!0}catch(e){return!1}}}return null},"es6","es5");$jscomp.initSymbol=function(){};
$jscomp.polyfill("Symbol",function(a){if(a)return a;var b=function(f,g){this.$jscomp$symbol$id_=f;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:g})};b.prototype.toString=function(){return this.$jscomp$symbol$id_};var c="jscomp_symbol_"+(1E9*Math.random()>>>0)+"_",d=0,e=function(f){if(this instanceof e)throw new TypeError("Symbol is not a constructor");return new b(c+(f||"")+"_"+d++,f)};return e},"es6","es3");
$jscomp.polyfill("Symbol.iterator",function(a){if(a)return a;a=Symbol("Symbol.iterator");for(var b="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),c=0;c<b.length;c++){var d=$jscomp.global[b[c]];"function"===typeof d&&"function"!=typeof d.prototype[a]&&$jscomp.defineProperty(d.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}})}return a},"es6",
"es3");$jscomp.iteratorPrototype=function(a){a={next:a};a[Symbol.iterator]=function(){return this};return a};
$jscomp.polyfill("Promise",function(a){function b(){this.batch_=null}function c(g){return g instanceof e?g:new e(function(h,k){h(g)})}if(a&&(!($jscomp.FORCE_POLYFILL_PROMISE||$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION&&"undefined"===typeof $jscomp.global.PromiseRejectionEvent)||!$jscomp.global.Promise||-1===$jscomp.global.Promise.toString().indexOf("[native code]")))return a;b.prototype.asyncExecute=function(g){if(null==this.batch_){this.batch_=[];var h=this;this.asyncExecuteFunction(function(){h.executeBatch_()})}this.batch_.push(g)};
var d=$jscomp.global.setTimeout;b.prototype.asyncExecuteFunction=function(g){d(g,0)};b.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var g=this.batch_;this.batch_=[];for(var h=0;h<g.length;++h){var k=g[h];g[h]=null;try{k()}catch(l){this.asyncThrow_(l)}}}this.batch_=null};b.prototype.asyncThrow_=function(g){this.asyncExecuteFunction(function(){throw g;})};var e=function(g){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];this.isRejectionHandled_=!1;var h=this.createResolveAndReject_();
try{g(h.resolve,h.reject)}catch(k){h.reject(k)}};e.prototype.createResolveAndReject_=function(){function g(l){return function(m){k||(k=!0,l.call(h,m))}}var h=this,k=!1;return{resolve:g(this.resolveTo_),reject:g(this.reject_)}};e.prototype.resolveTo_=function(g){if(g===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(g instanceof e)this.settleSameAsPromise_(g);else{a:switch(typeof g){case "object":var h=null!=g;break a;case "function":h=!0;break a;default:h=!1}h?this.resolveToNonPromiseObj_(g):
this.fulfill_(g)}};e.prototype.resolveToNonPromiseObj_=function(g){var h=void 0;try{h=g.then}catch(k){this.reject_(k);return}"function"==typeof h?this.settleSameAsThenable_(h,g):this.fulfill_(g)};e.prototype.reject_=function(g){this.settle_(2,g)};e.prototype.fulfill_=function(g){this.settle_(1,g)};e.prototype.settle_=function(g,h){if(0!=this.state_)throw Error("Cannot settle("+g+", "+h+"): Promise already settled in state"+this.state_);this.state_=g;this.result_=h;2===this.state_&&this.scheduleUnhandledRejectionCheck_();
this.executeOnSettledCallbacks_()};e.prototype.scheduleUnhandledRejectionCheck_=function(){var g=this;d(function(){if(g.notifyUnhandledRejection_()){var h=$jscomp.global.console;"undefined"!==typeof h&&h.error(g.result_)}},1)};e.prototype.notifyUnhandledRejection_=function(){if(this.isRejectionHandled_)return!1;var g=$jscomp.global.CustomEvent,h=$jscomp.global.Event,k=$jscomp.global.dispatchEvent;if("undefined"===typeof k)return!0;"function"===typeof g?g=new g("unhandledrejection",{cancelable:!0}):
"function"===typeof h?g=new h("unhandledrejection",{cancelable:!0}):(g=$jscomp.global.document.createEvent("CustomEvent"),g.initCustomEvent("unhandledrejection",!1,!0,g));g.promise=this;g.reason=this.result_;return k(g)};e.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var g=0;g<this.onSettledCallbacks_.length;++g)f.asyncExecute(this.onSettledCallbacks_[g]);this.onSettledCallbacks_=null}};var f=new b;e.prototype.settleSameAsPromise_=function(g){var h=this.createResolveAndReject_();
g.callWhenSettled_(h.resolve,h.reject)};e.prototype.settleSameAsThenable_=function(g,h){var k=this.createResolveAndReject_();try{g.call(h,k.resolve,k.reject)}catch(l){k.reject(l)}};e.prototype.then=function(g,h){function k(q,n){return"function"==typeof q?function(u){try{l(q(u))}catch(r){m(r)}}:n}var l,m,p=new e(function(q,n){l=q;m=n});this.callWhenSettled_(k(g,l),k(h,m));return p};e.prototype.catch=function(g){return this.then(void 0,g)};e.prototype.callWhenSettled_=function(g,h){function k(){switch(l.state_){case 1:g(l.result_);
break;case 2:h(l.result_);break;default:throw Error("Unexpected state: "+l.state_);}}var l=this;null==this.onSettledCallbacks_?f.asyncExecute(k):this.onSettledCallbacks_.push(k);this.isRejectionHandled_=!0};e.resolve=c;e.reject=function(g){return new e(function(h,k){k(g)})};e.race=function(g){return new e(function(h,k){for(var l=$jscomp.makeIterator(g),m=l.next();!m.done;m=l.next())c(m.value).callWhenSettled_(h,k)})};e.all=function(g){var h=$jscomp.makeIterator(g),k=h.next();return k.done?c([]):new e(function(l,
m){function p(u){return function(r){q[u]=r;n--;0==n&&l(q)}}var q=[],n=0;do q.push(void 0),n++,c(k.value).callWhenSettled_(p(q.length-1),m),k=h.next();while(!k.done)})};return e},"es6","es3");$jscomp.checkStringArgs=function(a,b,c){if(null==a)throw new TypeError("The 'this' value for String.prototype."+c+" must not be null or undefined");if(b instanceof RegExp)throw new TypeError("First argument to String.prototype."+c+" must not be a regular expression");return a+""};
$jscomp.polyfill("String.prototype.repeat",function(a){return a?a:function(b){var c=$jscomp.checkStringArgs(this,null,"repeat");if(0>b||1342177279<b)throw new RangeError("Invalid count value");b|=0;for(var d="";b;)if(b&1&&(d+=c),b>>>=1)c+=c;return d}},"es6","es3");$jscomp.polyfill("Number.isFinite",function(a){return a?a:function(b){return"number"!==typeof b?!1:!isNaN(b)&&Infinity!==b&&-Infinity!==b}},"es6","es3");$jscomp.owns=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)};
$jscomp.polyfill("Object.entries",function(a){return a?a:function(b){var c=[],d;for(d in b)$jscomp.owns(b,d)&&c.push([d,b[d]]);return c}},"es8","es3");$jscomp.findInternal=function(a,b,c){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var f=a[e];if(b.call(c,f,e,a))return{i:e,v:f}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(b,c){return $jscomp.findInternal(this,b,c).v}},"es6","es3");
$jscomp.polyfill("String.prototype.matchAll",function(a){return a?a:function(b){if(b instanceof RegExp&&!b.global)throw new TypeError("RegExp passed into String.prototype.matchAll() must have global tag.");var c=new RegExp(b,b instanceof RegExp?void 0:"g"),d=this,e=!1,f={next:function(){if(e)return{value:void 0,done:!0};var g=c.exec(d);if(!g)return e=!0,{value:void 0,done:!0};""===g[0]&&(c.lastIndex+=1);return{value:g,done:!1}}};f[Symbol.iterator]=function(){return f};return f}},"es_2020","es3");
$jscomp.polyfill("Number.isNaN",function(a){return a?a:function(b){return"number"===typeof b&&isNaN(b)}},"es6","es3");$jscomp.polyfill("Array.prototype.findIndex",function(a){return a?a:function(b,c){return $jscomp.findInternal(this,b,c).i}},"es6","es3");var buildvers="0.7.7",builddate="2021.10.03",devmode=!1,traceajax=function(){};String.prototype.format||(String.prototype.format=function(){var a=arguments;return this.replace(/{(\d+)}/g,function(b,c){return"undefined"!==typeof a[c]?a[c]:b})});
String.prototype.printf||(String.prototype.printf=function(){var a=Array.prototype.slice.call(arguments),b=-1;return this.replace(/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g,function(c,d,e,f,g,h){if("%%"===c)return"%";if(void 0!==a[++b]){c=f?parseInt(f.substr(1)):void 0;f=g?parseInt(g.substr(1)):void 0;switch(h){case "s":var k=a[b];break;case "c":k=a[b][0];break;case "f":k=parseFloat(a[b]).toFixed(c);break;case "p":k=parseFloat(a[b]).toPrecision(c);break;case "e":k=parseFloat(a[b]).toExponential(c);
break;case "x":k=parseInt(a[b]).toString(f?f:16);break;case "d":k=parseFloat(parseInt(a[b],f?f:10).toPrecision(c)).toFixed(0)}k="object"===typeof k?JSON.stringify(k):k.toString(f);c=parseInt(e);for(e=e&&"0"===e[0]?"0":" ";k.length<c;)k=void 0!==d?k+e:e+k;return k}})});
var pathjoin=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];return b.map(function(d,e){return 0===e?d.trim().replace(/[\/]*$/g,""):d.trim().replace(/(^[\/]*|[\/]*$)/g,"")}).filter(function(d){return d.length}).join("/")},pathext=function(a){return a.substr(a.lastIndexOf(".")).toLowerCase()},fmtfilesize=function(a){return 1536>a?a+" bytes":1048576>a?(a/1024).toPrecision(3)+" kB":1073741824>a?(a/1048576).toPrecision(3)+" MB":1099511627776>a?(a/1073741824).toPrecision(3)+" GB":
(a/1099511627776).toPrecision(3)+" TB"},fmtitemsize=function(a){return 1536>a?fmtfilesize(a):"%s (%d bytes)".printf(fmtfilesize(a),a)},fmttime=function(a,b){var c=function(e,f){e=Math.floor(e).toString();f-=e.length;return 0<f?"0".repeat(f)+e:e};if(Number.isFinite(a)){if(60>b)return c(a,2);if(3600>b)return b=a%60,c(a/60,2)+":"+c(b,2);b=a%60;var d=a%3600/60;return c(a/3600,2)+":"+c(d,2)+":"+c(b,2)}return"unknown"},makestrid=function(a){for(var b="",c=0;c<a;c++)b+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(62*
Math.random()));return b},makeeventhub=function(){var a=[];return{emit:function(b,c){for(var d=[],e=1;e<arguments.length;++e)d[e-1]=arguments[e];for(e=a.length;0<e;){var f=$jscomp.makeIterator(a[--e]),g=f.next().value,h=f.next().value;f=f.next().value;g===b&&(f&&a.splice(e,1),h.apply(null,$jscomp.arrayFromIterable(d)))}},on:function(b,c,d){return a.push([b,c,void 0===d?!1:d])},once:function(b,c){return a.push([b,c,!0])},off:function(b,c){for(var d=a.length;0<d;){var e=$jscomp.makeIterator(a[--d]),
f=e.next().value;e=e.next().value;f!==b&&b||e!==c&&c||a.splice(d,1)}},onmap:function(b){b=$jscomp.makeIterator(Object.entries(b));for(var c=b.next();!c.done;c=b.next()){var d=$jscomp.makeIterator(c.value);c=d.next().value;d=d.next().value;a.push([c,d,!1])}},offmap:function(b){b=$jscomp.makeIterator(Object.entries(b));for(var c=b.next();!c.done;c=b.next()){var d=$jscomp.makeIterator(c.value);c=d.next().value;d=d.next().value;for(var e=a.length;0<e;){var f=$jscomp.makeIterator(a[--e]),g=f.next().value;
f=f.next().value;if(g===c&&f===d){a.splice(e,1);break}}}},listens:function(b,c){for(var d=0,e=$jscomp.makeIterator(a),f=e.next();!f.done;f=e.next()){var g=$jscomp.makeIterator(f.value);f=g.next().value;g=g.next().value;f!==b&&b||g!==c&&c||d++}return d},len:function(){return a.length}}},extend=function(a,b){for(var c in b)a[c]=b[c];return a};var eventHub=makeeventhub(),auth={token:{access:null,refrsh:null},login:"",signed:function(){return!!this.token.access},claims:function(){try{var a=this.token.access.split(".");return JSON.parse(atob(a[1]))}catch(b){return null}},signin:function(a,b){sessionStorage.setItem("token",JSON.stringify(a));this.token.access=a.access;this.token.refrsh=a.refrsh;b&&(sessionStorage.setItem("login",b),this.login=b);eventHub.emit("auth",!0)},signout:function(){sessionStorage.removeItem("token");this.token.access=
null;this.token.refrsh=null;eventHub.emit("auth",!1)},signload:function(){try{var a=JSON.parse(sessionStorage.getItem("token"));this.token.access=a.access;this.token.refrsh=a.refrsh;var b;this.login=null!=(b=sessionStorage.getItem("login"))?b:"";eventHub.emit("auth",!0)}catch(c){this.token.access=null,this.token.refrsh=null,this.login="",eventHub.emit("auth",!1)}}},HttpError=function(a,b){var c=Error.call(this,b.what);this.message=c.message;"stack"in c&&(this.stack=c.stack);this.name="HttpError";
this.status=a;extend(this,b)};$jscomp.inherits(HttpError,Error);
var ajaxheader=function(a){var b={Accept:"application/json;charset=utf-8","Content-Type":"application/json;charset=utf-8"};a&&auth.token.access&&(b.Authorization="Bearer "+auth.token.access);return b},fetchjson=function(a,b,c){return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){return 1==d.nextAddress?d.yield(fetch(b,{method:a,headers:ajaxheader(!1),body:JSON.stringify(c)}),2):d.return(d.yieldResult)})},fetchajax=function(a,b,c){var d,e;return $jscomp.asyncExecutePromiseGeneratorProgram(function(f){if(1==
f.nextAddress)return f.yield(fetch(b,{method:a,headers:ajaxheader(!1),body:c&&JSON.stringify(c)}),2);if(3!=f.nextAddress)return e=d=f.yieldResult,f.yield(d.json(),3);e.data=f.yieldResult;return f.return(d)})},fetchjsonauth=function(a,b,c){var d,e,f,g;return $jscomp.asyncExecutePromiseGeneratorProgram(function(h){switch(h.nextAddress){case 1:return h.yield(fetch(b,{method:a,headers:ajaxheader(!0),body:c&&JSON.stringify(c)}),2);case 2:d=h.yieldResult;if(401!==d.status||!auth.token.refrsh){h.jumpTo(3);
break}return h.yield(fetchjson("POST","/api/auth/refrsh",{refrsh:auth.token.refrsh}),4);case 4:return e=h.yieldResult,h.yield(e.json(),5);case 5:f=h.yieldResult;if(!e.ok)throw new HttpError(e.status,f);auth.signin(f);g=fetch(b,{method:a,headers:ajaxheader(!0),body:c&&JSON.stringify(c)});return h.return(g);case 3:return h.return(d)}})},fetchajaxauth=function(a,b,c){var d,e;return $jscomp.asyncExecutePromiseGeneratorProgram(function(f){if(1==f.nextAddress)return f.yield(fetchjsonauth(a,b,c),2);if(3!=
f.nextAddress)return e=d=f.yieldResult,f.yield(d.json(),3);e.data=f.yieldResult;return f.return(d)})},loadcount=1,viewpreloader=function(a){loadcount+=a;if(a=document.querySelector(".preloader-lock"))a.style.display=0<loadcount?"":"none"};var isMainImage=function(a){return{".tga":!0,".bmp":!0,".dib":!0,".rle":!0,".dds":!0,".tif":!0,".tiff":!0,".jpg":!0,".jpe":!0,".jpeg":!0,".jfif":!0,".gif":!0,".png":!0,".webp":!0,".psd":!0,".psb":!0}[a]},isMainAudio=function(a){return{".wav":!0,".flac":!0,".mp3":!0,".ogg":!0,".opus":!0,".acc":!0,".m4a":!0,".alac":!0}[a]},isMainVideo=function(a){return{".mp4":!0,".webm":!0}[a]},imagefilter=function(a){return!a.type&&a.size&&isMainImage(pathext(a.name))},audiofilter=function(a){return!a.type&&a.size&&
isMainAudio(pathext(a.name))},videofilter=function(a){return!a.type&&a.size&&isMainVideo(pathext(a.name))},iconwebp=function(a){a=geticonpath(a);return(a.org||a.alt)+".webp"},iconpng=function(a){a=geticonpath(a);return(a.org||a.alt)+".png"},filehint=function(a){var b=[];b.push(a.name);if(!a.type){var c;b.push("size: "+fmtitemsize(null!=(c=a.size)?c:0))}a.time&&b.push("time: "+(new Date(a.time)).toLocaleString());a.title&&b.push("title: "+a.title);a.album&&b.push("album: "+a.album);a.artist&&b.push("artist: "+
a.artist);a.composer&&b.push("composer: "+a.composer);a.genre&&b.push("genre: "+a.genre);a.year&&b.push("year: "+a.year);var d;if(a.track&&(null!=(d=a.track.number)?d:a.track.total)){var e,f;b.push("track: "+(null!=(e=a.track.number)?e:"")+"/"+(null!=(f=a.track.total)?f:""))}var g;if(a.disc&&(null!=(g=a.disc.number)?g:a.disc.total)){var h,k;b.push("disc: "+(null!=(h=a.disc.number)?h:"")+"/"+(null!=(k=a.disc.total)?k:""))}a.comment&&b.push("comment: "+a.comment.substring(0,80));a.width&&a.height&&
b.push("resolution: "+a.width+"x"+a.height);a.model&&b.push("model: "+a.model);a.make&&b.push("manufacturer: "+a.make);a.datetime&&b.push("photo taken: "+(new Date(a.datetime)).toLocaleString());if(a.orientation)switch(a.orientation){case 1:b.push("orientation: normal");break;case 2:b.push("orientation: horizontal reversed");break;case 3:b.push("orientation: flipped");break;case 4:b.push("orientation: flipped & horizontal reversed");break;case 5:b.push("orientation: clockwise turned & horizontal reversed");
break;case 6:b.push("orientation: clockwise turned");break;case 7:b.push("orientation: anticlockwise turned & horizontal reversed");break;case 8:b.push("orientation: anticlockwise turned")}if(a.exposureprog)switch(a.exposureprog){case 1:b.push("exposure program: manual");break;case 2:b.push("exposure program: normal program");break;case 3:b.push("exposure program: aperture priority");break;case 4:b.push("exposure program: shutter priority");break;case 5:b.push("exposure program: creative program (depth of field)");
break;case 6:b.push("exposure program: action program (fast shutter speed)");break;case 7:b.push("exposure program: portrait mode (background out of focus)");break;case 8:b.push("exposure program: landscape mode (background in focus)")}a.exposuretime&&b.push("exposure time: "+a.exposuretime+" sec");a.fnumber&&b.push("F-number: f/"+a.fnumber);a.isospeed&&b.push("ISO speed rating: ISO-"+a.isospeed);a.shutterspeed&&b.push("shutter speed: "+a.shutterspeed);a.aperture&&b.push("lens aperture: "+a.aperture);
a.exposurebias&&b.push("exposure bias: "+a.exposurebias);if(a.lightsource)switch(a.lightsource){case 1:b.push("light source: daylight");break;case 2:b.push("light source: fluorescent");break;case 3:b.push("light source: tungsten (incandescent light)");break;case 4:b.push("light source: flash");break;case 9:b.push("light source: fine weather");break;case 10:b.push("light source: cloudy weather");break;case 11:b.push("light source: shade");break;case 12:b.push("light source: daylight fluorescent (D 5700-7100K)");
break;case 13:b.push("light source: day white fluorescent (N 4600-5700K)");break;case 14:b.push("light source: cool white fluorescent (W 3800-4600K)");break;case 15:b.push("light source: white fluorescent (WW 3250-3800K)");break;case 16:b.push("light source: warm white fluorescent (L 2600-3250K)");break;case 17:b.push("light source: standard light A");break;case 18:b.push("light source: standard light B");break;case 19:b.push("light source: standard light C");break;case 20:b.push("light source: D55");
break;case 21:b.push("light source: D65");break;case 22:b.push("light source: D75");break;case 23:b.push("light source: D50");break;case 24:b.push("light source: ISO studio tungsten");break;case 255:b.push("light source: other light source");break;default:b.push("light source: light code #"+a.lightsource)}a.focal&&b.push("focal length: "+a.focal+" mm");a.focal35mm&&b.push("35mm equivalent focal length: "+a.focal35mm+" mm");a.digitalzoom&&b.push("digital zoom ratio: "+a.digitalzoom);a.flash&&(a.flash&
1?b.push("flash fired"):b.push("flash did not fire"),4===(a.flash&6)?b.push("strobe return light: not detected"):6===(a.flash&6)&&b.push("strobe return light: detected"),8===(a.flash&24)?b.push("flash mode: compulsory flash firing"):16===(a.flash&24)?b.push("flash mode: compulsory flash suppression"):24===(a.flash&24)&&b.push("flash mode: auto"),a.flash&64&&b.push("red-eye reduction supported"));a.uniqueid&&b.push("unique ID: "+a.uniqueid);return b},VueIcon={template:"#icon-tpl",props:["file","clsimg"],
data:function(){return{iconfmt:[],tm:!0}},computed:{fmtalt:function(){return pathext(this.file.name)},isthumb:function(){return 1===this.file.ntmb&&this.tm},iconsrc:function(){var a=geticonpath(this.file);return a.org||a.alt},iconthumb:function(){return"/id"+this.$root.aid+"/thumb/"+this.file.puid}},methods:{onselect:function(){eventHub.emit("select",this.file)},onopen:function(){eventHub.emit("open",this.file)},_iconset:function(a){this.iconfmt=a.iconfmt},_thumbmode:function(a){this.tm=a}},created:function(){this.iconfmt=
iconmapping.iconfmt;this.tm=thumbmode;eventHub.on("iconset",this._iconset);eventHub.on("thumbmode",this._thumbmode)},unmounted:function(){eventHub.off("iconset",this._iconset);eventHub.off("thumbmode",this._thumbmode)}},VueFileIcon={template:"#file-icon-tpl",props:["file","size"],data:function(){return{iconfmt:[],tm:!0}},computed:{fmttitle:function(){return filehint(this.file).join("\n")},label:function(){if(1===this.file.ntmb&&this.tm||!geticonpath(this.file).org)return this.file.shared?iconmapping.shared.label:
iconmapping.private.label},clsimgwdh:function(){switch(this.size){case "smicon":return"smimgw";case "mdicon":return"mdimgw";case "lgicon":return"lgimgw"}},clsimage:function(){switch(this.size){case "smicon":return"smimgw smimgh";case "mdicon":return"mdimgw mdimgh";case "lgicon":return"lgimgw lgimgh"}},itemview:function(){return{selected:this.file.selected}}},methods:{onselect:function(){eventHub.emit("select",this.file)},onopen:function(){eventHub.emit("open",this.file)},_iconset:function(a){this.iconfmt=
a.iconfmt},_thumbmode:function(a){this.tm=a}},created:function(){this.iconfmt=iconmapping.iconfmt;this.tm=thumbmode;eventHub.on("iconset",this._iconset);eventHub.on("thumbmode",this._thumbmode)},unmounted:function(){eventHub.off("iconset",this._iconset);eventHub.off("thumbmode",this._thumbmode)}},VueImgIcon={template:"#img-icon-tpl",props:["file"],data:function(){return{iconfmt:[],tm:!0}},computed:{fmttitle:function(){return filehint(this.file).join("\n")},label:function(){if(1===this.file.ntmb&&
this.tm||!geticonpath(this.file).org)return this.file.shared?iconmapping.shared.label:iconmapping.private.label},itemview:function(){return{selected:this.file.selected}}},methods:{onselect:function(){eventHub.emit("select",this.file)},onopen:function(){eventHub.emit("open",this.file)},_iconset:function(a){this.iconfmt=a.iconfmt},_thumbmode:function(a){this.tm=a}},created:function(){this.iconfmt=iconmapping.iconfmt;this.tm=thumbmode;eventHub.on("iconset",this._iconset);eventHub.on("thumbmode",this._thumbmode)},
unmounted:function(){eventHub.off("iconset",this._iconset);eventHub.off("thumbmode",this._thumbmode)}};var sortmodeicon={byalpha:"sort_by_alpha",bysize:"sort",unsorted:"reorder"},sortmodehint={byalpha:"sort by alpha",bysize:"sort by size",unsorted:"as is unsorted"},listmodetag={smicon:"file-icon-tag",mdicon:"file-icon-tag",lgicon:"img-icon-tag"},listmoderow={smicon:"align-items-start",mdicon:"align-items-start",lgicon:"align-items-center"},listmodeicon={smicon:"format_align_justify",mdicon:"view_comfy",lgicon:"view_module"},listmodehint={smicon:"small icons",mdicon:"middle icons",lgicon:"large icons"},
noderadius=15,gpxcolors="#6495ED #DA70D6 #DAA520 #9370DB #DB7093 #8FBC8F #FF7F50 #9ACD32 #BC8F8F #5F9EA0 #778899 #F4A460 #FA8072 #20B2AA #4169E1".split(" "),copyTextToClipboard=function(a){var b=document.createElement("textarea");b.value=a;b.style.position="fixed";b.style.left="0px";b.style.top="0px";document.body.appendChild(b);b.focus();b.select();try{return!document.execCommand("copy")&&"copying text command was failed"}catch(c){return c}finally{document.body.removeChild(b)}},isFullscreen=function(){return document.fullscreenElement||
document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement},openFullscreen=function(a){a.requestFullscreen?a.requestFullscreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.webkitRequestFullscreen?a.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT):a.msRequestFullscreen&&a.msRequestFullscreen()},closeFullscreen=function(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?
document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()},makemarkericon=function(a){var b=geticonpath(a);b=b.org||b.alt;var c="";if(1===a.ntmb&&thumbmode)c='<source srcset="/id'+appvm.aid+"/thumb/"+a.puid+'" type="'+a.mtmb+'">';else{a=$jscomp.makeIterator(iconmapping.iconfmt);for(var d=a.next();!d.done;d=a.next())fmt=d.value,c+='<source srcset="'+(b+fmt.ext)+'" type="'+fmt.mime+'">'}return'\n<div class="position-relative">\n\t<picture>\n\t\t'+c+'\n\t\t<img class="position-absolute top-50 start-50 translate-middle w-100">\n\t</picture>\n</div>\n'},
makemarkerpopup=function(a){var b=geticonpath(a);b=b.org||b.alt;var c="";if(1===a.ntmb&&thumbmode)c='<source srcset="/id'+appvm.aid+"/thumb/"+a.puid+'" type="'+a.mtmb+'">';else for(var d=$jscomp.makeIterator(iconmapping.iconfmt),e=d.next();!e.done;e=d.next())fmt=e.value,c+='<source srcset="'+(b+fmt.ext)+'" type="'+fmt.mime+'">';var f;return'\n<div class="photoinfo">\n\t<ul class="nav nav-tabs" role="tablist">\n\t\t<li class="nav-item"><a class="nav-link active" data-bs-toggle="tab" href="#pict">Thumbnail</a></li>\n\t\t<li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#prop">Properties</a></li>\n\t</ul>\n\t<div class="tab-content">\n\t\t<div class="tab-pane active" id="pict">\n\t\t\t<picture>\n\t\t\t\t'+
c+'\n\t\t\t\t<img class="rounded thumb" alt="'+a.name+'">\n\t\t\t</picture>\n\t\t\t<div class="d-flex flex-wrap latlng">\n\t\t\t\t<div><div class="name">lat:</div> <div class="value">'+a.latitude.toFixed(6)+'</div></div>\n\t\t\t\t<div><div class="name">lng:</div> <div class="value">'+a.longitude.toFixed(6)+'</div></div>\n\t\t\t\t<div><div class="name">alt:</div> <div class="value">'+(null!=(f=a.altitude)?f:"N/A")+'</div></div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="tab-pane fade" id="prop">\n\t\t\t<ul class="prop p-0 m-0"><li>'+
filehint(a).join("</li><li>")+"</li></ul>\n\t\t</div>\n\t</div>\n</div>\n"},VueDirCard={template:"#dir-card-tpl",props:["list"],data:function(){return{isauth:!1,sortorder:1,listmode:"smicon",iid:makestrid(10)}},computed:{isadmin:function(){return this.isauth||"localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname},isvisible:function(){return 0<this.list.length},sortable:function(){for(var a=$jscomp.makeIterator(this.list),b=a.next();!b.done;b=a.next())if(b.value.type===FT.ctgr)return!1;
return!0},sortedlist:function(){var a=this;return this.sortable?this.list.slice().sort(function(b,c){return a.sortorder*(b.name.toLowerCase()>c.name.toLowerCase()?1:-1)}):this.list},clsfilelist:function(){return listmoderow[this.listmode]},clsorder:function(){return 0<this.sortorder?"arrow_downward":"arrow_upward"},clslistmode:function(){return listmodeicon[this.listmode]},iconmodetag:function(){return listmodetag[this.listmode]},hintorder:function(){return 0<this.sortorder?"direct order":"reverse order"},
hintlist:function(){return listmodehint[this.listmode]}},methods:{authclosure:function(a){this.isauth=a},onorder:function(){this.sortorder=-this.sortorder},onlistmodesm:function(){this.listmode="smicon"},onlistmodemd:function(){this.listmode="mdicon"},onlistmodelg:function(){this.listmode="lgicon"},onunselect:function(){eventHub.emit("select",null)}},created:function(){eventHub.on("auth",this.authclosure)},unmounted:function(){eventHub.off("auth",this.authclosure)}},VueFileCard={template:"#file-card-tpl",
props:["list"],data:function(){return{isauth:!1,sortorder:1,sortmode:"byalpha",listmode:"smicon",thumbmode:!0,fgshow:[!1,!0,!0,!0,!0,!0,!0,!0],audioonly:!1,iid:makestrid(10)}},watch:{fgshow:{handler:function(a,b){console.log("fgshow changed")},deep:!0}},computed:{isadmin:function(){return this.isauth||"localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname},isvisible:function(){return 0<this.list.length},filelist:function(){for(var a=this,b=[],c=$jscomp.makeIterator(this.list),
d=c.next();!d.done;d=c.next())d=d.value,this.fgshow[getFileGroup(d)]&&b.push(d);"byalpha"===this.sortmode?b.sort(function(e,f){return a.sortorder*(e.name.toLowerCase()>f.name.toLowerCase()?1:-1)}):"bysize"===this.sortmode&&b.sort(function(e,f){return e.size===f.size?a.sortorder*(e.name.toLowerCase()>f.name.toLowerCase()?1:-1):a.sortorder*(e.size>f.size?1:-1)});eventHub.emit("playlist",b);return b},clsfilelist:function(){return listmoderow[this.listmode]},clsorder:function(){return 0<this.sortorder?
"arrow_downward":"arrow_upward"},clssortmode:function(){return sortmodeicon[this.sortmode]},clslistmode:function(){return listmodeicon[this.listmode]},showmusic:function(){return!!this.list.find(function(a){return extfmt.audio[pathext(a.name)]})},showvideo:function(){return!!this.list.find(function(a){return extfmt.video[pathext(a.name)]})},showphoto:function(){return!!this.list.find(function(a){return extfmt.image[pathext(a.name)]})},showbooks:function(){return!!this.list.find(function(a){return extfmt.books[pathext(a.name)]})},
showtexts:function(){return!!this.list.find(function(a){return extfmt.texts[pathext(a.name)]})},showpacks:function(){return!!this.list.find(function(a){return extfmt.packs[pathext(a.name)]})},showother:function(){return!!this.list.find(function(a){return getFileGroup(a)===FG.other})},clsthumbmode:function(){return{active:this.thumbmode}},clsheadset:function(){return{active:this.audioonly}},clsaudio:function(){return{active:this.fgshow[FG.audio]}},clsvideo:function(){return{active:this.fgshow[FG.video]}},
clsphoto:function(){return{active:this.fgshow[FG.image]}},clsbooks:function(){return{active:this.fgshow[FG.books]}},clstexts:function(){return{active:this.fgshow[FG.texts]}},clspacks:function(){return{active:this.fgshow[FG.packs]}},clsother:function(){return{active:this.fgshow[FG.other]}},iconmodetag:function(){return listmodetag[this.listmode]},hintorder:function(){return 0<this.sortorder?"direct order":"reverse order"},hintsortmode:function(){return sortmodehint[this.sortmode]},hintlist:function(){return listmodehint[this.listmode]}},
methods:{authclosure:function(a){this.isauth=a},onorder:function(){this.sortorder=-this.sortorder},onsortalpha:function(){this.sortmode="byalpha"},onsortsize:function(){this.sortmode="bysize"},onsortunsorted:function(){this.sortmode="unsorted"},onlistmodesm:function(){this.listmode="smicon"},onlistmodemd:function(){this.listmode="mdicon"},onlistmodelg:function(){this.listmode="lgicon"},onthumbmode:function(){this.thumbmode=thumbmode=!this.thumbmode;eventHub.emit("thumbmode",thumbmode)},onheadset:function(){eventHub.emit("audioonly",
!this.audioonly)},onaudio:function(){this.fgshow[FG.audio]=!this.fgshow[FG.audio]},onvideo:function(){this.fgshow[FG.video]=!this.fgshow[FG.video]},onphoto:function(){this.fgshow[FG.image]=!this.fgshow[FG.image]},onbooks:function(){this.fgshow[FG.books]=!this.fgshow[FG.books]},ontexts:function(){this.fgshow[FG.texts]=!this.fgshow[FG.texts]},onpacks:function(){this.fgshow[FG.packs]=!this.fgshow[FG.packs]},onother:function(){this.fgshow[FG.other]=!this.fgshow[FG.other]},onunselect:function(){eventHub.emit("select",
null)},onaudioonly:function(a){this.audioonly=a}},created:function(){eventHub.on("auth",this.authclosure);eventHub.on("audioonly",this.onaudioonly)},unmounted:function(){eventHub.off("auth",this.authclosure);eventHub.off("audioonly",this.onaudioonly)}},VueMapCard={template:"#map-card-tpl",data:function(){return{styleid:"mapbox-hybrid",map:null,tiles:null,markers:null,markermode:"thumb",phototrack:null,showtrack:!1,gpslist:[],gpxlist:[],iid:makestrid(10)}},computed:{isvisible:function(){return 0<this.gpslist.length||
0<this.gpxlist.length},clsmapboxhybrid:function(){return{active:"mapbox-hybrid"===this.styleid}},clsmapboxsatellite:function(){return{active:"mapbox-satellite"===this.styleid}},clsmapboxoutdoors:function(){return{active:"mapbox-outdoors"===this.styleid}},clsmapboxstreets:function(){return{active:"mapbox-streets"===this.styleid}},clsgooglehybrid:function(){return{active:"google-hybrid"===this.styleid}},clsgooglesatellite:function(){return{active:"google-satellite"===this.styleid}},clsgoogleterrain:function(){return{active:"google-terrain"===
this.styleid}},clsgooglestreets:function(){return{active:"google-streets"===this.styleid}},clsosm:function(){return{active:"osm"===this.styleid}},clsopentopomap:function(){return{active:"opentopo"===this.styleid}},clshikebike:function(){return{active:"hikebike"===this.styleid}},clsphototrack:function(){return{active:this.showtrack}},iconmarkermode:function(){switch(this.markermode){case "marker":return"place";case "thumb":return"local_see"}},hintlandscape:function(){switch(this.styleid){case "mapbox-hybrid":return"Mapbox satellite & streets map";
case "mapbox-satellite":return"Mapbox satellite map";case "mapbox-outdoors":return"Mapbox outdoors map";case "mapbox-streets":return"Mapbox streets map";case "google-hybrid":return"Google maps hybrid";case "google-satellite":return"Google maps satellite";case "google-terrain":return"Google maps terrain";case "google-streets":return"Google maps streets";case "osm":return"Open Street Map";case "opentopo":return"Open topo map";case "hikebike":return"HikeBike map"}},hintmarkermode:function(){switch(this.markermode){case "marker":return"photo positions by markers";
case "thumb":return"photo positions by thumbnails"}}},methods:{new:function(){if(!this.markers||0<this.gpslist.length)this.markers&&this.map.removeLayer(this.markers),this.markers=L.markerClusterGroup(),this.map.addLayer(this.markers),this.phototrack&&(this.map.removeLayer(this.phototrack),this.phototrack=null),this.gpslist=[];for(var a=$jscomp.makeIterator(this.gpxlist),b=a.next();!b.done;b=a.next())b=b.value,b.layer&&this.map.removeLayer(b.layer);this.gpxlist=[]},maketiles:function(a){switch(a){case "mapbox-hybrid":return L.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}",
{attribution:'Map data: &copy; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors, Imagery &copy <a href="https://www.mapbox.com/" target="_blank">Mapbox</a>',tileSize:512,minZoom:2,zoomOffset:-1,id:"mapbox/satellite-streets-v11",accessToken:"pk.eyJ1Ijoic2Nod2FyemxpY2h0YmV6aXJrIiwiYSI6ImNrazdseXRxZjBlemsycG8wZ3BodTR1aWUifQ.Mt99AhglX08nolRj_bsyog"});case "mapbox-satellite":return L.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}",
{attribution:'Map data: &copy; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors, Imagery &copy <a href="https://www.mapbox.com/" target="_blank">Mapbox</a>',tileSize:512,minZoom:2,zoomOffset:-1,id:"mapbox/satellite-v9",accessToken:"pk.eyJ1Ijoic2Nod2FyemxpY2h0YmV6aXJrIiwiYSI6ImNrazdseXRxZjBlemsycG8wZ3BodTR1aWUifQ.Mt99AhglX08nolRj_bsyog"});case "mapbox-outdoors":return L.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}",
{attribution:'Map data: &copy; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors, Imagery &copy <a href="https://www.mapbox.com/" target="_blank">Mapbox</a>',tileSize:512,minZoom:2,zoomOffset:-1,id:"mapbox/outdoors-v11",accessToken:"pk.eyJ1Ijoic2Nod2FyemxpY2h0YmV6aXJrIiwiYSI6ImNrazdseXRxZjBlemsycG8wZ3BodTR1aWUifQ.Mt99AhglX08nolRj_bsyog"});case "mapbox-streets":return L.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}",
{attribution:'Map data: &copy; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors, Imagery &copy <a href="https://www.mapbox.com/" target="_blank">Mapbox</a>',tileSize:512,minZoom:2,zoomOffset:-1,id:"mapbox/streets-v11",accessToken:"pk.eyJ1Ijoic2Nod2FyemxpY2h0YmV6aXJrIiwiYSI6ImNrazdseXRxZjBlemsycG8wZ3BodTR1aWUifQ.Mt99AhglX08nolRj_bsyog"});case "google-hybrid":return L.tileLayer("http://{s}.google.com/vt/lyrs=s,h&x={x}&y={y}&z={z}",{subdomains:["mt0","mt1",
"mt2","mt3"],attribution:'Map data: &copy; <a href="https://developers.google.com/maps/documentation/javascript/overview" target="_blank">Google Maps Platform</a> contributors',minZoom:2,maxZoom:20});case "google-satellite":return L.tileLayer("http://{s}.google.com/vt/lyrs=s&x={x}&y={y}&z={z}",{subdomains:["mt0","mt1","mt2","mt3"],attribution:'Map data: &copy; <a href="https://developers.google.com/maps/documentation/javascript/overview" target="_blank">Google Maps Platform</a> contributors',minZoom:2,
maxZoom:20});case "google-terrain":return L.tileLayer("http://{s}.google.com/vt/lyrs=p&x={x}&y={y}&z={z}",{subdomains:["mt0","mt1","mt2","mt3"],attribution:'Map data: &copy; <a href="https://developers.google.com/maps/documentation/javascript/overview" target="_blank">Google Maps Platform</a> contributors',minZoom:2,maxZoom:20});case "google-streets":return L.tileLayer("http://{s}.google.com/vt/lyrs=m&x={x}&y={y}&z={z}",{subdomains:["mt0","mt1","mt2","mt3"],attribution:'Map data: &copy; <a href="https://developers.google.com/maps/documentation/javascript/overview" target="_blank">Google Maps Platform</a> contributors',
minZoom:2,maxZoom:20});case "osm":return L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19,attribution:'Map data: &copy; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors'});case "opentopo":return L.tileLayer("https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png",{attribution:'Map data: &copy; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors, <a href="http://viewfinderpanoramas.org" target="_blank">SRTM</a> | Map style: &copy; <a href="https://opentopomap.org" target="_blank">OpenTopoMap</a>',
minZoom:2,maxZoom:17});case "hikebike":return L.tileLayer("https://tiles.wmflabs.org/hikebike/{z}/{x}/{y}.png",{attribution:'Map data: &copy; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors',minZoom:2,maxZoom:19})}},changetiles:function(a){this.map.removeLayer(this.tiles);this.styleid=a;this.tiles=this.maketiles(a);this.map.addLayer(this.tiles)},addmarkers:function(a){var b=this;if(a.length){for(var c={},d=$jscomp.makeIterator(a),e=d.next();!e.done;c=
{$jscomp$loop$prop$file$64:c.$jscomp$loop$prop$file$64},e=d.next()){c.$jscomp$loop$prop$file$64=e.value;e={title:c.$jscomp$loop$prop$file$64.name,riseOnHover:!0};"thumb"===this.markermode&&c.$jscomp$loop$prop$file$64.puid&&(e.icon=L.divIcon({html:makemarkericon(c.$jscomp$loop$prop$file$64),className:"photomarker",iconSize:[60,60],iconAnchor:[30,30],popupAnchor:[0,-15]}));var f=document.createElement("template");f.innerHTML=makemarkerpopup(c.$jscomp$loop$prop$file$64).trim();f=f.content.firstChild;
var g=void 0;null==(g=f.querySelector(".photoinfo picture"))||g.addEventListener("click",function(k){return function(){eventHub.emit("open",k.$jscomp$loop$prop$file$64,b.gpslist)}}(c));L.marker([c.$jscomp$loop$prop$file$64.latitude,c.$jscomp$loop$prop$file$64.longitude],e).addTo(this.markers).bindPopup(f)}var h=!this.gpslist.length;Vue.nextTick(function(){h&&b.map.invalidateSize();b.onfitbounds()});this.gpslist.push.apply(this.gpslist,$jscomp.arrayFromIterable(a));this.showtrack&&this.makephototrack()}},
makephototrack:function(){for(var a=L.latLng(this.gpslist[0].latitude,this.gpslist[0].longitude,this.gpslist[0].altitude),b=a,c=0,d=0,e=0,f=[a],g=$jscomp.makeIterator(this.gpslist),h=g.next();!h.done;h=g.next()){h=h.value;h=L.latLng(h.latitude,h.longitude,h.altitude);var k=a.distanceTo(h);k>noderadius&&(c+=k,h.alt>a.alt&&(e+=h.alt-a.alt),f.push(h),a=h);d+=b.distanceTo(h);b=h}this.phototrack&&this.map.removeLayer(this.phototrack);this.phototrack=L.polyline(f,{color:"#3CB371"}).bindPopup("total <b>"+
f.length+"</b> waypoints<br>route <b>"+c.toFixed()+"</b> m<br>track <b>"+d.toFixed()+"</b> m<br>ascent <b>"+e.toFixed()+"</b> m").addTo(this.map)},addgpx:function(a){var b=this,c={};c.prop=a;c.trkpt=[];var d=this.gpxlist.length%gpxcolors.length;this.gpxlist.push(c);(function(){var e,f,g,h,k,l,m,p,q,n,u;return $jscomp.asyncExecutePromiseGeneratorProgram(function(r){switch(r.nextAddress){case 1:return eventHub.emit("ajax",1),r.setCatchFinallyBlocks(2,3),r.yield(fetch(fileurl(a)),5);case 5:return e=
r.yieldResult,r.yield(e.text(),6);case 6:f=r.yieldResult;g=/lat="(\d+\.\d+)" lon="(\d+\.\d+)"/g;h=f.matchAll(g);k=null;l=0;m=$jscomp.makeIterator(h);for(p=m.next();!p.done;p=m.next())q=p.value,n=L.latLng(Number(q[1]),Number(q[2])),k&&(l+=n.distanceTo(k)),k=n,c.trkpt.push(n);c.layer=L.polyline(c.trkpt,{color:gpxcolors[d]}).bindPopup("points <b>"+c.trkpt.length+"</b><br>route <b>"+l.toFixed()+"</b> m").addTo(b.map);case 3:r.enterFinallyBlock();eventHub.emit("ajax",-1);r.leaveFinallyBlock(0);break;case 2:u=
r.enterCatchBlock(),ajaxfail(u),r.jumpTo(3)}})})()},onmapboxhybrid:function(){this.changetiles("mapbox-hybrid")},onmapboxsatellite:function(){this.changetiles("mapbox-satellite")},onmapboxoutdoors:function(){this.changetiles("mapbox-outdoors")},onmapboxstreets:function(){this.changetiles("mapbox-streets")},ongooglehybrid:function(){this.changetiles("google-hybrid")},ongooglesatellite:function(){this.changetiles("google-satellite")},ongoogleterrain:function(){this.changetiles("google-terrain")},ongooglestreets:function(){this.changetiles("google-streets")},
onosm:function(){this.changetiles("osm")},onopentopo:function(){this.changetiles("opentopo")},onhikebike:function(){this.changetiles("hikebike")},onphototrack:function(){(this.showtrack=!this.showtrack)?this.makephototrack():(this.map.removeLayer(this.phototrack),this.phototrack=null)},onmarkermode:function(){switch(this.markermode){case "marker":this.markermode="thumb";break;case "thumb":this.markermode="marker"}var a=this.gpslist;this.new();this.addmarkers(a)},onfullscreenchange:function(){var a=
this.$refs.map.querySelector(".leaflet-control-fullscreen > span");a&&(a.innerHTML=isFullscreen()?"fullscreen_exit":"fullscreen")},onfullscreen:function(){isFullscreen()?closeFullscreen():openFullscreen(this.$refs.map)},onfitbounds:function(){for(var a=this.markers.getBounds(),b=$jscomp.makeIterator(this.gpxlist),c=b.next();!c.done;c=b.next())c=c.value,c.layer&&a.extend(c.layer.getBounds());this.map.flyToBounds(a,{padding:[20,20]})}},mounted:function(){var a=this;this.tiles=this.maketiles("mapbox-hybrid");
this.map=L.map(this.$refs.map,{attributionControl:!0,zoomControl:!1,center:[0,0],zoom:8,layers:[this.tiles]});L.control.scale().addTo(this.map);L.control.zoom({zoomInText:'<span class="material-icons">add</span>',zoomOutText:'<span class="material-icons">remove</span>'}).addTo(this.map);L.Control.Fullscreen=L.Control.extend({onAdd:function(b){b=document.getElementById("leaflet-toolbar").innerHTML;var c=document.createElement("template");c.innerHTML=null==b?void 0:b.trim();b=c.content.firstChild;var d;
null==b||null==(d=b.querySelector(".leaflet-control-fullscreen"))||d.addEventListener("click",function(f){a.onfullscreen()});var e;null==b||null==(e=b.querySelector(".leaflet-control-adjust"))||e.addEventListener("click",function(f){a.onfitbounds()});return b},onRemove:function(b){}});L.control.fullscreen=function(b){return new L.Control.Fullscreen(b)};L.control.fullscreen({position:"topright"}).addTo(this.map)}};var VuePlayer={template:"#mp3-player-tpl",data:function(){return{visible:!1,list:[],selfile:{},volval:100,ratval:6,repeatmode:0,audioonly:!1,seeking:!1,media:null,autoplay:!1,ready:!1,timecur:0,timebuf:0,timeend:0,ratevals:[.4,.5,1/1.75,1/1.5,.8,1/1.15,1,1.15,1.25,1.5,1.75,2,2.5],iid:makestrid(10)}},computed:{playlist:function(){for(var a=[],b=$jscomp.makeIterator(this.list),c=b.next();!c.done;c=b.next())c=c.value,(audiofilter(c)||!this.audioonly&&videofilter(c))&&a.push(c);return a},selfilepos:function(){for(var a in this.playlist)if(this.selfile===
this.playlist[a])return Number(a)},getprev:function(){return this.selfile&&0<this.selfilepos?this.playlist[this.selfilepos-1]:2===this.repeatmode&&this.playlist[this.playlist.length-1]},getnext:function(){return this.selfile&&this.selfilepos<this.playlist.length-1?this.playlist[this.selfilepos+1]:2===this.repeatmode&&this.playlist[0]},volumelabel:function(){return this.volval},ratelabel:function(){return this.ratevals[this.ratval].toFixed(2)},iconplay:function(){return this.selfile.playback?"pause":
"play_arrow"},hintplay:function(){return this.selfile.playback?"pause":"play"},iconrepeat:function(){return 1===this.repeatmode?"repeat_one":"repeat"},hintrepeat:function(){switch(this.repeatmode){case 0:return"no any repeat";case 1:return"repeat one";case 2:return"repeat playlist"}},fmttimecur:function(){return fmttime(this.timecur,this.timeend)},fmttimeend:function(){return fmttime(this.timeend,this.timeend)},fmttrackinfo:function(){if(this.selfile.title){var a,b,c;return(null!=(c=null!=(b=null!=
(a=this.selfile.artist)?a:this.selfile.album)?b:this.selfile.genre)?c:"")+" - "+this.selfile.title}return this.selfile.name},stlbarcur:function(){return{width:(Infinity===this.timeend?95:!this.timeend||Number.isNaN(this.timeend)?5:this.timecur/this.timeend*100)+"%"}},stlbarbuf:function(){return{width:(Number.isFinite(this.timeend)?this.timebuf/this.timeend*100:0)+"%"}}},methods:{setup:function(a){var b=this;if(this.selfile.puid!==a.puid){this.selfile=a;var c=new Audio(mediaurl(a,1,0));c.volume=this.volval/
100;c.playbackRate=this.ratevals[this.ratval];c.loop=1===this.repeatmode;c.autoplay=this.autoplay;this.media&&!this.media.paused&&this.media.pause();this.media=c;this.ready=!1;var d=function(){b.seeking||(b.timecur=c.currentTime);if(0<c.buffered.length){var e=b.timecur,f=c.buffered.start(0),g=c.buffered.end(0);b.timebuf=f<=e&&g>e?g-e:0}else b.timebuf=0};c.addEventListener("loadedmetadata",function(){b.timecur=c.currentTime;b.timebuf=0;b.timeend=c.duration;d()});c.addEventListener("canplay",function(){b.ready=
!0;c.autoplay||(c.play(),c.pause())});c.addEventListener("timeupdate",d);c.addEventListener("seeked",d);c.addEventListener("progress",d);c.addEventListener("durationchange",d);c.addEventListener("play",function(){b.autoplay=!0;c.autoplay=!0;eventHub.emit("playback",a,!0)});c.addEventListener("pause",function(){b.autoplay=!1;c.autoplay=!1;eventHub.emit("playback",a,!1)});c.addEventListener("ended",function(){b.autoplay=!0;b.onnext()});c.addEventListener("error",function(e){e.message?console.error("Error "+
e.code+"; details: "+e.message):console.error(e)});c.addEventListener("volumechange",function(){b.volval=100*c.volume});c.addEventListener("ratechange",function(){a:{var e=c.playbackRate;for(var f=1/3,g=b.ratevals[0],h=0;h<b.ratevals.length-1;h++){var k=b.ratevals[h+1];if(e>=(g+f)/2&&e<(g+k)/2){e=h;break a}f=g;g=k}e=b.ratevals.length-1}b.ratval=e})}},popup:function(a){this.visible=!0;this.setup(a)},close:function(){this.visible=!1;return this.media&&!this.media.paused?(this.media.pause(),!0):!1},
play:function(){this.media&&(this.media.paused?this.media.play():this.media.pause())},onprev:function(){this.getprev&&eventHub.emit("select",this.getprev)},onplay:function(){this.play()},onnext:function(){this.getnext&&eventHub.emit("select",this.getnext)},onrepeat:function(){this.repeatmode=(this.repeatmode+1)%(this.list?3:2);this.media&&(this.media.loop=1===this.repeatmode)},onseekerchange:function(a){this.media.currentTime=a.target.value;this.seeking=!1},onseekerinput:function(a){this.seeking=
!0;this.timecur=Number(a.target.value)},onvolinp:function(a){this.volval=Number(a.target.value)},onvolval:function(a){this.media&&(this.media.volume=this.volval/100)},onratinp:function(a){this.ratval=Number(a.target.value)},onratval:function(a){this.media&&(this.media.playbackRate=this.ratevals[this.ratval])},onopen:function(a){!a.type&&a.size&&(audiofilter(a)||videofilter(a))&&this.media&&!this.media.paused&&this.media.pause()},onselect:function(a){var b=this,c=function(d){return d&&(audiofilter(d)||
!b.audioonly&&videofilter(d))};this.visible?c(a)?this.setup(a):this.close():c(a)&&this.popup(a)},onplaylist:function(a){this.list=a},onaudioonly:function(a){this.audioonly=a}},created:function(){eventHub.on("open",this.onopen);eventHub.on("select",this.onselect);eventHub.on("playlist",this.onplaylist);eventHub.on("audioonly",this.onaudioonly)},unmounted:function(){eventHub.off("open",this.onopen);eventHub.off("select",this.onselect);eventHub.off("playlist",this.onplaylist);eventHub.off("audioonly",
this.onaudioonly)}};var controlstimeout=2500,playlisttimeout=8E3,touched=!1,VueThumbSlider={template:"#thumbslider-tpl",props:["list"],data:function(){return{selfile:null}},methods:{onwheel:function(a){this.$refs.slide.scrollBy({left:a.deltaX+a.deltaY,behavior:"smooth"})},onprev:function(){this.$refs.slide.scrollBy({left:-125,behavior:"smooth"})},onnext:function(){this.$refs.slide.scrollBy({left:125,behavior:"smooth"})},onselect:function(a){this.selfile=a},oniconclick:function(a){eventHub.emit("select",a)}},created:function(){eventHub.on("select",
this.onselect)},unmounted:function(){eventHub.off("select",this.onselect)}},VuePhotoSlider={template:"#photoslider-tpl",data:function(){return{loadbar:!1,list:[],autolist:!0,hd:!0,selfile:null,repeatmode:0,ctrlhnd:0,alhnd:0,dlg:null}},computed:{isimage:function(){return this.selfile&&imagefilter(this.selfile)},isvideo:function(){return this.selfile&&videofilter(this.selfile)},viewlist:function(){for(var a=[],b=$jscomp.makeIterator(this.list),c=b.next();!c.done;c=b.next())c=c.value,(imagefilter(c)||
videofilter(c))&&a.push(c);return a},selfileurl:function(){return this.selfile&&mediaurl(this.selfile,1,this.hd)},selfilepos:function(){for(var a in this.viewlist)if(this.selfile===this.viewlist[a])return Number(a)},getprev:function(){return this.selfile&&0<this.selfilepos?this.viewlist[this.selfilepos-1]:2===this.repeatmode&&this.viewlist[this.viewlist.length-1]},getnext:function(){return this.selfile&&this.selfilepos<this.viewlist.length-1?this.viewlist[this.selfilepos+1]:2===this.repeatmode&&this.viewlist[0]},
islist:function(){return 1<this.viewlist.length}},methods:{isvisible:function(){return 0<this.$el.offsetWidth&&0<this.$el.offsetHeight},load:function(a){this.selfile!==a&&(this.loadbar||(eventHub.emit("ajax",1),this.loadbar=!0),this.alhnd&&clearTimeout(this.alhnd),this.isvideo&&!this.$refs.video.paused&&this.$refs.video.pause(),this.selfile=a,this.isvideo&&(this.$refs.video.src=this.selfileurl))},popup:function(a,b){isFullscreen()&&closeFullscreen();this.list=null!=b?b:[a];this.load(a);this.dlg.show();
this.showcontrols()},close:function(){this.dlg.hide()},showcontrols:function(){var a=this;this.ctrlhnd&&clearTimeout(this.ctrlhnd);this.ctrlhnd=setTimeout(function(){a.ctrlhnd=0},controlstimeout)},hidecontrols:function(){this.ctrlhnd&&(clearTimeout(this.ctrlhnd),this.ctrlhnd=0)},onimgload:function(a){var b=this;eventHub.emit("ajax",-1);this.loadbar=!1;this.isimage&&(this.alhnd=setTimeout(function(){b.alhnd=0;if(b.autolist)b.onnext()},playlisttimeout))},onimgerror:function(a){eventHub.emit("ajax",
-1);this.loadbar=!1},onended:function(a){if(this.autolist)this.onnext()},ontouchstart:function(a){touched=!0},onclick:function(a){var b=this;touched=!1;this.alhnd&&(clearTimeout(this.alhnd),this.alhnd=0);this.ctrlhnd?(clearTimeout(this.ctrlhnd),this.ctrlhnd=0):this.ctrlhnd=setTimeout(function(){b.ctrlhnd=0},controlstimeout)},onmove:function(a){touched||this.showcontrols()},onkeyup:function(a){switch(a.code){case "ArrowLeft":this.onprev();break;case "ArrowRight":this.onnext();break;case "Space":this.onclick(a);
break;case "Home":this.viewlist.length&&eventHub.emit("select",this.viewlist[0]);break;case "End":this.viewlist.length&&eventHub.emit("select",this.viewlist[this.viewlist.length-1]);break;default:this.showcontrols()}},onshowcontrols:function(){this.showcontrols()},onprev:function(){this.getprev&&eventHub.emit("select",this.getprev)},onnext:function(){this.getnext&&eventHub.emit("select",this.getnext)},onclose:function(){this.close()},onopen:function(a,b){!a.type&&a.size&&(imagefilter(a)||videofilter(a))&&
this.popup(a,null!=b?b:this.$root.$refs.fcard.filelist)},onselect:function(a){var b=this;this.isvisible()&&(a&&(imagefilter(a)||videofilter(a))?(this.load(a),this.ctrlhnd&&(clearTimeout(this.ctrlhnd),this.ctrlhnd=setTimeout(function(){b.ctrlhnd=0},controlstimeout))):this.close())}},created:function(){eventHub.on("open",this.onopen);eventHub.on("select",this.onselect)},mounted:function(){var a=this;this.dlg=new bootstrap.Modal(this.$el);this.$el.addEventListener("shown.bs.modal",function(b){});this.$el.addEventListener("hidden.bs.modal",
function(b){a.isvideo&&!a.$refs.video.paused&&a.$refs.video.pause();a.selfile=null})},unmounted:function(){eventHub.off("open",this.onopen);eventHub.off("select",this.onselect);this.dlg=null}};var resmodel={skinlist:[],iconlist:[]},iconmapping={private:{blank:"",label:"",cid:{cid:""},drive:{},folder:{},grp:{},ext:{}},shared:{blank:"",label:"",cid:{cid:""},drive:{},folder:{},grp:{},ext:{}},iconfmt:[]},thumbmode=!0,FT={file:0,dir:1,drv:2,ctgr:3},FG={other:0,video:1,audio:2,image:3,books:4,texts:5,packs:6,dir:7},DS={yellow:3E3,red:1E4},extfmt={bitmap:{".tga":1,".bmp":1,".dib":1,".rle":1,".dds":1},tiff:{".tiff":1,".tif":1},jpeg:{".jpg":1,".jpe":1,".jpeg":1,".jfif":1},jpeg2000:{".jp2":1,".jpg2":1,
".jpx":1,".jpm":1},psd:{".psd":1,".psb":1},component:{".dll":1,".ocx":1},exec:{".exe":1,".dll":1,".ocx":1,".bat":1,".cmd":1,".sh":1},text:{".txt":1,".md":1},html:{".html":1,".htm":1,".shtml":1,".shtm":1,".xhtml":1,".phtml":1,".hta":1,".mht":1},config:{".cfg":1,".ini":1,".inf":1,".reg":1},datafmt:{".xml":1,".xsml":1,".xsl":1,".xsd":1,".kml":1,".gpx":1,".wsdl":1,".xlf":1,".xliff":1,".yml":1,".yaml":1,".json":1},script:{".css":1,".js":1,".jsm":1,".vb":1,".vbs":1,".bat":1,".cmd":1,".sh":1,".mak":1,".iss":1,
".nsi":1,".nsh":1,".bsh":1,".sql":1,".as":1,".mx":1,".ps":1,".php":1,".phpt":1,".lua":1,".tcl":1,".rc":1,".cmake":1},code:{".css":1,".js":1,".jsm":1,".vb":1,".vbs":1,".bat":1,".cmd":1,".sh":1,".mak":1,".iss":1,".nsi":1,".nsh":1,".bsh":1,".sql":1,".as":1,".mx":1,".ps":1,".php":1,".phpt":1,".lua":1,".tcl":1,".rc":1,".cmake":1,".java":1,".jsp":1,".asp":1,".asm":1,".c":1,".h":1,".hpp":1,".hxx":1,".cpp":1,".cxx":1,".cc":1,".cs":1,".go":1,".r":1,".d":1,".pas":1,".inc":1,".py":1,".pyw":1,".pl":1,".pm":1,
".plx":1,".rb":1,".rbw":1},msoffice:{".doc":1,".docx":1,".xls":1,".xlsx":1,".ppt":1,".pptx":1,".vsd":1},openoffice:{".odt":1,".ods":1,".odp":1,".rtf":1,".abw":1},office:{".odt":1,".ods":1,".odp":1,".rtf":1,".abw":1,".doc":1,".docx":1,".xls":1,".xlsx":1,".ppt":1,".pptx":1,".vsd":1},archive:{".cab":1,".zip":1,".7z":1,".rar":1,".rev":1,".jar":1,".apk":1,".tar":1,".tgz":1,".gz":1,".bz2":1},disk:{".iso":1,".isz":1,".udf":1,".nrg":1,".mdf":1,".mdx":1,".img":1,".ima":1,".imz":1,".ccd":1,".vc4":1,".dmg":1,
".daa":1,".uif":1,".vhd":1,".vhdx":1,".vmdk":1},"package":{".wpk":1},playlist:{".m3u":1,".m3u8":1,".pls":1,".wpl":1,".asx":1,".xspf":1},image:{".tga":1,".bmp":1,".dib":1,".rle":1,".dds":1,".tif":1,".tiff":1,".jpg":1,".jpe":1,".jpeg":1,".jfif":1,".gif":1,".png":1,".webp":1,".psd":1,".psb":1,".jp2":1,".jpg2":1,".jpx":1,".jpm":1,".jxr":1},audio:{".aac":1,".m4a":1,".alac":1,".aif":1,".mpa":1,".mp3":1,".wav":1,".wma":1,".weba":1,".oga":1,".ogg":1,".opus":1,".flac":1,".mka":1,".ra":1,".mid":1,".midi":1,
".cda":1},video:{".avi":1,".mpe":1,".mpg":1,".mp4":1,".webm":1,".wmv":1,".wmx":1,".flv":1,".3gp":1,".3g2":1,".mkv":1,".mov":1,".ogv":1,".ogx":1},books:{".pdf":1,".djvu":1,".djv":1,".html":1,".htm":1,".shtml":1,".shtm":1,".xhtml":1,".phtml":1,".hta":1,".mht":1},texts:{".txt":1,".md":1,".css":1,".js":1,".jsm":1,".vb":1,".vbs":1,".bat":1,".cmd":1,".sh":1,".mak":1,".iss":1,".nsi":1,".nsh":1,".bsh":1,".sql":1,".as":1,".mx":1,".ps":1,".php":1,".phpt":1,".lua":1,".tcl":1,".rc":1,".cmake":1,".java":1,".jsp":1,
".asp":1,".asm":1,".c":1,".h":1,".hpp":1,".hxx":1,".cpp":1,".cxx":1,".cc":1,".cs":1,".go":1,".r":1,".d":1,".pas":1,".inc":1,".py":1,".pyw":1,".pl":1,".pm":1,".plx":1,".rb":1,".rbw":1,".cfg":1,".ini":1,".inf":1,".reg":1,".xml":1,".xsml":1,".xsl":1,".xsd":1,".kml":1,".gpx":1,".wsdl":1,".xlf":1,".xliff":1,".yml":1,".yaml":1,".json":1},packs:{".cab":1,".zip":1,".7z":1,".rar":1,".rev":1,".jar":1,".apk":1,".tar":1,".tgz":1,".gz":1,".bz2":1,".iso":1,".isz":1,".udf":1,".nrg":1,".mdf":1,".mdx":1,".img":1,
".ima":1,".imz":1,".ccd":1,".vc4":1,".dmg":1,".daa":1,".uif":1,".vhd":1,".vhdx":1,".vmdk":1,".wpk":1,".m3u":1,".m3u8":1,".pls":1,".wpl":1,".asx":1,".xspf":1}},extfmtorder="bitmap tiff jpeg jpeg2000 psd component exec text html config datafmt script code msoffice openoffice office archive disk package playlist image audio video books texts packs".split(" "),getFileGroup=function(a){if(a.type)return FG.dir;a=pathext(a.name);return extfmt.image[a]?FG.image:extfmt.audio[a]?FG.audio:extfmt.video[a]?FG.video:
extfmt.books[a]?FG.books:extfmt.texts[a]?FG.texts:extfmt.packs[a]?FG.packs:FG.other},geticonpath=function(a){var b=a.shared?iconmapping.shared:iconmapping.private,c=a.shared?iconmapping.private:iconmapping.shared;switch(a.type){case FT.ctgr:return{org:b.cid[a.cid]||b.cid.cid,alt:c.cid[a.cid]||c.cid.cid};case FT.drv:return 0>a.latency?{org:b.drive.offline,alt:c.drive.offline}:a.latency<DS.yellow?{org:b.drive.green,alt:c.drive.green}:a.latency<DS.red?{org:b.drive.yellow,alt:c.drive.yellow}:{org:b.drive.red,
alt:c.drive.red};case FT.dir:if(a.scan){var d=0;a=a.fgrp;for(var e=$jscomp.makeIterator(a),f=e.next();!f.done;f=e.next())d+=f.value;return d?.5<a[FG.other]/d?{org:b.folder.other,alt:c.folder.other}:.5<a[FG.video]/d?{org:b.folder.video,alt:c.folder.video}:.5<a[FG.audio]/d?{org:b.folder.audio,alt:c.folder.audio}:.5<a[FG.image]/d?{org:b.folder.image,alt:c.folder.image}:.5<a[FG.books]/d?{org:b.folder.books,alt:c.folder.books}:.5<a[FG.texts]/d?{org:b.folder.texts,alt:c.folder.texts}:.5<a[FG.packs]/d?{org:b.folder.packs,
alt:c.folder.packs}:.5<a[FG.dir]/d?{org:b.folder.dir,alt:c.folder.dir}:.5<(a[FG.audio]+a[FG.video]+a[FG.image])/d?{org:b.folder.media,alt:c.folder.media}:{org:b.folder.open,alt:c.folder.open}:{org:b.folder.open,alt:c.folder.open}}return{org:b.folder.close,alt:c.folder.close};default:var g=pathext(a.name);d=function(h){for(var k=$jscomp.makeIterator(extfmtorder),l=k.next();!l.done;l=k.next()){l=l.value;var m=h[l];if(m&&extfmt[l][g])return m}};return{org:b.ext[g]||d(b.grp)||b.blank,alt:c.ext[g]||d(c.grp)||
c.blank}}},encode=function(a){return encodeURI(a).replace("#","%23").replace("&","%26").replace("+","%2B")},fileurl=function(a){return"/id"+appvm.aid+"/file/"+a.puid},pathurl=function(a){return(devmode?"/dev":"")+"/id"+appvm.aid+"/path/"+a.puid},mediaurl=function(a,b,c){return"/id"+appvm.aid+"/file/"+a.puid+"?media="+b+"&hd="+c},showmsgbox=function(a,b,c){var d=document.getElementById("msgbox");if(d){var e=new bootstrap.Modal(d);d.querySelector(".modal-title").innerText=a;d.querySelector(".message").innerText=
b;d.querySelector(".details").innerText=null!=c?c:"";e.show()}},ajaxfail=function(a){console.error(a.name,a);if(a instanceof SyntaxError)showmsgbox("Syntax error","Application function failed with syntax error in javascript.");else if(a instanceof HttpError){var b=function(c,d){var e=document.getElementById("msgbox");if(e){var f=new bootstrap.Modal(e);e.querySelector(".modal-title").innerText=c;e.querySelector(".message").innerText=d;e.querySelector(".errcode").innerText=a.code;e.querySelector(".errmsg").innerText=
a.what;f.show()}};switch(a.status){case 400:b("Application error","Action is rejected by server. This error is caused by wrong parameters in application ajax-call to server.");break;case 401:b("401 Unauthorized","Action can be done only after authorization.");break;case 403:b("403 resource forbidden","Resource referenced by application ajax-call is forbidden. It can be accessible after authorization, or for other authorization.");break;case 404:b("404 resource not found","Resource referenced by application ajax-call is not found on server.");
break;case 500:b("Internal server error","Action could not be completed due to an internal error on the server side.");break;default:b("Error "+a.status,"Action is rejected with HTTP status "+a.status+".")}}else showmsgbox("Server unavailable","Server is currently not available, action can not be done now.")},VueMainApp={template:"#app-tpl",data:function(){return{skinid:"",iconid:"",resmodel:resmodel,showauth:!1,isauth:!1,authid:0,aid:0,ishome:!1,selfile:null,diskpath:"",diskpathstate:0,diskadd:null,
shared:[],histpos:0,histlist:[],pathlist:[],filelist:[],curscan:new Date,curcid:"",curpuid:"",curpath:"",shrname:"",iid:makestrid(10)}},computed:{isadmin:function(){return this.isauth||"localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname},curshorturl:function(){return(devmode?"/dev":"")+"/id"+this.aid+"/path/"+this.curpuid},curlongurl:function(){return(devmode?"/dev":"")+"/id"+this.aid+"/path/"+this.curpath},curbasename:function(){if(this.curcid)switch(this.curcid){case "drives":return"Drives list";
case "shares":return"Shared resources";case "media":return"Multimedia files";case "video":return"Movie and video files";case "audio":return"Music and audio files";case "image":return"Photos and images";case "books":return"Books";case "texts":return"Text files";default:return this.curcid}else{if(this.curpath){var a=this.curpath.split("/"),b=a.pop()||a.pop();return!a.length&&this.shrname||b}return"home page"}},curpathway:function(){if(!this.curpath)return[];var a=this.curpath.split("/");a.pop()||a.pop();
var b=[],c="";a=$jscomp.makeIterator(a);for(var d=a.next();!d.done;d=a.next())d=d.value,c=c?c+("/"+d):d,b.push({name:d,path:c,type:FT.dir});b.length&&(b[0].name=this.shrname||b[0].name);return b},uncached:function(){for(var a=[],b=$jscomp.makeIterator(this.filelist),c=b.next();!c.done;c=b.next())c=c.value,c.ntmb||a.push(c);return a},sumsize:function(){for(var a=0,b=$jscomp.makeIterator(this.filelist),c=b.next();!c.done;c=b.next()){var d=void 0;a+=null!=(d=c.value.size)?d:0}return fmtitemsize(a)},
clshome:function(){return{disabled:"home"===this.curcid||!(this.isadmin||this.ishome)}},clsback:function(){return{disabled:2>this.histpos}},clsforward:function(){return{disabled:this.histpos>=this.histlist.length}},clsparent:function(){return{disabled:!this.curpathway.length}},clslink:function(){return{disabled:!this.selfile||this.selfile.type===FT.ctgr}},clsshared:function(){return{active:this.selfile&&this.selfile.shared,disabled:!this.selfile}},showdiskadd:function(){return this.isadmin&&"drives"===
this.curcid},clsdiskpathedt:function(){return{"is-invalid":this.diskpathstate&&-1===this.passstate,"is-valid":this.diskpathstate&&-1!==this.passstate}},clsdiskadd:function(){return{disabled:!this.diskpath.length}},clsdiskremove:function(){return{disabled:!this.selfile||this.selfile.type!==FT.drv}},textauthcaret:function(){return this.showauth?"arrow_right":"arrow_left"},hintback:function(){if(1<this.histpos){var a=this.histlist[this.histpos-2];return a.cid?"back to "+a.cid:a.path?"back to /id"+a.aid+
"/path/"+a.path:"back to home"}return"go back"},hintforward:function(){if(this.histpos<this.histlist.length){var a=this.histlist[this.histpos];return a.cid?"forward to "+a.cid:a.path?"forward to /id"+a.aid+"/path/"+a.path:"forward to home"}return"go forward"},hintparent:function(){return this.curpathway.length?this.curpathway.map(function(a){return a.name}).join("/"):"to root folder"},hintauthcaret:function(){return this.showauth?"hide login fields":"show login fields"}},methods:{fetchicons:function(a){var b;
return $jscomp.asyncExecutePromiseGeneratorProgram(function(c){if(1==c.nextAddress)return c.yield(fetch(a),2);if(3!=c.nextAddress){b=c.yieldResult;if(!b.ok)throw new HttpError(b.status,{what:"can not load icons mapping file",when:Date.now(),code:0});return c.yield(b.json(),3)}iconmapping=c.yieldResult;eventHub.emit("iconset",iconmapping);c.jumpToEnd()})},fetchishome:function(){var a=this,b;return $jscomp.asyncExecutePromiseGeneratorProgram(function(c){if(1==c.nextAddress)return c.yield(fetchajaxauth("POST",
"/api/card/ishome",{aid:a.aid}),2);b=c.yieldResult;traceajax(b);if(!b.ok)throw new HttpError(b.status,b.data);a.ishome=b.data;c.jumpToEnd()})},fetchcategory:function(a){var b=this,c,d;return $jscomp.asyncExecutePromiseGeneratorProgram(function(e){if(1==e.nextAddress)return e.yield(fetchajaxauth("POST","/api/card/ctgr",{aid:a.aid,puid:a.puid,cid:a.cid}),2);c=e.yieldResult;traceajax(c);if(!c.ok)throw new HttpError(c.status,c.data);"shares"===a.cid&&b.isadmin&&(b.shared=null!=(d=c.data)?d:[]);b.curscan=
new Date(Date.now());b.curcid=a.cid;b.curpuid=a.puid;b.curpath="";b.shrname="";b.newfolder(c.data,"home"===a.cid);e.jumpToEnd()})},fetchfolder:function(a){var b=this,c;return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){if(1==d.nextAddress)return d.yield(fetchajaxauth("POST","/api/card/folder",{aid:a.aid,puid:a.puid,path:a.path}),2);c=d.yieldResult;traceajax(c);if(!c.ok)throw new HttpError(c.status,c.data);a.puid=c.data.puid;a.path=c.data.path;b.curscan=new Date(Date.now());b.curcid="";
b.curpuid=a.puid;b.curpath=a.path;b.shrname=c.data.shrname;b.newfolder(c.data.list);d.jumpToEnd()})},fetchplaylist:function(a){var b=this,c;return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){if(1==d.nextAddress)return d.yield(fetchajaxauth("POST","/api/card/playlist",{aid:a.aid,puid:a.puid}),2);c=d.yieldResult;traceajax(c);if(!c.ok)throw new HttpError(c.status,c.data);a.path=c.data.path;b.curscan=new Date(Date.now());b.curcid="";b.curpuid=a.puid;b.curpath=c.data.path;b.shrname=c.data.shrname;
b.newfolder(c.data.list);d.jumpToEnd()})},fetchopenroute:function(a){var b=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(c){return 1==c.nextAddress?(a.cid||a.puid||a.path||(a.cid="home"),a.cid?c.yield(b.fetchcategory(a),6):c.yield(b.fetchfolder(a),4)):6!=c.nextAddress?c.yield(b.fetchscanthumbs(),0):"shares"!==a.cid?c.jumpTo(0):c.yield(b.fetchscanthumbs(),0)})},fetchscanthumbs:function(){var a=this,b,c;return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){if(1==d.nextAddress)return a.uncached.length?
d.yield(fetchjsonauth("POST","/api/tmb/scn",{aid:a.aid,puids:a.uncached.map(function(e){return e.puid})}),2):d.return();b=d.yieldResult;traceajax(b);if(!b.ok)throw new HttpError(b.status,b.data);c=a.puid;(function(){var e,f,g,h,k,l,m,p,q;return $jscomp.asyncExecutePromiseGeneratorProgram(function(n){switch(n.nextAddress){case 1:n.setCatchFinallyBlocks(2);case 4:if(c!==a.puid||!a.uncached.length){n.leaveTryBlock(0);break}return n.yield(fetchajaxauth("POST","/api/tmb/chk",{tmbs:a.uncached.map(function(u){return{puid:u.puid}})}),
6);case 6:e=n.yieldResult;traceajax(e);if(!e.ok)throw new HttpError(e.status,e.data);f=[];g=$jscomp.makeIterator(e.data.tmbs);for(h=g.next();!h.done;h=g.next())if(k=h.value,k.ntmb)for(l=$jscomp.makeIterator(a.filelist),m=l.next();!m.done;m=l.next())if(p=m.value,p.puid===k.puid){p.ntmb=k.ntmb;p.mtmb=k.mtmb;p.latitude&&p.longitude&&1===p.ntmb&&f.push(p);break}a.$refs.mcard.addmarkers(f);return n.yield(new Promise(function(u){return setTimeout(u,1500)}),4);case 2:q=n.enterCatchBlock(),ajaxfail(q),n.jumpToEnd()}})})();
d.jumpToEnd()})},fetchshared:function(){var a=this,b,c;return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){if(1==d.nextAddress)return d.yield(fetchajaxauth("POST","/api/share/lst",{aid:a.aid}),2);b=d.yieldResult;traceajax(b);if(!b.ok)throw new HttpError(b.status,b.data);a.shared=null!=(c=b.data)?c:[];a.updateshared();d.jumpToEnd()})},fetchshareadd:function(a){var b=this,c;return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){if(1==d.nextAddress)return d.yield(fetchajaxauth("POST",
"/api/share/add",{aid:b.aid,puid:a.puid}),2);c=d.yieldResult;traceajax(c);if(!c.ok)throw new HttpError(c.status,c.data);a.shared=!0;b.shared.push(a);d.jumpToEnd()})},fetchsharedel:function(a){var b=this,c,d;return $jscomp.asyncExecutePromiseGeneratorProgram(function(e){if(1==e.nextAddress)return e.yield(fetchajaxauth("DELETE","/api/share/del",{aid:b.aid,puid:a.puid}),2);c=e.yieldResult;traceajax(c);if(!c.ok)throw new HttpError(c.status,c.data);if(c.data)for(a.shared=!1,d=0;d<b.shared.length;)b.shared[d].puid===
a.puid?b.shared.splice(d,1):d++;e.jumpToEnd()})},updateshared:function(){for(var a=$jscomp.makeIterator(this.pathlist),b=a.next();!b.done;b=a.next()){var c=b.value,d=!1,e=$jscomp.makeIterator(this.shared);for(b=e.next();!b.done;b=e.next())if(b.value.puid===c.puid){d=!0;break}c.shared=d}a=$jscomp.makeIterator(this.filelist);for(b=a.next();!b.done;b=a.next()){c=b.value;d=!1;e=$jscomp.makeIterator(this.shared);for(b=e.next();!b.done;b=e.next())if(b.value.puid===c.puid){d=!0;break}c.shared=d}},setskin:function(a){if(a!==
this.skinid)for(var b=$jscomp.makeIterator(this.resmodel.skinlist),c=b.next();!c.done;c=b.next())if(c=c.value,c.id===a){var d=void 0;null==(d=document.getElementById("skinmodel"))||d.setAttribute("href",c.link);sessionStorage.setItem("skinid",a);this.skinid=a}},seticon:function(a){var b=this;if(a!==this.iconid)for(var c={},d=$jscomp.makeIterator(this.resmodel.iconlist),e=d.next();!e.done;c={$jscomp$loop$prop$v$66:c.$jscomp$loop$prop$v$66},e=d.next())c.$jscomp$loop$prop$v$66=e.value,c.$jscomp$loop$prop$v$66.id===
a&&(function(f){return function(){var g;return $jscomp.asyncExecutePromiseGeneratorProgram(function(h){if(1==h.nextAddress)return eventHub.emit("ajax",1),h.setCatchFinallyBlocks(2,3),h.yield(b.fetchicons(f.$jscomp$loop$prop$v$66.link),3);if(2!=h.nextAddress)return h.enterFinallyBlock(),eventHub.emit("ajax",-1),h.leaveFinallyBlock(0);g=h.enterCatchBlock();ajaxfail(g);return h.jumpTo(3)})}}(c)(),sessionStorage.setItem("iconid",a),this.iconid=a)},seturl:function(){window.history.replaceState(null,this.curpath,
this.curcid?(devmode?"/dev":"")+"/id"+this.aid+"/ctgr/"+this.curcid+"/":this.curpath?this.curlongurl:(devmode?"/dev":"")+"/id"+this.aid+"/home/")},pushhist:function(a){this.histlist.splice(this.histpos);this.histlist.push(a);this.histpos=this.histlist.length;this.seturl()},newfolder:function(a,b){this.pathlist=[];this.filelist=[];var c=$jscomp.makeIterator(null!=a?a:[]);for(a=c.next();!a.done;a=c.next())(a=a.value)&&(a.type!==FT.ctgr||b)&&(a.type?this.pathlist.push(a):this.filelist.push(a));this.updateshared();
eventHub.emit("select",null);this.$refs.mcard.new();if(this.filelist.length){b=[];c=$jscomp.makeIterator(this.filelist);for(a=c.next();!a.done;a=c.next())a=a.value,a.latitude&&a.longitude&&1===a.ntmb&&b.push(a),".gpx"===pathext(a.name)&&this.$refs.mcard.addgpx(a);this.$refs.mcard.addmarkers(b)}},onhome:function(){var a=this;(function(){var b,c;return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){switch(d.nextAddress){case 1:return eventHub.emit("ajax",1),d.setCatchFinallyBlocks(2,3),b={cid:"home",
aid:a.aid},d.yield(a.fetchopenroute(b),5);case 5:a.pushhist(b);case 3:d.enterFinallyBlock();eventHub.emit("ajax",-1);d.leaveFinallyBlock(0);break;case 2:c=d.enterCatchBlock(),ajaxfail(c),d.jumpTo(3)}})})()},onback:function(){var a=this;(function(){var b,c;return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){if(1==d.nextAddress)return eventHub.emit("ajax",1),d.setCatchFinallyBlocks(2,3),a.histpos--,b=a.histlist[a.histpos-1],d.yield(a.fetchopenroute(b),3);if(2!=d.nextAddress)return d.enterFinallyBlock(),
eventHub.emit("ajax",-1),d.leaveFinallyBlock(0);c=d.enterCatchBlock();ajaxfail(c);return d.jumpTo(3)})})()},onforward:function(){var a=this;(function(){var b,c;return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){if(1==d.nextAddress)return eventHub.emit("ajax",1),d.setCatchFinallyBlocks(2,3),a.histpos++,b=a.histlist[a.histpos-1],d.yield(a.fetchopenroute(b),3);if(2!=d.nextAddress)return d.enterFinallyBlock(),eventHub.emit("ajax",-1),d.leaveFinallyBlock(0);c=d.enterCatchBlock();ajaxfail(c);
return d.jumpTo(3)})})()},onparent:function(){var a=this;(function(){var b,c,d;return $jscomp.asyncExecutePromiseGeneratorProgram(function(e){switch(e.nextAddress){case 1:return eventHub.emit("ajax",1),e.setCatchFinallyBlocks(2,3),b=a.curpathway.length?a.curpathway[a.curpathway.length-1].path:"",c={aid:a.aid,path:b},e.yield(a.fetchopenroute(c),5);case 5:a.pushhist(c);case 3:e.enterFinallyBlock();eventHub.emit("ajax",-1);e.leaveFinallyBlock(0);break;case 2:d=e.enterCatchBlock(),ajaxfail(d),e.jumpTo(3)}})})()},
onrefresh:function(){var a=this;(function(){var b;return $jscomp.asyncExecutePromiseGeneratorProgram(function(c){switch(c.nextAddress){case 1:return eventHub.emit("ajax",1),c.setCatchFinallyBlocks(2,3),c.yield(a.fetchopenroute({cid:a.curcid,aid:a.aid,puid:a.curpuid,path:a.curpath}),5);case 5:if(!a.isadmin||"shares"===a.curcid){c.jumpTo(6);break}return c.yield(a.fetchshared(),6);case 6:if(a.isadmin||"home"===a.curcid){c.jumpTo(3);break}return c.yield(a.fetchishome(),3);case 3:c.enterFinallyBlock();
eventHub.emit("ajax",-1);c.leaveFinallyBlock(0);break;case 2:b=c.enterCatchBlock(),ajaxfail(b),c.jumpTo(3)}})})()},onlink:function(){copyTextToClipboard(window.location.origin+fileurl(this.selfile))},onshare:function(){var a=this;(function(){var b;return $jscomp.asyncExecutePromiseGeneratorProgram(function(c){if(1==c.nextAddress)return eventHub.emit("ajax",1),c.setCatchFinallyBlocks(2,3),a.selfile.shared?c.yield(a.fetchsharedel(a.selfile),3):c.yield(a.fetchshareadd(a.selfile),3);if(2!=c.nextAddress)return c.enterFinallyBlock(),
eventHub.emit("ajax",-1),c.leaveFinallyBlock(0);b=c.enterCatchBlock();ajaxfail(b);return c.jumpTo(3)})})()},onauthcaret:function(){this.showauth=!this.showauth},ondiskadd:function(){var a=this;(function(){var b,c,d,e;return $jscomp.asyncExecutePromiseGeneratorProgram(function(f){switch(f.nextAddress){case 1:return eventHub.emit("ajax",1),f.setCatchFinallyBlocks(2,3),f.yield(fetchajaxauth("POST","/api/drive/add",{aid:a.$root.aid,path:a.diskpath}),5);case 5:b=f.yieldResult,traceajax(b),b.ok?((c=b.data)&&
a.pathlist.push(c),null==(d=a.diskadd)||d.hide()):a.diskpathstate=-1;case 3:f.enterFinallyBlock();eventHub.emit("ajax",-1);f.leaveFinallyBlock(0);break;case 2:e=f.enterCatchBlock(),ajaxfail(e),f.jumpTo(3)}})})()},ondiskremove:function(){var a=this;(function(){var b,c;return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){switch(d.nextAddress){case 1:return eventHub.emit("ajax",1),d.setCatchFinallyBlocks(2,3),d.yield(fetchajaxauth("POST","/api/drive/del",{aid:a.$root.aid,puid:a.selfile.puid}),
5);case 5:b=d.yieldResult;traceajax(b);if(!b.ok)throw new HttpError(b.status,b.data);if(!b.data){d.jumpTo(3);break}a.pathlist.splice(a.pathlist.findIndex(function(e){return e===a.selfile}),1);if(!a.selfile.shared){d.jumpTo(3);break}return d.yield(a.fetchsharedel(a.selfile),3);case 3:d.enterFinallyBlock();eventHub.emit("ajax",-1);d.leaveFinallyBlock(0);break;case 2:c=d.enterCatchBlock(),ajaxfail(c),d.jumpTo(3)}})})()},ondiskpathchange:function(a){var b=this;(function(){var c,d;return $jscomp.asyncExecutePromiseGeneratorProgram(function(e){if(1==
e.nextAddress)return e.setCatchFinallyBlocks(2),e.yield(fetchajaxauth("POST","/api/card/ispath",{aid:b.$root.aid,path:b.diskpath}),4);if(2!=e.nextAddress)return c=e.yieldResult,b.diskpathstate=c.ok?c.data?1:0:-1,e.leaveTryBlock(0);d=e.enterCatchBlock();ajaxfail(d);e.jumpToEnd()})})()},authclosure:function(a){(this.isauth=a)&&(a=auth.claims())&&"aid"in a&&(this.aid=this.authid=a.aid)},onopen:function(a){var b=this;if(a.type||a.size){var c=pathext(a.name);if(a.type||".iso"===c)(!a.latency||0<a.latency)&&
function(){var d,e;return $jscomp.asyncExecutePromiseGeneratorProgram(function(f){switch(f.nextAddress){case 1:return eventHub.emit("ajax",1),f.setCatchFinallyBlocks(2,3),d={aid:b.aid},a.cid&&(d.cid=a.cid),a.puid&&(d.puid=a.puid),a.path&&(d.path=a.path),f.yield(b.fetchopenroute(d),5);case 5:b.pushhist(d);case 3:f.enterFinallyBlock();eventHub.emit("ajax",-1);f.leaveFinallyBlock(0);break;case 2:e=f.enterCatchBlock(),ajaxfail(e),f.jumpTo(3)}})}();else if(extfmt.playlist[c])(function(){var d,e;return $jscomp.asyncExecutePromiseGeneratorProgram(function(f){switch(f.nextAddress){case 1:return eventHub.emit("ajax",
1),f.setCatchFinallyBlocks(2,3),d={cid:b.curcid,aid:b.aid,puid:a.puid},f.yield(b.fetchplaylist(d),5);case 5:return f.yield(b.fetchscanthumbs(),6);case 6:b.pushhist(d);case 3:f.enterFinallyBlock();eventHub.emit("ajax",-1);f.leaveFinallyBlock(0);break;case 2:e=f.enterCatchBlock(),ajaxfail(e),f.jumpTo(3)}})})();else if(extfmt.books[c]||extfmt.texts[c])c=mediaurl(a,1,0),window.open(c,a.name)}},onselect:function(a){this.selfile&&(this.selfile.selected=!1);if(this.selfile=a)a.selected=!0},onplayback:function(a,
b){a.playback=b}},created:function(){eventHub.on("auth",this.authclosure);eventHub.on("ajax",viewpreloader);eventHub.on("open",this.onopen);eventHub.on("select",this.onselect);eventHub.on("playback",this.onplayback);auth.signload();this.login=auth.login;devmode&&this.isauth&&(console.log("token:",auth.token),console.log("login:",auth.login))},mounted:function(){var a=this,b=decodeURI(window.location.pathname).split("/");b.shift();0<b[b.length-1].length&&b.push("");"dev"===b[0]&&b.shift();"id"===b[0].substr(0,
2)?(this.aid=Number(b[0].substr(2)),b.shift()):this.aid=1;var c=document.getElementById("diskadd"+this.iid);c&&(this.diskadd=new bootstrap.Modal(c),c.addEventListener("shown.bs.modal",function(f){c.querySelector("input").focus()}));var d={aid:this.aid},e=b[0];b.shift();"ctgr"===e?(d.cid=b[0],b.shift()):"path"===e?d.path=b.join("/"):"main"===e&&(d.cid="home");d.cid||d.path||(d.cid="home");(function(){var f,g,h,k,l,m,p,q,n,u,r,v,w;return $jscomp.asyncExecutePromiseGeneratorProgram(function(t){switch(t.nextAddress){case 1:return eventHub.emit("ajax",
1),t.setCatchFinallyBlocks(2,3),t.yield(fetch("/data/assets/resmodel.json"),5);case 5:f=t.yieldResult;if(!f.ok)throw new HttpError(f.status,{what:"can not load resources model file",when:Date.now(),code:0});g=a;return t.yield(f.json(),6);case 6:g.resmodel=resmodel=t.yieldResult;k=null!=(h=sessionStorage.getItem("skinid"))?h:a.resmodel.defskinid;l=$jscomp.makeIterator(a.resmodel.skinlist);for(m=l.next();!m.done;m=l.next())p=m.value,p.id===k&&(q=void 0,null==(q=document.getElementById("skinmodel"))||
q.setAttribute("href",p.link),a.skinid=k);u=null!=(n=sessionStorage.getItem("iconid"))?n:a.resmodel.deficonid;r=$jscomp.makeIterator(a.resmodel.iconlist);m=r.next();case 7:if(m.done)return t.yield(a.fetchopenroute(d),12);v=m.value;if(v.id!==u){t.jumpTo(8);break}return t.yield(a.fetchicons(v.link),11);case 11:a.iconid=u;case 8:m=r.next();t.jumpTo(7);break;case 12:if(!a.isadmin||"share"===d.cid){t.jumpTo(13);break}return t.yield(a.fetchshared(),13);case 13:if(a.isadmin||"home"===d.cid){t.jumpTo(15);
break}return t.yield(a.fetchishome(),15);case 15:a.pushhist(d);case 3:t.enterFinallyBlock();eventHub.emit("ajax",-1);t.leaveFinallyBlock(0);break;case 2:w=t.enterCatchBlock(),ajaxfail(w),t.jumpTo(3)}})})();eventHub.emit("ajax",-1)},unmounted:function(){eventHub.off("auth",this.authclosure);eventHub.off("ajax",viewpreloader);eventHub.off("open",this.onopen);eventHub.off("select",this.onselect);eventHub.off("playback",this.onplayback);this.diskadd=null}},VueAuth={template:"#auth-tpl",data:function(){return{isauth:!1,
login:"",password:"",namestate:0,passstate:0}},computed:{clsname:function(){return this.namestate?-1===this.namestate?"is-invalid":"is-valid":""},clspass:function(){return this.passstate?-1===this.passstate?"is-invalid":"is-valid":""}},methods:{onauthchange:function(){this.passstate=this.namestate=0},onlogin:function(){var a=this;(function(){var b,c,d,e,f,g;return $jscomp.asyncExecutePromiseGeneratorProgram(function(h){switch(h.nextAddress){case 1:return eventHub.emit("ajax",1),h.setCatchFinallyBlocks(2,
3),h.yield(fetchjson("POST","/api/auth/pubkey"),5);case 5:return b=h.yieldResult,h.yield(b.json(),6);case 6:c=h.yieldResult;traceajax(b,c);if(!b.ok)throw new HttpError(b.status,c);d=sha256.hmac.create(c);d.update(a.password);return h.yield(fetchjson("POST","/api/auth/signin",{name:a.login,pubk:c,hash:d.digest()}),7);case 7:return e=h.yieldResult,h.yield(e.json(),8);case 8:if(f=h.yieldResult,traceajax(e,f),200===e.status)auth.signin(f,a.login),a.namestate=1,a.passstate=1;else if(403===e.status)switch(auth.signout(),
f.code){case 13:a.namestate=-1;a.passstate=0;break;case 15:a.namestate=1;a.passstate=-1;break;default:a.namestate=-1,a.passstate=-1}else throw new HttpError(e.status,f);case 3:h.enterFinallyBlock();eventHub.emit("ajax",-1);h.leaveFinallyBlock(0);break;case 2:g=h.enterCatchBlock(),ajaxfail(g),h.jumpTo(3)}})})()},onlogout:function(){auth.signout();this.passstate=this.namestate=0},authclosure:function(a){if(this.isauth=a)this.login=auth.login}},created:function(){eventHub.on("auth",this.authclosure)},
unmounted:function(){eventHub.off("auth",this.authclosure)}},appws=Vue.createApp(VueMainApp).component("auth-tag",VueAuth).component("thumbslider-tag",VueThumbSlider).component("photoslider-tag",VuePhotoSlider).component("mp3-player-tag",VuePlayer).component("dir-card-tag",VueDirCard).component("file-card-tag",VueFileCard).component("map-card-tag",VueMapCard).component("icon-tag",VueIcon).component("file-icon-tag",VueFileIcon).component("img-icon-tag",VueImgIcon),appvm=appws.mount("#app");
