var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.makeIterator=function(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};$jscomp.arrayFromIterator=function(a){for(var b,c=[];!(b=a.next()).done;)c.push(b.value);return c};
$jscomp.arrayFromIterable=function(a){return a instanceof Array?a:$jscomp.arrayFromIterator($jscomp.makeIterator(a))};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.objectCreate=$jscomp.ASSUME_ES5||"function"==typeof Object.create?Object.create:function(a){var b=function(){};b.prototype=a;return new b};$jscomp.underscoreProtoCanBeSet=function(){var a={a:!0},b={};try{return b.__proto__=a,b.a}catch(c){}return!1};
$jscomp.setPrototypeOf="function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null;
$jscomp.inherits=function(a,b){a.prototype=$jscomp.objectCreate(b.prototype);a.prototype.constructor=a;if($jscomp.setPrototypeOf){var c=$jscomp.setPrototypeOf;c(a,b)}else for(c in b)if("prototype"!=c)if(Object.defineProperties){var d=Object.getOwnPropertyDescriptor(b,c);d&&Object.defineProperty(a,c,d)}else a[c]=b[c];a.superClass_=b.prototype};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(a){function b(){this.batch_=null}function c(a){return a instanceof e?a:new e(function(b,c){b(a)})}if(a&&!$jscomp.FORCE_POLYFILL_PROMISE)return a;b.prototype.asyncExecute=function(a){if(null==this.batch_){this.batch_=[];var b=this;this.asyncExecuteFunction(function(){b.executeBatch_()})}this.batch_.push(a)};var d=$jscomp.global.setTimeout;b.prototype.asyncExecuteFunction=function(a){d(a,0)};b.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var a=
this.batch_;this.batch_=[];for(var b=0;b<a.length;++b){var c=a[b];a[b]=null;try{c()}catch(l){this.asyncThrow_(l)}}}this.batch_=null};b.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a;})};var e=function(a){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var b=this.createResolveAndReject_();try{a(b.resolve,b.reject)}catch(k){b.reject(k)}};e.prototype.createResolveAndReject_=function(){function a(a){return function(d){c||(c=!0,a.call(b,d))}}var b=this,c=!1;
return{resolve:a(this.resolveTo_),reject:a(this.reject_)}};e.prototype.resolveTo_=function(a){if(a===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(a instanceof e)this.settleSameAsPromise_(a);else{a:switch(typeof a){case "object":var b=null!=a;break a;case "function":b=!0;break a;default:b=!1}b?this.resolveToNonPromiseObj_(a):this.fulfill_(a)}};e.prototype.resolveToNonPromiseObj_=function(a){var b=void 0;try{b=a.then}catch(k){this.reject_(k);return}"function"==typeof b?
this.settleSameAsThenable_(b,a):this.fulfill_(a)};e.prototype.reject_=function(a){this.settle_(2,a)};e.prototype.fulfill_=function(a){this.settle_(1,a)};e.prototype.settle_=function(a,b){if(0!=this.state_)throw Error("Cannot settle("+a+", "+b+"): Promise already settled in state"+this.state_);this.state_=a;this.result_=b;this.executeOnSettledCallbacks_()};e.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var a=0;a<this.onSettledCallbacks_.length;++a)f.asyncExecute(this.onSettledCallbacks_[a]);
this.onSettledCallbacks_=null}};var f=new b;e.prototype.settleSameAsPromise_=function(a){var b=this.createResolveAndReject_();a.callWhenSettled_(b.resolve,b.reject)};e.prototype.settleSameAsThenable_=function(a,b){var c=this.createResolveAndReject_();try{a.call(b,c.resolve,c.reject)}catch(l){c.reject(l)}};e.prototype.then=function(a,b){function c(a,b){return"function"==typeof a?function(b){try{d(a(b))}catch(p){f(p)}}:b}var d,f,g=new e(function(a,b){d=a;f=b});this.callWhenSettled_(c(a,d),c(b,f));return g};
e.prototype.catch=function(a){return this.then(void 0,a)};e.prototype.callWhenSettled_=function(a,b){function c(){switch(d.state_){case 1:a(d.result_);break;case 2:b(d.result_);break;default:throw Error("Unexpected state: "+d.state_);}}var d=this;null==this.onSettledCallbacks_?f.asyncExecute(c):this.onSettledCallbacks_.push(c)};e.resolve=c;e.reject=function(a){return new e(function(b,c){c(a)})};e.race=function(a){return new e(function(b,d){for(var e=$jscomp.makeIterator(a),f=e.next();!f.done;f=e.next())c(f.value).callWhenSettled_(b,
d)})};e.all=function(a){var b=$jscomp.makeIterator(a),d=b.next();return d.done?c([]):new e(function(a,e){function f(b){return function(c){g[b]=c;h--;0==h&&a(g)}}var g=[],h=0;do g.push(void 0),h++,c(d.value).callWhenSettled_(f(g.length-1),e),d=b.next();while(!d.done)})};return e},"es6","es3");$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};
$jscomp.SymbolClass=function(a,b){this.$jscomp$symbol$id_=a;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:b})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};$jscomp.Symbol=function(){function a(c){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(c||"")+"_"+b++,c)}var b=0;return a}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.asyncIterator;a||(a=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.generator={};
$jscomp.generator.ensureIteratorResultIsObject_=function(a){if(!(a instanceof Object))throw new TypeError("Iterator result "+a+" is not an object");};$jscomp.generator.Context=function(){this.isRunning_=!1;this.yieldAllIterator_=null;this.yieldResult=void 0;this.nextAddress=1;this.finallyAddress_=this.catchAddress_=0;this.finallyContexts_=this.abruptCompletion_=null};
$jscomp.generator.Context.prototype.start_=function(){if(this.isRunning_)throw new TypeError("Generator is already running");this.isRunning_=!0};$jscomp.generator.Context.prototype.stop_=function(){this.isRunning_=!1};$jscomp.generator.Context.prototype.jumpToErrorHandler_=function(){this.nextAddress=this.catchAddress_||this.finallyAddress_};$jscomp.generator.Context.prototype.next_=function(a){this.yieldResult=a};
$jscomp.generator.Context.prototype.throw_=function(a){this.abruptCompletion_={exception:a,isException:!0};this.jumpToErrorHandler_()};$jscomp.generator.Context.prototype.return=function(a){this.abruptCompletion_={return:a};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.jumpThroughFinallyBlocks=function(a){this.abruptCompletion_={jumpTo:a};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.yield=function(a,b){this.nextAddress=b;return{value:a}};
$jscomp.generator.Context.prototype.yieldAll=function(a,b){a=$jscomp.makeIterator(a);var c=a.next();$jscomp.generator.ensureIteratorResultIsObject_(c);if(c.done)this.yieldResult=c.value,this.nextAddress=b;else return this.yieldAllIterator_=a,this.yield(c.value,b)};$jscomp.generator.Context.prototype.jumpTo=function(a){this.nextAddress=a};$jscomp.generator.Context.prototype.jumpToEnd=function(){this.nextAddress=0};
$jscomp.generator.Context.prototype.setCatchFinallyBlocks=function(a,b){this.catchAddress_=a;void 0!=b&&(this.finallyAddress_=b)};$jscomp.generator.Context.prototype.setFinallyBlock=function(a){this.catchAddress_=0;this.finallyAddress_=a||0};$jscomp.generator.Context.prototype.leaveTryBlock=function(a,b){this.nextAddress=a;this.catchAddress_=b||0};
$jscomp.generator.Context.prototype.enterCatchBlock=function(a){this.catchAddress_=a||0;a=this.abruptCompletion_.exception;this.abruptCompletion_=null;return a};$jscomp.generator.Context.prototype.enterFinallyBlock=function(a,b,c){c?this.finallyContexts_[c]=this.abruptCompletion_:this.finallyContexts_=[this.abruptCompletion_];this.catchAddress_=a||0;this.finallyAddress_=b||0};
$jscomp.generator.Context.prototype.leaveFinallyBlock=function(a,b){b=this.finallyContexts_.splice(b||0)[0];if(b=this.abruptCompletion_=this.abruptCompletion_||b){if(b.isException)return this.jumpToErrorHandler_();void 0!=b.jumpTo&&this.finallyAddress_<b.jumpTo?(this.nextAddress=b.jumpTo,this.abruptCompletion_=null):this.nextAddress=this.finallyAddress_}else this.nextAddress=a};$jscomp.generator.Context.prototype.forIn=function(a){return new $jscomp.generator.Context.PropertyIterator(a)};
$jscomp.generator.Context.PropertyIterator=function(a){this.object_=a;this.properties_=[];for(var b in a)this.properties_.push(b);this.properties_.reverse()};$jscomp.generator.Context.PropertyIterator.prototype.getNext=function(){for(;0<this.properties_.length;){var a=this.properties_.pop();if(a in this.object_)return a}return null};$jscomp.generator.Engine_=function(a){this.context_=new $jscomp.generator.Context;this.program_=a};
$jscomp.generator.Engine_.prototype.next_=function(a){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_.next,a,this.context_.next_);this.context_.next_(a);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.return_=function(a){this.context_.start_();var b=this.context_.yieldAllIterator_;if(b)return this.yieldAllStep_("return"in b?b["return"]:function(a){return{value:a,done:!0}},a,this.context_.return);this.context_.return(a);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.throw_=function(a){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_["throw"],a,this.context_.next_);this.context_.throw_(a);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.yieldAllStep_=function(a,b,c){try{var d=a.call(this.context_.yieldAllIterator_,b);$jscomp.generator.ensureIteratorResultIsObject_(d);if(!d.done)return this.context_.stop_(),d;var e=d.value}catch(f){return this.context_.yieldAllIterator_=null,this.context_.throw_(f),this.nextStep_()}this.context_.yieldAllIterator_=null;c.call(this.context_,e);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.nextStep_=function(){for(;this.context_.nextAddress;)try{var a=this.program_(this.context_);if(a)return this.context_.stop_(),{value:a.value,done:!1}}catch(b){this.context_.yieldResult=void 0,this.context_.throw_(b)}this.context_.stop_();if(this.context_.abruptCompletion_){a=this.context_.abruptCompletion_;this.context_.abruptCompletion_=null;if(a.isException)throw a.exception;return{value:a.return,done:!0}}return{value:void 0,done:!0}};
$jscomp.generator.Generator_=function(a){this.next=function(b){return a.next_(b)};this.throw=function(b){return a.throw_(b)};this.return=function(b){return a.return_(b)};$jscomp.initSymbolIterator();this[Symbol.iterator]=function(){return this}};$jscomp.generator.createGenerator=function(a,b){b=new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(b));$jscomp.setPrototypeOf&&$jscomp.setPrototypeOf(b,a.prototype);return b};
$jscomp.asyncExecutePromiseGenerator=function(a){function b(b){return a.next(b)}function c(b){return a.throw(b)}return new Promise(function(d,e){function f(a){a.done?d(a.value):Promise.resolve(a.value).then(b,c).then(f,e)}f(a.next())})};$jscomp.asyncExecutePromiseGeneratorFunction=function(a){return $jscomp.asyncExecutePromiseGenerator(a())};$jscomp.asyncExecutePromiseGeneratorProgram=function(a){return $jscomp.asyncExecutePromiseGenerator(new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(a)))};
$jscomp.checkStringArgs=function(a,b,c){if(null==a)throw new TypeError("The 'this' value for String.prototype."+c+" must not be null or undefined");if(b instanceof RegExp)throw new TypeError("First argument to String.prototype."+c+" must not be a regular expression");return a+""};
$jscomp.polyfill("String.prototype.repeat",function(a){return a?a:function(a){var b=$jscomp.checkStringArgs(this,null,"repeat");if(0>a||1342177279<a)throw new RangeError("Invalid count value");a|=0;for(var d="";a;)if(a&1&&(d+=b),a>>>=1)b+=b;return d}},"es6","es3");$jscomp.findInternal=function(a,b,c){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var f=a[e];if(b.call(c,f,e,a))return{i:e,v:f}}return{i:-1,v:void 0}};
$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).v}},"es6","es3");$jscomp.polyfill("Array.prototype.findIndex",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).i}},"es6","es3");var buildvers="0.7.4",builddate="2021.05.02",devmode=!1,traceajax=function(){};if("undefined"===typeof $.fn.popover)throw Error("Bootstrap library required");String.prototype.format||(String.prototype.format=function(){var a=arguments;return this.replace(/{(\d+)}/g,function(b,c){return"undefined"!==typeof a[c]?a[c]:b})});
String.prototype.printf||(String.prototype.printf=function(){var a=Array.prototype.slice.call(arguments),b=-1;return this.replace(/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g,function(c,d,e,f,h,g){if("%%"===c)return"%";if(void 0!==a[++b]){c=f?parseInt(f.substr(1)):void 0;f=h?parseInt(h.substr(1)):void 0;switch(g){case "s":var k=a[b];break;case "c":k=a[b][0];break;case "f":k=parseFloat(a[b]).toFixed(c);break;case "p":k=parseFloat(a[b]).toPrecision(c);break;case "e":k=parseFloat(a[b]).toExponential(c);
break;case "x":k=parseInt(a[b]).toString(f?f:16);break;case "d":k=parseFloat(parseInt(a[b],f?f:10).toPrecision(c)).toFixed(0)}k="object"===typeof k?JSON.stringify(k):k.toString(f);c=parseInt(e);for(e=e&&"0"===e[0]?"0":" ";k.length<c;)k=void 0!==d?k+e:e+k;return k}})});
var pathjoin=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];return b.map(function(a,b){return 0===b?a.trim().replace(/[\/]*$/g,""):a.trim().replace(/(^[\/]*|[\/]*$)/g,"")}).filter(function(a){return a.length}).join("/")},pathext=function(a){return a.substr(a.lastIndexOf(".")).toLowerCase()},fmtfilesize=function(a){return 1536>a?a+" bytes":1048576>a?(a/1024).toPrecision(3)+" kB":1073741824>a?(a/1048576).toPrecision(3)+" MB":1099511627776>a?(a/1073741824).toPrecision(3)+" GB":
(a/1099511627776).toPrecision(3)+" TB"},fmtitemsize=function(a){return 1536>a?fmtfilesize(a):"%s (%d bytes)".printf(fmtfilesize(a),a)},fmttime=function(a,b){var c=function(a,b){a=Math.floor(a).toString();b-=a.length;return 0<b?"0".repeat(b)+a:a};if(60>b)return c(a,2);if(3600>b)return b=a%60,c(a/60,2)+":"+c(b,2);b=a%60;var d=a%3600/60;return c(a/3600,2)+":"+c(d,2)+":"+c(b,2)},makestrid=function(a){for(var b="",c=0;c<a;c++)b+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(62*
Math.random()));return b},makeeventmodel=function(){var a=[];return{emit:function(b,c){for(var d=[],e=1;e<arguments.length;++e)d[e-1]=arguments[e];for(e=0;e<a.length;){var f=$jscomp.makeIterator(a[e]),h=f.next().value,g=f.next().value;f=f.next().value;if(h===b){f&&(a.splice(e,1),e--);try{g.apply(null,$jscomp.arrayFromIterable(d))}catch(k){console.error(k)}}e++}},on:function(b,c,d){return a.push([b,c,void 0===d?!1:d])},once:function(b,c){return a.push([b,c,!0])},off:function(b,c){for(var d=0;d<a.length;){var e=
$jscomp.makeIterator(a[d]),f=e.next().value;e=e.next().value;f!==b&&b||e!==c&&c?d++:a.splice(d,1)}},onmap:function(b){for(var c in b)a.push([c,b[c],!1])},offmap:function(b){for(var c in b){var d=b[c],e;for(e in a.length){var f=$jscomp.makeIterator(a[e]),h=f.next().value;f=f.next().value;if(h===c&&f===d){a.splice(e,1);break}}}},listens:function(b,c){for(var d=0,e=$jscomp.makeIterator(a),f=e.next();!f.done;f=e.next()){var h=$jscomp.makeIterator(f.value);f=h.next().value;h=h.next().value;f!==b&&b||h!==
c&&c||d++}return d},listenlen:function(){return a.length}}},extend=function(a,b){for(var c in b)a[c]=b[c];return a};var auth=extend({token:{access:null,refrsh:null},login:"",signed:function(){return!!this.token.access},claims:function(){try{var a=this.token.access.split(".");return JSON.parse(atob(a[1]))}catch(b){return null}},signin:function(a,b){sessionStorage.setItem("token",JSON.stringify(a));this.token.access=a.access;this.token.refrsh=a.refrsh;b&&(sessionStorage.setItem("login",b),this.login=b);this.emit("auth",!0)},signout:function(){sessionStorage.removeItem("token");this.token.access=null;this.token.refrsh=
null;this.emit("auth",!1)},signload:function(){try{var a=JSON.parse(sessionStorage.getItem("token"));this.token.access=a.access;this.token.refrsh=a.refrsh;this.login=sessionStorage.getItem("login")||"";this.emit("auth",!0)}catch(b){this.token.access=null,this.token.refrsh=null,this.login="",this.emit("auth",!1)}}},makeeventmodel()),ajaxcc=extend({},makeeventmodel()),HttpError=function(a,b){var c=Error.call(this,b.what);this.message=c.message;"stack"in c&&(this.stack=c.stack);this.name="HttpError";
this.status=a;extend(this,b)};$jscomp.inherits(HttpError,Error);
var ajaxheader=function(a){var b={Accept:"application/json;charset=utf-8","Content-Type":"application/json;charset=utf-8"};a&&auth.token.access&&(b.Authorization="Bearer "+auth.token.access);return b},fetchjson=function(a,b,c){return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){return 1==d.nextAddress?d.yield(fetch(b,{method:a,headers:ajaxheader(!1),body:JSON.stringify(c)}),2):d.return(d.yieldResult)})},fetchajax=function(a,b,c){var d,e;return $jscomp.asyncExecutePromiseGeneratorProgram(function(f){if(1==
f.nextAddress)return f.yield(fetch(b,{method:a,headers:ajaxheader(!1),body:c&&JSON.stringify(c)}),2);if(3!=f.nextAddress)return e=d=f.yieldResult,f.yield(d.json(),3);e.data=f.yieldResult;return f.return(d)})},fetchjsonauth=function(a,b,c){var d,e,f,h;return $jscomp.asyncExecutePromiseGeneratorProgram(function(g){switch(g.nextAddress){case 1:return g.yield(fetch(b,{method:a,headers:ajaxheader(!0),body:c&&JSON.stringify(c)}),2);case 2:d=g.yieldResult;if(401!==d.status||!auth.token.refrsh){g.jumpTo(3);
break}return g.yield(fetchjson("POST","/api/auth/refrsh",{refrsh:auth.token.refrsh}),4);case 4:return e=g.yieldResult,g.yield(e.json(),5);case 5:f=g.yieldResult;if(!e.ok)throw new HttpError(e.status,f);auth.signin(f);h=fetch(b,{method:a,headers:ajaxheader(!0),body:c&&JSON.stringify(c)});return g.return(h);case 3:return g.return(d)}})},fetchajaxauth=function(a,b,c){var d,e;return $jscomp.asyncExecutePromiseGeneratorProgram(function(f){if(1==f.nextAddress)return f.yield(fetchjsonauth(a,b,c),2);if(3!=
f.nextAddress)return e=d=f.yieldResult,f.yield(d.json(),3);e.data=f.yieldResult;return f.return(d)})};var imempty={private:{blank:"",label:"",cid:{cid:""},drive:{},folder:{},grp:{},ext:{}},shared:{blank:"",label:"",cid:{cid:""},drive:{},folder:{},grp:{},ext:{}}},filetmbwebp=function(a,b){return 1!==a.ntmb&&b.iconwebp?(a=geticonpath(a,b,!1),(a.org||a.alt)+".webp"):""},filetmbpng=function(a,b){return 1===a.ntmb?"/id"+app.aid+"/thumb/"+a.puid:b.iconpng?(a=geticonpath(a,b,!1),(a.org||a.alt)+".png"):""},filetmbimg=function(a){return 1===a.ntmb?"/id"+app.aid+"/thumb/"+a.puid:iconmapping.iconpng?(a=geticonpath(a,
iconmapping,!1),(a.org||a.alt)+".png"):iconmapping.iconwebp?(a=geticonpath(a,iconmapping,!1),(a.org||a.alt)+".webp"):""},makemarkercontent=function(a){return'\n<div class="photoinfo">\n\t<ul class="nav nav-tabs" role="tablist">\n\t\t<li class="nav-item"><a class="nav-link active" data-toggle="tab" href="#pict">Thumbnail</a></li>\n\t\t<li class="nav-item"><a class="nav-link" data-toggle="tab" href="#prop">Properties</a></li>\n\t</ul>\n\t<div class="tab-content">\n\t\t<div class="tab-pane active" id="pict">\n\t\t\t<picture>\n\t\t\t\t<source srcset="'+
filetmbwebp(a,iconmapping)+'" type="image/webp">\n\t\t\t\t<source srcset="'+filetmbpng(a,iconmapping)+'" type="image/png">\n\t\t\t\t<img class="rounded thumb" alt="'+a.name+'">\n\t\t\t</picture>\n\t\t\t<div class="d-flex flex-wrap latlng">\n\t\t\t\t<div><div class="name">lat:</div> <div class="value">'+a.latitude.toFixed(6)+'</div></div>\n\t\t\t\t<div><div class="name">lng:</div> <div class="value">'+a.longitude.toFixed(6)+'</div></div>\n\t\t\t\t<div><div class="name">alt:</div> <div class="value">'+
(a.altitude||"N/A")+'</div></div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="tab-pane fade" id="prop">\n\t\t\t<ul class="prop p-0 m-0"><li>'+filehint(a).join("</li><li>")+"</li></ul>\n\t\t</div>\n\t</div>\n</div>\n"},filehint=function(a){var b=[];b.push(a.name);a.type||b.push("size: "+fmtitemsize(a.size||0));a.time&&b.push("time: "+(new Date(a.time)).toLocaleString());a.title&&b.push("title: "+a.title);a.album&&b.push("album: "+a.album);a.artist&&b.push("artist: "+a.artist);a.composer&&b.push("composer: "+
a.composer);a.genre&&b.push("genre: "+a.genre);a.year&&b.push("year: "+a.year);a.track&&(a.track.number||a.track.total)&&b.push("track: "+(a.track.number||"")+"/"+(a.track.total||""));a.disc&&(a.disc.number||a.disc.total)&&b.push("disc: "+(a.disc.number||"")+"/"+(a.disc.total||""));a.comment&&b.push("comment: "+a.comment.substring(0,80));a.width&&a.height&&b.push("dimension: "+a.width+"x"+a.height);a.model&&b.push("model: "+a.model);a.make&&b.push("manufacturer: "+a.make);a.datetime&&b.push("photo taken: "+
(new Date(a.datetime)).toLocaleString());if(a.orientation)switch(a.orientation){case 1:b.push("orientation: normal");break;case 2:b.push("orientation: horizontal reversed");break;case 3:b.push("orientation: flipped");break;case 4:b.push("orientation: flipped & horizontal reversed");break;case 5:b.push("orientation: clockwise turned & horizontal reversed");break;case 6:b.push("orientation: clockwise turned");break;case 7:b.push("orientation: anticlockwise turned & horizontal reversed");break;case 8:b.push("orientation: anticlockwise turned")}if(a.exposureprog)switch(a.exposureprog){case 1:b.push("exposure program: manual");
break;case 2:b.push("exposure program: normal program");break;case 3:b.push("exposure program: aperture priority");break;case 4:b.push("exposure program: shutter priority");break;case 5:b.push("exposure program: creative program (depth of field)");break;case 6:b.push("exposure program: action program (fast shutter speed)");break;case 7:b.push("exposure program: portrait mode (background out of focus)");break;case 8:b.push("exposure program: landscape mode (background in focus)")}a.exposuretime&&b.push("exposure time: "+
a.exposuretime+" sec");a.fnumber&&b.push("F-number: f/"+a.fnumber);a.isospeed&&b.push("ISO speed rating: ISO-"+a.isospeed);a.shutterspeed&&b.push("shutter speed: "+a.shutterspeed);a.aperture&&b.push("lens aperture: "+a.aperture);a.exposurebias&&b.push("exposure bias: "+a.exposurebias);if(a.lightsource)switch(a.lightsource){case 1:b.push("light source: daylight");break;case 2:b.push("light source: fluorescent");break;case 3:b.push("light source: tungsten (incandescent light)");break;case 4:b.push("light source: flash");
break;case 9:b.push("light source: fine weather");break;case 10:b.push("light source: cloudy weather");break;case 11:b.push("light source: shade");break;case 12:b.push("light source: daylight fluorescent (D 5700-7100K)");break;case 13:b.push("light source: day white fluorescent (N 4600-5700K)");break;case 14:b.push("light source: cool white fluorescent (W 3800-4600K)");break;case 15:b.push("light source: white fluorescent (WW 3250-3800K)");break;case 16:b.push("light source: warm white fluorescent (L 2600-3250K)");
break;case 17:b.push("light source: standard light A");break;case 18:b.push("light source: standard light B");break;case 19:b.push("light source: standard light C");break;case 20:b.push("light source: D55");break;case 21:b.push("light source: D65");break;case 22:b.push("light source: D75");break;case 23:b.push("light source: D50");break;case 24:b.push("light source: ISO studio tungsten");break;case 255:b.push("light source: other light source");break;default:b.push("light source: light code #"+a.lightsource)}a.focal&&
b.push("focal length: "+a.focal+" mm");a.focal35mm&&b.push("35mm equivalent focal length: "+a.focal35mm+" mm");a.digitalzoom&&b.push("digital zoom ratio: "+a.digitalzoom);a.flash&&(a.flash&1?b.push("flash fired"):b.push("flash did not fire"),4===(a.flash&6)?b.push("strobe return light: not detected"):6===(a.flash&6)&&b.push("strobe return light: detected"),8===(a.flash&24)?b.push("flash mode: compulsory flash firing"):16===(a.flash&24)?b.push("flash mode: compulsory flash suppression"):24===(a.flash&
24)&&b.push("flash mode: auto"),a.flash&64&&b.push("red-eye reduction supported"));a.uniqueid&&b.push("unique ID: "+a.uniqueid);return b};
Vue.component("file-icon-tag",{template:"#file-icon-tpl",props:["file","state","size"],data:function(){return{im:imempty,tm:!0}},computed:{fmttitle:function(){return filehint(this.file).join("\n")},fmtalt:function(){return pathext(this.file.name)},label:function(){if(1===this.file.ntmb&&this.tm||!geticonpath(this.file,this.im,this.state.shared).org)return this.state.shared?this.im.shared.label:this.im.private.label},webpicon:function(){if(1===this.file.ntmb&&this.tm||!this.im.iconwebp)return"";var a=
geticonpath(this.file,this.im,this.state.shared);return(a.org||a.alt)+".webp"},pngicon:function(){if(1===this.file.ntmb&&this.tm)return"/id"+app.aid+"/thumb/"+this.file.puid;if(this.im.iconpng){var a=geticonpath(this.file,this.im,this.state.shared);return(a.org||a.alt)+".png"}return""},clsoverlay:function(){switch(this.size){case "smicon":return"smoverlay";case "mdicon":return"mdoverlay";case "lgicon":return"lgoverlay"}},clsimage:function(){switch(this.size){case "smicon":return"smimage";case "mdicon":return"mdimage";
case "lgicon":return"lgimage"}},itemview:function(){return{selected:this.state.selected}}},methods:{onselect:function(){this.$emit("select",this.file)},onopen:function(){this.$emit("open",this.file)}},mounted:function(){var a=this;this.im=iconmapping;this.tm=thumbmode;this._plug=function(){a.im=iconmapping};this._thumb=function(){a.tm=thumbmode};iconev.on("plug",this._plug);iconev.on("thumb",this._thumb)},beforeDestroy:function(){iconev.off("plug",this._plug);iconev.off("thumb",this._thumb)}});
Vue.component("img-icon-tag",{template:"#img-icon-tpl",props:["file","state"],data:function(){return{im:imempty,tm:!0}},computed:{fmttitle:function(){return filehint(this.file).join("\n")},fmtalt:function(){return pathext(this.file.name)},label:function(){if(1===this.file.ntmb&&this.tm||!geticonpath(this.file,this.im,this.state.shared).org)return this.state.shared?this.im.shared.label:this.im.private.label},webpicon:function(){if(1===this.file.ntmb&&this.tm||!this.im.iconwebp)return"";var a=geticonpath(this.file,
this.im,this.state.shared);return(a.org||a.alt)+".webp"},pngicon:function(){if(1===this.file.ntmb&&this.tm)return"/id"+app.aid+"/thumb/"+this.file.puid;if(this.im.iconpng){var a=geticonpath(this.file,this.im,this.state.shared);return(a.org||a.alt)+".png"}return""},itemview:function(){return{selected:this.state.selected}}},methods:{onselect:function(){this.$emit("select",this.file)},onopen:function(){this.$emit("open",this.file)}},mounted:function(){var a=this;this.im=iconmapping;this.tm=thumbmode;
this._plug=function(){a.im=iconmapping};this._thumb=function(){a.tm=thumbmode};iconev.on("plug",this._plug);iconev.on("thumb",this._thumb)},beforeDestroy:function(){iconev.off("plug",this._plug);iconev.off("thumb",this._thumb)}});var sortmode={byalpha:"name",bysize:"size",unsorted:""},listmodetag={smicon:"file-icon-tag",mdicon:"file-icon-tag",lgicon:"img-icon-tag"},listmoderow={smicon:"align-items-start",mdicon:"align-items-start",lgicon:"align-items-center"},listmodeicon={smicon:"format_align_justify",mdicon:"view_comfy",lgicon:"view_module"},listmodehint={smicon:"small icons",mdicon:"middle icons",lgicon:"large icons"},listmodenext={smicon:"mdicon",mdicon:"lgicon",lgicon:"smicon"},noderadius=15,gpxcolors="#6495ED #DA70D6 #DAA520 #9370DB #DB7093 #8FBC8F #FF7F50 #9ACD32 #BC8F8F #5F9EA0 #778899 #F4A460 #FA8072 #20B2AA #4169E1".split(" "),
copyTextToClipboard=function(a){var b=document.createElement("textarea");b.value=a;b.style.position="fixed";b.style.left="0px";b.style.top="0px";document.body.appendChild(b);b.focus();b.select();try{return!document.execCommand("copy")&&"copying text command was failed"}catch(c){return c}finally{document.body.removeChild(b)}};
Vue.component("dir-card-tag",{template:"#dir-card-tpl",props:["list","shared"],data:function(){return{isauth:!1,selfile:null,sortorder:1,listmode:"smicon",diskpath:"",diskpathstate:0,iid:makestrid(10)}},computed:{isadmin:function(){return this.isauth||"localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname},isvisible:function(){var a=this;(function(){a.list.find(function(b){return b===a.selfile})||(a.selfile=null)})();return 0<this.list.length},sortable:function(){for(var a=
$jscomp.makeIterator(this.list),b=a.next();!b.done;b=a.next())if(b.value.type===FT.ctgr)return!1;return!0},sortedlist:function(){var a=this;return this.sortable?this.list.slice().sort(function(b,c){return a.sortorder*(b.name.toLowerCase()>c.name.toLowerCase()?1:-1)}):this.list},clsfilelist:function(){return listmoderow[this.listmode]},dislink:function(){return!this.selfile||this.selfile.type===FT.ctgr},disshared:function(){return!this.selfile},clsshared:function(){return{active:this.selfile&&this.isshared(this.selfile)}},
disdiskadd:function(){return!this.diskpath.length},disdiskremove:function(){return!this.selfile||this.selfile.type!==FT.drv},clsorder:function(){return 0<this.sortorder?"arrow_downward":"arrow_upward"},clslistmode:function(){return listmodeicon[this.listmode]},clsdiskpathedt:function(){return this.diskpathstate?-1===this.passstate?"is-invalid":"is-valid":""},iconmodetag:function(){return listmodetag[this.listmode]},hintorder:function(){return 0<this.sortorder?"direct order":"reverse order"},hintlist:function(){return listmodehint[this.listmode]}},
methods:{isshared:function(a){for(var b=$jscomp.makeIterator(this.shared),c=b.next();!c.done;c=b.next())if(c.value.puid===a.puid)return!0;return!1},getstate:function(a){return{selected:this.selfile===a,playback:!1,shared:this.isshared(a)}},onlink:function(){copyTextToClipboard(window.location.origin+pathurl(this.selfile))},onshare:function(){this.$emit("share",this.selfile)},onorder:function(){this.sortorder=-this.sortorder},onlistmode:function(){this.listmode=listmodenext[this.listmode]},ondiskadd:function(){var a=
this;(function(){var b,c,d;return $jscomp.asyncExecutePromiseGeneratorProgram(function(e){switch(e.nextAddress){case 1:return ajaxcc.emit("ajax",1),e.setCatchFinallyBlocks(2,3),e.yield(fetchajaxauth("POST","/api/drive/add",{aid:app.aid,path:a.diskpath}),5);case 5:b=e.yieldResult,traceajax(b),b.ok?((c=b.data)&&a.list.push(c),$("#diskadd"+a.iid).modal("hide")):a.diskpathstate=-1;case 3:e.enterFinallyBlock();ajaxcc.emit("ajax",-1);e.leaveFinallyBlock(0);break;case 2:d=e.enterCatchBlock(),ajaxfail(d),
e.jumpTo(3)}})})()},ondiskremove:function(){var a=this;(function(){var b,c;return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){switch(d.nextAddress){case 1:return ajaxcc.emit("ajax",1),d.setCatchFinallyBlocks(2,3),d.yield(fetchajaxauth("POST","/api/drive/del",{aid:app.aid,puid:a.selfile.puid}),5);case 5:b=d.yieldResult;traceajax(b);if(!b.ok)throw new HttpError(b.status,b.data);if(!b.data){d.jumpTo(3);break}a.list.splice(a.list.findIndex(function(b){return b===a.selfile}),1);if(!a.isshared(a.selfile)){d.jumpTo(3);
break}return d.yield(a.fetchsharedel(a.selfile),3);case 3:d.enterFinallyBlock();ajaxcc.emit("ajax",-1);d.leaveFinallyBlock(0);break;case 2:c=d.enterCatchBlock(),ajaxfail(c),d.jumpTo(3)}})})()},ondiskpathchange:function(a){var b=this;(function(){var a,d;return $jscomp.asyncExecutePromiseGeneratorProgram(function(c){if(1==c.nextAddress)return c.setCatchFinallyBlocks(2),c.yield(fetchajaxauth("POST","/card/path/ispath",{aid:app.aid,path:b.diskpath}),4);if(2!=c.nextAddress)return a=c.yieldResult,b.diskpathstate=
a.ok?a.data?1:0:-1,c.leaveTryBlock(0);d=c.enterCatchBlock();ajaxfail(d);c.jumpToEnd()})})()},onselect:function(a){this.selfile=a},onopen:function(a){this.$emit("open",a)},onunselect:function(){this.onselect(null)}},mounted:function(){var a=this;this._authclosure=function(b){return a.isauth=b};auth.on("auth",this._authclosure);$("#diskadd"+this.iid).on("shown.bs.modal",function(){$(this).find("input").trigger("focus")})},beforeDestroy:function(){auth.off("auth",this._authclosure);$("#diskadd"+this.iid).off("shown.bs.modal")}});
Vue.component("file-card-tag",{template:"#file-card-tpl",props:["list","shared"],data:function(){return{isauth:!1,selfile:null,playbackfile:null,sortorder:1,sortmode:sortmode.byalpha,listmode:"smicon",thumbmode:!0,audio:!0,video:!0,image:!0,books:!0,texts:!0,packs:!0,other:!1,audioonly:!1,viewer:null,iid:makestrid(10)}},computed:{isadmin:function(){return this.isauth||"localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname},isvisible:function(){var a=this;(function(){a.list.find(function(b){return b===
a.selfile})||(a.selfile=null,a.closeviewer())})();return 0<this.list.length},playlist:function(){for(var a=this,b=[],c=$jscomp.makeIterator(this.list),d=c.next();!d.done;d=c.next())d=d.value,this.showitem(d)&&b.push(d);this.sortmode===sortmode.byalpha?b.sort(function(b,c){return a.sortorder*(b.name.toLowerCase()>c.name.toLowerCase()?1:-1)}):this.sortmode===sortmode.bysize&&b.sort(function(b,c){return b.size===c.size?a.sortorder*(b.name.toLowerCase()>c.name.toLowerCase()?1:-1):a.sortorder*(b.size>
c.size?1:-1)});return b},clsfilelist:function(){return listmoderow[this.listmode]},dislink:function(){return!this.selfile||this.selfile.type===FT.ctgr},disshared:function(){return!this.selfile},clsshared:function(){return{active:this.selfile&&this.isshared(this.selfile)}},clsorder:function(){return 0<this.sortorder?"arrow_downward":"arrow_upward"},clssortmode:function(){switch(this.sortmode){case sortmode.byalpha:return"sort_by_alpha";case sortmode.bysize:return"sort";case sortmode.unsorted:return"reorder"}},
clslistmode:function(){return listmodeicon[this.listmode]},showmusic:function(){return!!this.list.find(function(a){return getFileGroup(a)===FG.audio})},showvideo:function(){return!!this.list.find(function(a){return getFileGroup(a)===FG.video})},showphoto:function(){return!!this.list.find(function(a){return getFileGroup(a)===FG.image})},showbooks:function(){return!!this.list.find(function(a){return getFileGroup(a)===FG.books})},showtexts:function(){return!!this.list.find(function(a){return getFileGroup(a)===
FG.texts})},showdisks:function(){return!!this.list.find(function(a){return getFileGroup(a)===FG.packs})},showother:function(){return!!this.list.find(function(a){var b=getFileGroup(a);return!a.type||b===FG.packs||b===FG.other})},clsthumbmode:function(){return{active:this.thumbmode}},clsaudioonly:function(){return{active:this.audioonly}},clsaudio:function(){return{active:this.audio}},clsvideo:function(){return{active:this.video}},clsphoto:function(){return{active:this.image}},clsbooks:function(){return{active:this.books}},
clstexts:function(){return{active:this.texts}},clsdisks:function(){return{active:this.packs}},clsother:function(){return{active:this.other}},iconmodetag:function(){return listmodetag[this.listmode]},hintorder:function(){return 0<this.sortorder?"direct order":"reverse order"},hintsortmode:function(){switch(this.sortmode){case sortmode.byalpha:return"sort by alpha";case sortmode.bysize:return"sort by size";case sortmode.unsorted:return"as is unsorted"}},hintlist:function(){return listmodehint[this.listmode]}},
methods:{showitem:function(a){switch(getFileGroup(a)){case FG.dir:return!0;case FG.audio:return this.audio;case FG.video:return this.video;case FG.image:return this.image;case FG.books:return this.books;case FG.texts:return this.texts;case FG.packs:return this.packs;default:return this.other}},isshared:function(a){for(var b=$jscomp.makeIterator(this.shared),c=b.next();!c.done;c=b.next())if(c.value.puid===a.puid)return!0;return!1},getstate:function(a){return{selected:this.selfile===a,playback:this.playbackfile&&
this.playbackfile.name===a.name,shared:this.isshared(a)}},closeviewer:function(){this.viewer&&(this.viewer.close(),this.viewer.visible=!1,this.viewer=null)},onlink:function(){copyTextToClipboard(window.location.origin+fileurl(this.selfile))},onshare:function(){this.$emit("share",this.selfile)},onorder:function(){this.sortorder=-this.sortorder},onsortmode:function(){switch(this.sortmode){case sortmode.byalpha:this.sortmode=sortmode.bysize;break;case sortmode.bysize:this.sortmode=sortmode.unsorted;
break;case sortmode.unsorted:this.sortmode=sortmode.byalpha}},onlistmode:function(){this.listmode=listmodenext[this.listmode]},onthumbmode:function(){thumbmode=this.thumbmode=!this.thumbmode;iconev.emit("thumb")},onaudioonly:function(){this.audioonly=!this.audioonly},onaudio:function(){this.audio=!this.audio},onvideo:function(){this.video=!this.video},onphoto:function(){this.image=!this.image},onbooks:function(){this.books=!this.books},ontexts:function(){this.texts=!this.texts},ondisks:function(){this.packs=
!this.packs},onother:function(){this.other=!this.other},onselect:function(a){if(this.selfile=a){var b=pathext(a.name);isMainAudio(b)?(this.viewer=this.$refs.mp3player,this.viewer.setup(a),this.viewer.visible=!0):isMainVideo(b)?this.audioonly?this.closeviewer():(this.viewer=this.$refs.mp3player,this.viewer.setup(a),this.viewer.visible=!0):(isMainImage(b),this.closeviewer())}else this.closeviewer()},onopen:function(a){switch(getFileGroup(a)){case FG.image:this.closeviewer();this.$refs.slider.popup(a);
break;case FG.packs:".iso"===pathext(a.name)&&this.$emit("open",a);break;default:var b=mediaurl(a);window.open(b,a.name)}},onunselect:function(){this.onselect(null)},onplayback:function(a){this.playbackfile=a}},mounted:function(){var a=this;this._authclosure=function(b){return a.isauth=b};auth.on("auth",this._authclosure)},beforeDestroy:function(){auth.off("auth",this._authclosure)}});
Vue.component("map-card-tag",{template:"#map-card-tpl",data:function(){return{styleid:"mapbox-hybrid",map:null,tiles:null,markers:null,markermode:"thumb",phototrack:null,showtrack:!1,gpslist:[],gpxlist:[],iid:makestrid(10)}},computed:{isvisible:function(){return 0<this.gpslist.length||0<this.gpxlist.length},clsmapboxhybrid:function(){return{active:"mapbox-hybrid"===this.styleid}},clsmapboxsatellite:function(){return{active:"mapbox-satellite"===this.styleid}},clsmapboxoutdoors:function(){return{active:"mapbox-outdoors"===
this.styleid}},clsmapboxstreets:function(){return{active:"mapbox-streets"===this.styleid}},clsgooglehybrid:function(){return{active:"google-hybrid"===this.styleid}},clsgooglesatellite:function(){return{active:"google-satellite"===this.styleid}},clsgoogleterrain:function(){return{active:"google-terrain"===this.styleid}},clsgooglestreets:function(){return{active:"google-streets"===this.styleid}},clsosm:function(){return{active:"osm"===this.styleid}},clsopentopomap:function(){return{active:"opentopo"===
this.styleid}},clshikebike:function(){return{active:"hikebike"===this.styleid}},clsphototrack:function(){return{active:this.showtrack}},iconmarkermode:function(){switch(this.markermode){case "marker":return"place";case "thumb":return"local_see"}},hintlandscape:function(){switch(this.styleid){case "mapbox-hybrid":return"Mapbox satellite & streets map";case "mapbox-satellite":return"Mapbox satellite map";case "mapbox-outdoors":return"Mapbox outdoors map";case "mapbox-streets":return"Mapbox streets map";
case "google-hybrid":return"Google maps hybrid";case "google-satellite":return"Google maps satellite";case "google-terrain":return"Google maps terrain";case "google-streets":return"Google maps streets";case "osm":return"Open Street Map";case "opentopo":return"Open topo map";case "hikebike":return"HikeBike map"}},hintmarkermode:function(){switch(this.markermode){case "marker":return"photo positions by markers";case "thumb":return"photo positions by thumbnails"}}},methods:{new:function(){if(!this.markers||
0<this.gpslist.length)this.markers&&this.map.removeLayer(this.markers),this.markers=L.markerClusterGroup(),this.map.addLayer(this.markers),this.phototrack&&(this.map.removeLayer(this.phototrack),this.phototrack=null),this.gpslist=[];for(var a=$jscomp.makeIterator(this.gpxlist),b=a.next();!b.done;b=a.next())b=b.value,b.layer&&this.map.removeLayer(b.layer);this.gpxlist=[]},maketiles:function(a){switch(a){case "mapbox-hybrid":return L.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}",
{attribution:'Map data: &copy; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors, Imagery &copy <a href="https://www.mapbox.com/" target="_blank">Mapbox</a>',tileSize:512,minZoom:2,zoomOffset:-1,id:"mapbox/satellite-streets-v11",accessToken:"pk.eyJ1Ijoic2Nod2FyemxpY2h0YmV6aXJrIiwiYSI6ImNrazdseXRxZjBlemsycG8wZ3BodTR1aWUifQ.Mt99AhglX08nolRj_bsyog"});case "mapbox-satellite":return L.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}",
{attribution:'Map data: &copy; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors, Imagery &copy <a href="https://www.mapbox.com/" target="_blank">Mapbox</a>',tileSize:512,minZoom:2,zoomOffset:-1,id:"mapbox/satellite-v9",accessToken:"pk.eyJ1Ijoic2Nod2FyemxpY2h0YmV6aXJrIiwiYSI6ImNrazdseXRxZjBlemsycG8wZ3BodTR1aWUifQ.Mt99AhglX08nolRj_bsyog"});case "mapbox-outdoors":return L.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}",
{attribution:'Map data: &copy; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors, Imagery &copy <a href="https://www.mapbox.com/" target="_blank">Mapbox</a>',tileSize:512,minZoom:2,zoomOffset:-1,id:"mapbox/outdoors-v11",accessToken:"pk.eyJ1Ijoic2Nod2FyemxpY2h0YmV6aXJrIiwiYSI6ImNrazdseXRxZjBlemsycG8wZ3BodTR1aWUifQ.Mt99AhglX08nolRj_bsyog"});case "mapbox-streets":return L.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}",
{attribution:'Map data: &copy; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors, Imagery &copy <a href="https://www.mapbox.com/" target="_blank">Mapbox</a>',tileSize:512,minZoom:2,zoomOffset:-1,id:"mapbox/streets-v11",accessToken:"pk.eyJ1Ijoic2Nod2FyemxpY2h0YmV6aXJrIiwiYSI6ImNrazdseXRxZjBlemsycG8wZ3BodTR1aWUifQ.Mt99AhglX08nolRj_bsyog"});case "google-hybrid":return L.tileLayer("http://{s}.google.com/vt/lyrs=s,h&x={x}&y={y}&z={z}",{subdomains:["mt0","mt1",
"mt2","mt3"],attribution:'Map data: &copy; <a href="https://developers.google.com/maps/documentation/javascript/overview" target="_blank">Google Maps Platform</a> contributors',minZoom:2,maxZoom:20});case "google-satellite":return L.tileLayer("http://{s}.google.com/vt/lyrs=s&x={x}&y={y}&z={z}",{subdomains:["mt0","mt1","mt2","mt3"],attribution:'Map data: &copy; <a href="https://developers.google.com/maps/documentation/javascript/overview" target="_blank">Google Maps Platform</a> contributors',minZoom:2,
maxZoom:20});case "google-terrain":return L.tileLayer("http://{s}.google.com/vt/lyrs=p&x={x}&y={y}&z={z}",{subdomains:["mt0","mt1","mt2","mt3"],attribution:'Map data: &copy; <a href="https://developers.google.com/maps/documentation/javascript/overview" target="_blank">Google Maps Platform</a> contributors',minZoom:2,maxZoom:20});case "google-streets":return L.tileLayer("http://{s}.google.com/vt/lyrs=m&x={x}&y={y}&z={z}",{subdomains:["mt0","mt1","mt2","mt3"],attribution:'Map data: &copy; <a href="https://developers.google.com/maps/documentation/javascript/overview" target="_blank">Google Maps Platform</a> contributors',
minZoom:2,maxZoom:20});case "osm":return L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19,attribution:'Map data: &copy; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors'});case "opentopo":return L.tileLayer("https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png",{attribution:'Map data: &copy; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors, <a href="http://viewfinderpanoramas.org" target="_blank">SRTM</a> | Map style: &copy; <a href="https://opentopomap.org" target="_blank">OpenTopoMap</a>',
minZoom:2,maxZoom:17});case "hikebike":return L.tileLayer("https://tiles.wmflabs.org/hikebike/{z}/{x}/{y}.png",{attribution:'Map data: &copy; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors',minZoom:2,maxZoom:19})}},changetiles:function(a){this.map.removeLayer(this.tiles);this.styleid=a;this.tiles=this.maketiles(a);this.map.addLayer(this.tiles)},addmarkers:function(a){var b=this;if(a.length){for(var c={},d=$jscomp.makeIterator(a),e=d.next();!e.done;c=
{$jscomp$loop$prop$file$38:c.$jscomp$loop$prop$file$38},e=d.next()){c.$jscomp$loop$prop$file$38=e.value;e={title:c.$jscomp$loop$prop$file$38.name,riseOnHover:!0};"thumb"===this.markermode&&c.$jscomp$loop$prop$file$38.puid&&(e.icon=L.divIcon({html:'<img src="'+filetmbimg(c.$jscomp$loop$prop$file$38)+'">',className:"photomarker",iconSize:[60,60],iconAnchor:[30,30],popupAnchor:[0,-15]}));var f=document.createElement("template");f.innerHTML=makemarkercontent(c.$jscomp$loop$prop$file$38).trim();f=f.content.firstChild;
f.querySelector(".photoinfo picture").addEventListener("click",function(a){return function(){b.$refs.slider.popup(a.$jscomp$loop$prop$file$38)}}(c));L.marker([c.$jscomp$loop$prop$file$38.latitude,c.$jscomp$loop$prop$file$38.longitude],e).addTo(this.markers).bindPopup(f)}var h=!this.gpslist.length;Vue.nextTick(function(){h&&b.map.invalidateSize();b.onfitbounds()});this.gpslist.push.apply(this.gpslist,$jscomp.arrayFromIterable(a));this.showtrack&&this.makephototrack()}},makephototrack:function(){for(var a=
L.latLng(this.gpslist[0].latitude,this.gpslist[0].longitude,this.gpslist[0].altitude),b=a,c=0,d=0,e=0,f=[a],h=$jscomp.makeIterator(this.gpslist),g=h.next();!g.done;g=h.next()){g=g.value;g=L.latLng(g.latitude,g.longitude,g.altitude);var k=a.distanceTo(g);k>noderadius&&(c+=k,g.alt>a.alt&&(e+=g.alt-a.alt),f.push(g),a=g);d+=b.distanceTo(g);b=g}this.phototrack&&this.map.removeLayer(this.phototrack);this.phototrack=L.polyline(f,{color:"#3CB371"}).bindPopup("total <b>"+f.length+"</b> waypoints<br>route <b>"+
c.toFixed()+"</b> m<br>track <b>"+d.toFixed()+"</b> m<br>ascent <b>"+e.toFixed()+"</b> m").addTo(this.map)},addgpx:function(a){var b=this,c={};c.prop=a;c.trkpt=[];var d=this.gpxlist.length%gpxcolors.length;this.gpxlist.push(c);(function(){var e,f,h,g,k,l,n,m,q,r,t;return $jscomp.asyncExecutePromiseGeneratorProgram(function(p){switch(p.nextAddress){case 1:return ajaxcc.emit("ajax",1),p.setCatchFinallyBlocks(2,3),p.yield(fetch(fileurl(a)),5);case 5:return e=p.yieldResult,p.yield(e.text(),6);case 6:f=
p.yieldResult;h=/lat="(\d+\.\d+)" lon="(\d+\.\d+)"/g;g=f.matchAll(h);k=null;l=0;n=$jscomp.makeIterator(g);for(m=n.next();!m.done;m=n.next())q=m.value,r=L.latLng(Number(q[1]),Number(q[2])),k&&(l+=r.distanceTo(k)),k=r,c.trkpt.push(r);c.layer=L.polyline(c.trkpt,{color:gpxcolors[d]}).bindPopup("points <b>"+c.trkpt.length+"</b><br>route <b>"+l.toFixed()+"</b> m").addTo(b.map);case 3:p.enterFinallyBlock();ajaxcc.emit("ajax",-1);p.leaveFinallyBlock(0);break;case 2:t=p.enterCatchBlock(),ajaxfail(t),p.jumpTo(3)}})})()},
onmapboxhybrid:function(){this.changetiles("mapbox-hybrid")},onmapboxsatellite:function(){this.changetiles("mapbox-satellite")},onmapboxoutdoors:function(){this.changetiles("mapbox-outdoors")},onmapboxstreets:function(){this.changetiles("mapbox-streets")},ongooglehybrid:function(){this.changetiles("google-hybrid")},ongooglesatellite:function(){this.changetiles("google-satellite")},ongoogleterrain:function(){this.changetiles("google-terrain")},ongooglestreets:function(){this.changetiles("google-streets")},
onosm:function(){this.changetiles("osm")},onopentopo:function(){this.changetiles("opentopo")},onhikebike:function(){this.changetiles("hikebike")},onphototrack:function(){(this.showtrack=!this.showtrack)?this.makephototrack():(this.map.removeLayer(this.phototrack),this.phototrack=null)},onmarkermode:function(){switch(this.markermode){case "marker":this.markermode="thumb";break;case "thumb":this.markermode="marker"}var a=this.gpslist;this.new();this.addmarkers(a)},onfitbounds:function(){for(var a=this.markers.getBounds(),
b=$jscomp.makeIterator(this.gpxlist),c=b.next();!c.done;c=b.next())c=c.value,c.layer&&a.extend(c.layer.getBounds());this.map.flyToBounds(a,{padding:[20,20]})}},mounted:function(){this.tiles=this.maketiles("mapbox-hybrid");this.map=L.map(this.$refs.map,{center:[0,0],zoom:8,layers:[this.tiles]})}});var isMainAudio=function(a){return{".wav":!0,".flac":!0,".mp3":!0,".ogg":!0,".opus":!0,".acc":!0,".m4a":!0,".alac":!0}[a]},isMainVideo=function(a){return{".mp4":!0,".webm":!0}[a]},mp3filter=function(a){return isMainAudio(pathext(a.name))||isMainVideo(pathext(a.name))};
Vue.component("mp3-player-tag",{template:"#mp3-player-tpl",props:["list"],data:function(){return{visible:!1,selfile:{},volval:100,ratval:6,repeatmode:0,seeking:!1,media:null,isplay:!1,autoplay:!1,ready:!1,timecur:0,timebuf:0,timeend:0,ratevals:[.4,.5,1/1.75,1/1.5,.8,1/1.15,1,1.15,1.25,1.5,1.75,2,2.5],iid:makestrid(10)}},computed:{selfilepos:function(){for(var a in this.list)if(this.selfile.puid===this.list[a].puid)return Number(a)},getprev:function(){var a=this,b=function(b,d){for(--b;b>d;b--){var c=
a.list[b];if(mp3filter(c))return c}};return b(this.selfilepos,-1)||2===this.repeatmode&&b(this.list.length,this.selfilepos-1)},getnext:function(){var a=this,b=function(b,d){for(b+=1;b<d;b++){var c=a.list[b];if(mp3filter(c))return c}};return b(this.selfilepos,this.list.length)||2===this.repeatmode&&b(-1,this.selfilepos+1)},volumelabel:function(){return this.volval},ratelabel:function(){return this.ratevals[this.ratval].toFixed(2)},iconplay:function(){return this.isplay?"pause":"play_arrow"},hintplay:function(){return this.isplay?
"pause":"play"},iconrepeat:function(){return 1===this.repeatmode?"repeat_one":"repeat"},hintrepeat:function(){switch(this.repeatmode){case 0:return"no any repeat";case 1:return"repeat one";case 2:return"repeat playlist"}},fmttimecur:function(){return fmttime(this.timecur,this.timeend)},fmttimeend:function(){return fmttime(this.timeend,this.timeend)},fmttrackinfo:function(){return this.selfile.title?(this.selfile.artist||this.selfile.album||this.selfile.genre||"")+" - "+this.selfile.title:this.selfile.name},
stlbarcur:function(){return{width:(Infinity===this.timeend?95:!this.timeend||isNaN(this.timeend)?5:this.timecur/this.timeend*100)+"%"}},stlbarbuf:function(){return{width:(Infinity===this.timeend?0:!this.timeend||isNaN(this.timeend)?0:this.timebuf/this.timeend*100)+"%"}}},methods:{setup:function(a){var b=this;this.selfile.puid!==a.puid&&(this.close(),this.selfile=a,this.media=new Audio(mediaurl(a)),this.media.volume=this.volval/100,this.media.playbackRate=this.ratevals[this.ratval],this.media.loop=
1===this.repeatmode,this.media.autoplay=this.autoplay,this.ready=!1,this.media.addEventListener("loadedmetadata",function(){b.timecur=b.media.currentTime;b.timebuf=0;b.timeend=b.media.duration;b.updateprogress()}),this.media.addEventListener("canplay",function(){b.ready=!0;b.media.autoplay||(b.media.play(),b.media.pause())}),this.media.addEventListener("timeupdate",function(){return b.updateprogress()}),this.media.addEventListener("seeked",function(){return b.updateprogress()}),this.media.addEventListener("progress",
function(){return b.updateprogress()}),this.media.addEventListener("durationchange",function(){return b.updateprogress()}),this.media.addEventListener("play",function(){b.isplay=!0;b.autoplay=!0;b.$emit("playback",b.selfile)}),this.media.addEventListener("pause",function(){b.isplay=!1;b.autoplay=!1;b.$emit("playback",null)}),this.media.addEventListener("ended",function(){b.autoplay=!0;b.onnext()}),this.media.addEventListener("error",function(a){a.message?console.error("Error "+a.code+"; details: "+
a.message):console.error(a)}),this.media.addEventListener("volumechange",function(){b.volval=100*b.media.volume}),this.media.addEventListener("ratechange",function(){a:{var a=b.media.playbackRate;for(var d=1/3,e=b.ratevals[0],f=0;f<b.ratevals.length-1;f++){var h=b.ratevals[f+1];if(a>=(e+d)/2&&a<(e+h)/2){a=f;break a}d=e;e=h}a=b.ratevals.length-1}b.ratval=a}))},close:function(){return this.media&&!this.media.paused?(this.media.pause(),!0):!1},play:function(){this.media&&(this.media.paused?this.media.play():
this.media.pause())},updateprogress:function(){var a=this.media.currentTime;this.seeking||(this.timecur=a);if(0<this.media.buffered.length){var b=this.media.buffered.start(0),c=this.media.buffered.end(0);this.timebuf=b<=a&&c>a?c-a:0}else this.timebuf=0},onprev:function(){this.getprev&&this.$emit("select",this.getprev)},onplay:function(){this.play()},onnext:function(){this.getnext&&this.$emit("select",this.getnext)},onrepeat:function(){this.repeatmode=(this.repeatmode+1)%(this.list?3:2);this.media&&
(this.media.loop=1===this.repeatmode)},onseekerchange:function(a){this.media.currentTime=a.target.value;this.seeking=!1},onseekerinput:function(a){this.seeking=!0;this.timecur=Number(a.target.value)},onvolinp:function(a){this.volval=Number(a.target.value)},onvolval:function(a){this.media&&(this.media.volume=this.volval/100)},onratinp:function(a){this.ratval=Number(a.target.value)},onratval:function(a){this.media&&(this.media.playbackRate=this.ratevals[this.ratval])}}});var isTypeJPEG=function(a){return{".jpg":!0,".jpe":!0,".jpeg":!0,".jfif":!0}[a]},isMainImage=function(a){return{".tga":!0,".bmp":!0,".dib":!0,".rle":!0,".dds":!0,".tif":!0,".tiff":!0,".jpg":!0,".jpe":!0,".jpeg":!0,".jfif":!0,".gif":!0,".png":!0,".webp":!0,".psd":!0,".psb":!0}[a]},photofilter=function(a){return a.size&&isMainImage(pathext(a.name))};
Vue.component("thumbslider-tag",{template:"#thumbslider-tpl",props:["selfile","list"],computed:{slide:function(){for(var a=[],b=$jscomp.makeIterator(this.list),c=b.next();!c.done;c=b.next())c=c.value,photofilter(c)&&a.push(c);return a}},methods:{imgicon:function(a){return filetmbimg(a)},onprev:function(){this.$refs.slide.scrollBy({left:-120,behavior:"smooth"})},onnext:function(){this.$refs.slide.scrollBy({left:120,behavior:"smooth"})},onthumb:function(a){this.$emit("select",a)}}});
Vue.component("photoslider-tag",{template:"#photoslider-tpl",props:["list"],data:function(){return{selfile:null,imgloading:!1,repeatmode:0}},computed:{selfileurl:function(){return this.selfile&&mediaurl(this.selfile)},selfilepos:function(){for(var a in this.list)if(this.selfile.puid===this.list[a].puid)return Number(a)},getprev:function(){var a=this,b=function(b,d){for(--b;b>d;b--){var c=a.list[b];if(photofilter(c))return c}};return this.selfile&&(b(this.selfilepos,-1)||2===this.repeatmode&&b(this.list.length,
this.selfilepos))},getnext:function(){var a=this,b=function(b,d){for(b+=1;b<d;b++){var c=a.list[b];if(photofilter(c))return c}};return this.selfile&&(b(this.selfilepos,this.list.length)||2===this.repeatmode&&b(-1,this.selfilepos))},islist:function(){return this.list&&1<this.list.length}},methods:{load:function(a){this.selfile!==a&&(a?(this.selfile=a,this.imgloading=!0):(this.selfile=null,this.imgloading=!1))},select:function(a){this.load(a);this.$emit("select",a)},popup:function(a){this.load(a);$(this.$refs.modal).modal("show")},
close:function(){this.load(null);$(this.$refs.modal).modal("hide")},onimgload:function(a){this.imgloading=!1},onimgerror:function(a){this.imgloading=!1},onkeyup:function(a){switch(a.code){case "ArrowLeft":this.onprev();break;case "ArrowRight":case "Space":this.onnext();break;case "Home":this.list&&this.select(this.list[0]);break;case "End":this.list&&this.select(this.list[this.list.length-1])}},onselect:function(a){this.select(a)},onprev:function(){this.getprev&&this.select(this.getprev)},onnext:function(){this.getnext&&
this.select(this.getnext)},onclose:function(){this.close()}}});var iconmapping=imempty,thumbmode=!0,iconev=extend({},makeeventmodel()),FT={file:0,dir:1,drv:2,ctgr:3},FG={other:0,video:1,audio:2,image:3,books:4,texts:5,packs:6,dir:7},DS={yellow:3E3,red:1E4},extgrp={".avi":FG.video,".mpe":FG.video,".mpg":FG.video,".mp4":FG.video,".webm":FG.video,".wmv":FG.video,".wmx":FG.video,".flv":FG.video,".3gp":FG.video,".3g2":FG.video,".mkv":FG.video,".mov":FG.video,".ogv":FG.video,".ogx":FG.video,".aac":FG.audio,".m4a":FG.audio,".alac":FG.audio,".aif":FG.audio,".mpa":FG.audio,
".mp3":FG.audio,".wav":FG.audio,".wma":FG.audio,".weba":FG.audio,".oga":FG.audio,".ogg":FG.audio,".opus":FG.audio,".flac":FG.audio,".mka":FG.audio,".ra":FG.audio,".mid":FG.audio,".midi":FG.audio,".cda":FG.audio,".tga":FG.image,".bmp":FG.image,".dib":FG.image,".rle":FG.image,".dds":FG.image,".tif":FG.image,".tiff":FG.image,".jpg":FG.image,".jpe":FG.image,".jpeg":FG.image,".jfif":FG.image,".gif":FG.image,".png":FG.image,".webp":FG.image,".psd":FG.image,".psb":FG.image,".jp2":FG.image,".jpg2":FG.image,
".jpx":FG.image,".jpm":FG.image,".jxr":FG.image,".pdf":FG.books,".djvu":FG.books,".djv":FG.books,".html":FG.books,".htm":FG.books,".shtml":FG.books,".shtm":FG.books,".xhtml":FG.books,".phtml":FG.books,".hta":FG.books,".mht":FG.books,".odt":FG.books,".ods":FG.books,".odp":FG.books,".rtf":FG.books,".abw":FG.books,".doc":FG.books,".docx":FG.books,".xls":FG.books,".xlsx":FG.books,".ppt":FG.books,".pptx":FG.books,".vsd":FG.books,".txt":FG.texts,".md":FG.texts,".css":FG.texts,".js":FG.texts,".jsm":FG.texts,
".vb":FG.texts,".vbs":FG.texts,".bat":FG.texts,".cmd":FG.texts,".sh":FG.texts,".mak":FG.texts,".iss":FG.texts,".nsi":FG.texts,".nsh":FG.texts,".bsh":FG.texts,".sql":FG.texts,".as":FG.texts,".mx":FG.texts,".ps":FG.texts,".php":FG.texts,".phpt":FG.texts,".lua":FG.texts,".tcl":FG.texts,".rc":FG.texts,".cmake":FG.texts,".java":FG.texts,".jsp":FG.texts,".asp":FG.texts,".asm":FG.texts,".c":FG.texts,".h":FG.texts,".hpp":FG.texts,".hxx":FG.texts,".cpp":FG.texts,".cxx":FG.texts,".cc":FG.texts,".cs":FG.texts,
".go":FG.texts,".r":FG.texts,".d":FG.texts,".pas":FG.texts,".inc":FG.texts,".py":FG.texts,".pyw":FG.texts,".pl":FG.texts,".pm":FG.texts,".plx":FG.texts,".rb":FG.texts,".rbw":FG.texts,".cfg":FG.texts,".ini":FG.texts,".inf":FG.texts,".reg":FG.texts,".url":FG.texts,".xml":FG.texts,".xsml":FG.texts,".xsl":FG.texts,".xsd":FG.texts,".kml":FG.texts,".gpx":FG.texts,".wsdl":FG.texts,".xlf":FG.texts,".xliff":FG.texts,".yml":FG.texts,".yaml":FG.texts,".json":FG.texts,".log":FG.texts,".cab":FG.packs,".zip":FG.packs,
".7z":FG.packs,".rar":FG.packs,".rev":FG.packs,".jar":FG.packs,".tar":FG.packs,".tgz":FG.packs,".gz":FG.packs,".bz2":FG.packs,".iso":FG.packs,".isz":FG.packs,".udf":FG.packs,".nrg":FG.packs,".mdf":FG.packs,".mdx":FG.packs,".img":FG.packs,".ima":FG.packs,".imz":FG.packs,".ccd":FG.packs,".vc4":FG.packs,".dmg":FG.packs,".daa":FG.packs,".uif":FG.packs,".vhd":FG.packs,".vhdx":FG.packs,".vmdk":FG.packs,".wpk":FG.packs},extfmt={bitmap:{".tga":1,".bmp":1,".dib":1,".rle":1,".dds":1},tiff:{".tiff":1,".tif":1},
jpeg:{".jpg":1,".jpe":1,".jpeg":1,".jfif":1},jpeg2000:{".jp2":1,".jpg2":1,".jpx":1,".jpm":1},psd:{".psd":1,".psb":1},component:{".dll":1,".ocx":1},exec:{".exe":1,".dll":1,".ocx":1,".bat":1,".cmd":1,".sh":1},text:{".txt":1,".md":1},html:{".html":1,".htm":1,".shtml":1,".shtm":1,".xhtml":1,".phtml":1,".hta":1,".mht":1},config:{".cfg":1,".ini":1,".inf":1,".reg":1},datafmt:{".xml":1,".xsml":1,".xsl":1,".xsd":1,".kml":1,".gpx":1,".wsdl":1,".xlf":1,".xliff":1,".yml":1,".yaml":1,".json":1},script:{".css":1,
".js":1,".jsm":1,".vb":1,".vbs":1,".bat":1,".cmd":1,".sh":1,".mak":1,".iss":1,".nsi":1,".nsh":1,".bsh":1,".sql":1,".as":1,".mx":1,".ps":1,".php":1,".phpt":1,".lua":1,".tcl":1,".rc":1,".cmake":1},code:{".css":1,".js":1,".jsm":1,".vb":1,".vbs":1,".bat":1,".cmd":1,".sh":1,".mak":1,".iss":1,".nsi":1,".nsh":1,".bsh":1,".sql":1,".as":1,".mx":1,".ps":1,".php":1,".phpt":1,".lua":1,".tcl":1,".rc":1,".cmake":1,".java":1,".jsp":1,".asp":1,".asm":1,".c":1,".h":1,".hpp":1,".hxx":1,".cpp":1,".cxx":1,".cc":1,".cs":1,
".go":1,".r":1,".d":1,".pas":1,".inc":1,".py":1,".pyw":1,".pl":1,".pm":1,".plx":1,".rb":1,".rbw":1},msoffice:{".doc":1,".docx":1,".xls":1,".xlsx":1,".ppt":1,".pptx":1,".vsd":1},openoffice:{".odt":1,".ods":1,".odp":1,".rtf":1,".abw":1},office:{".odt":1,".ods":1,".odp":1,".rtf":1,".abw":1,".doc":1,".docx":1,".xls":1,".xlsx":1,".ppt":1,".pptx":1,".vsd":1},archive:{".cab":1,".zip":1,".7z":1,".rar":1,".rev":1,".jar":1,".tar":1,".tgz":1,".gz":1,".bz2":1},"package":{".wpk":1},disk:{".iso":1,".isz":1,".udf":1,
".nrg":1,".mdf":1,".mdx":1,".img":1,".ima":1,".imz":1,".ccd":1,".vc4":1,".dmg":1,".daa":1,".uif":1,".vhd":1,".vhdx":1,".vmdk":1},image:{".tga":1,".bmp":1,".dib":1,".rle":1,".dds":1,".tif":1,".tiff":1,".jpg":1,".jpe":1,".jpeg":1,".jfif":1,".gif":1,".png":1,".webp":1,".psd":1,".psb":1,".jp2":1,".jpg2":1,".jpx":1,".jpm":1,".jxr":1},music:{".aac":1,".m4a":1,".alac":1,".aif":1,".mpa":1,".mp3":1,".wav":1,".wma":1,".weba":1,".oga":1,".ogg":1,".opus":1,".flac":1,".mka":1,".ra":1,".mid":1,".midi":1,".cda":1},
video:{".avi":1,".mpe":1,".mpg":1,".mp4":1,".webm":1,".wmv":1,".wmx":1,".flv":1,".3gp":1,".3g2":1,".mkv":1,".mov":1,".ogv":1,".ogx":1},books:{".pdf":1,".djvu":1,".djv":1,".html":1,".htm":1,".shtml":1,".shtm":1,".xhtml":1,".phtml":1,".hta":1,".mht":1},texts:{".txt":1,".md":1,".css":1,".js":1,".jsm":1,".vb":1,".vbs":1,".bat":1,".cmd":1,".sh":1,".mak":1,".iss":1,".nsi":1,".nsh":1,".bsh":1,".sql":1,".as":1,".mx":1,".ps":1,".php":1,".phpt":1,".lua":1,".tcl":1,".rc":1,".cmake":1,".java":1,".jsp":1,".asp":1,
".asm":1,".c":1,".h":1,".hpp":1,".hxx":1,".cpp":1,".cxx":1,".cc":1,".cs":1,".go":1,".r":1,".d":1,".pas":1,".inc":1,".py":1,".pyw":1,".pl":1,".pm":1,".plx":1,".rb":1,".rbw":1,".cfg":1,".ini":1,".inf":1,".reg":1,".xml":1,".xsml":1,".xsl":1,".xsd":1,".kml":1,".gpx":1,".wsdl":1,".xlf":1,".xliff":1,".yml":1,".yaml":1,".json":1},packs:{".cab":1,".zip":1,".7z":1,".rar":1,".rev":1,".jar":1,".tar":1,".tgz":1,".gz":1,".bz2":1,".wpk":1,".iso":1,".isz":1,".udf":1,".nrg":1,".mdf":1,".mdx":1,".img":1,".ima":1,
".imz":1,".ccd":1,".vc4":1,".dmg":1,".daa":1,".uif":1,".vhd":1,".vhdx":1,".vmdk":1}},extfmtorder="bitmap tiff jpeg jpeg2000 psd component exec text html config datafmt script code msoffice openoffice office archive package disk image music video books texts packs".split(" "),getFileGroup=function(a){return a.type?FG.dir:extgrp[pathext(a.name)]},geticonpath=function(a,b,c){var d=c?b.shared:b.private;b=c?b.private:b.shared;switch(a.type){case FT.ctgr:return{org:d.cid[a.cid]||d.cid.cid,alt:b.cid[a.cid]||
b.cid.cid};case FT.drv:return 0>a.latency?{org:d.drive.offline,alt:b.drive.offline}:a.latency<DS.yellow?{org:d.drive.green,alt:b.drive.green}:a.latency<DS.red?{org:d.drive.yellow,alt:b.drive.yellow}:{org:d.drive.red,alt:b.drive.red};case FT.dir:if(a.scan){c=0;a=a.fgrp;for(var e=$jscomp.makeIterator(a),f=e.next();!f.done;f=e.next())c+=f.value;return c?.5<a[FG.other]/c?{org:d.folder.other,alt:b.folder.other}:.5<a[FG.video]/c?{org:d.folder.video,alt:b.folder.video}:.5<a[FG.audio]/c?{org:d.folder.audio,
alt:b.folder.audio}:.5<a[FG.image]/c?{org:d.folder.image,alt:b.folder.image}:.5<a[FG.books]/c?{org:d.folder.books,alt:b.folder.books}:.5<a[FG.texts]/c?{org:d.folder.texts,alt:b.folder.texts}:.5<a[FG.packs]/c?{org:d.folder.packs,alt:b.folder.packs}:.5<a[FG.dir]/c?{org:d.folder.dir,alt:b.folder.dir}:.5<(a[FG.audio]+a[FG.video]+a[FG.image])/c?{org:d.folder.media,alt:b.folder.media}:{org:d.folder.open,alt:b.folder.open}:{org:d.folder.open,alt:b.folder.open}}return{org:d.folder.close,alt:b.folder.close};
default:var h=pathext(a.name);c=function(a){for(var b=$jscomp.makeIterator(extfmtorder),c=b.next();!c.done;c=b.next()){c=c.value;var d=a[c];if(d&&extfmt[c][h])return d}};return{org:d.ext[h]||c(d.grp)||d.blank,alt:b.ext[h]||c(b.grp)||b.blank}}},encode=function(a){return encodeURI(a).replace("#","%23").replace("&","%26").replace("+","%2B")},fileurl=function(a){return"/id"+app.aid+"/file/"+a.puid},pathurl=function(a){return(devmode?"/dev":"")+"/id"+app.aid+"/path/"+a.puid},mediaurl=function(a){return"/id"+
app.aid+"/media/"+a.puid},showmsgbox=function(a,b,c){var d=$("#msgbox");d.find(".modal-title").text(a);d.find(".message").text(b);d.find(".details").text(c||"");d.modal("show")},ajaxfail=function(a){console.error(a.name,a);if(a instanceof SyntaxError)showmsgbox("Syntax error","Application function failed with syntax error in javascript.");else{if(a instanceof HttpError){var b=function(b,d){var c=$("#msgbox");c.find(".modal-title").text(b);c.find(".message").text(d);c.find(".errcode").text(a.code);
c.find(".errmsg").text(a.what);c.modal("show")};switch(a.status){case 400:b("Application error","Action is rejected by server. This error is caused by wrong parameters in application ajax-call to server.");return;case 401:b("401 Unauthorized","Action can be done only after authorization.");return;case 403:b("403 resource forbidden","Resource referenced by application ajax-call is forbidden. It can be accessible after authorization, or for other authorization.");return;case 404:b("404 resource not found",
"Resource referenced by application ajax-call is not found on server.");return;case 500:b("Internal server error","Action could not be completed due to an internal error on the server side.");return;default:b("Error "+a.status,"Action is rejected with HTTP status "+a.status+".")}}showmsgbox("Server unavailable","Server is currently not available, action can not be done now.")}};
Vue.component("auth-tag",{template:"#auth-tpl",data:function(){return{isauth:!1,login:"",password:"",namestate:0,passstate:0}},computed:{clsname:function(){return this.namestate?-1===this.namestate?"is-invalid":"is-valid":""},clspass:function(){return this.passstate?-1===this.passstate?"is-invalid":"is-valid":""}},methods:{onauthchange:function(){this.passstate=this.namestate=0},onlogin:function(){var a=this;(function(){var b,c,d,e,f,h;return $jscomp.asyncExecutePromiseGeneratorProgram(function(g){switch(g.nextAddress){case 1:return ajaxcc.emit("ajax",
1),g.setCatchFinallyBlocks(2,3),g.yield(fetchjson("POST","/api/auth/pubkey"),5);case 5:return b=g.yieldResult,g.yield(b.json(),6);case 6:c=g.yieldResult;traceajax(b,c);if(!b.ok)throw new HttpError(b.status,c);d=sha256.hmac.create(c);d.update(a.password);return g.yield(fetchjson("POST","/api/auth/signin",{name:a.login,pubk:c,hash:d.digest()}),7);case 7:return e=g.yieldResult,g.yield(e.json(),8);case 8:if(f=g.yieldResult,traceajax(e,f),200===e.status)auth.signin(f,a.login),a.namestate=1,a.passstate=
1,a.$emit("refresh");else if(403===e.status)switch(auth.signout(),f.code){case 13:a.namestate=-1;a.passstate=0;break;case 15:a.namestate=1;a.passstate=-1;break;default:a.namestate=-1,a.passstate=-1}else throw new HttpError(e.status,f);case 3:g.enterFinallyBlock();ajaxcc.emit("ajax",-1);g.leaveFinallyBlock(0);break;case 2:h=g.enterCatchBlock(),ajaxfail(h),g.jumpTo(3)}})})()},onlogout:function(){auth.signout();this.passstate=this.namestate=0;this.$emit("refresh")}},mounted:function(){var a=this;this._authclosure=
function(b){if(a.isauth=b)a.login=auth.login};auth.on("auth",this._authclosure)},beforeDestroy:function(){auth.off("auth",this._authclosure)}});
var app=new Vue({el:"#app",template:"#app-tpl",data:{skinid:"",iconid:"",resmodel:{skinlist:[],iconlist:[]},showauth:!1,isauth:!1,authid:0,aid:0,ishome:!1,loadcount:0,shared:[],histpos:0,histlist:[],pathlist:[],filelist:[],curscan:new Date,curcid:"",curpuid:"",curpath:"",shrname:""},computed:{isadmin:function(){return this.isauth||"localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname},curshorturl:function(){return(devmode?"/dev":"")+"/id"+this.aid+"/path/"+this.curpuid},curlongurl:function(){return(devmode?
"/dev":"")+"/id"+this.aid+"/path/"+this.curpath},curbasename:function(){if(this.curcid)switch(this.curcid){case "drives":return"Drives list";case "shares":return"Shared resources";case "media":return"Multimedia files";case "video":return"Movie and video files";case "audio":return"Music and audio files";case "image":return"Photos and images";case "books":return"Books";case "texts":return"Text files";default:return this.curcid}else{if(this.curpath){var a=this.curpath.split("/"),b=a.pop()||a.pop();return!a.length&&
this.shrname||b}return"home page"}},curpathway:function(){if(!this.curpath)return[];var a=this.curpath.split("/");a.pop()||a.pop();var b=[],c="";a=$jscomp.makeIterator(a);for(var d=a.next();!d.done;d=a.next())d=d.value,c=c?c+("/"+d):d,b.push({name:d,path:c});b.length&&(b[0].name=this.shrname||b[0].name);return b},uncached:function(){for(var a=[],b=$jscomp.makeIterator(this.filelist),c=b.next();!c.done;c=b.next())c=c.value,c.ntmb||a.push(c);return a},sumsize:function(){for(var a=0,b=$jscomp.makeIterator(this.filelist),
c=b.next();!c.done;c=b.next())a+=c.value.size||0;return fmtitemsize(a)},dishome:function(){return"home"===this.curcid||!(this.isadmin||this.ishome)},disback:function(){return 2>this.histpos},disforward:function(){return this.histpos>=this.histlist.length},disparent:function(){return!this.curpathway.length},textauthcaret:function(){return this.showauth?"arrow_right":"arrow_left"},hintback:function(){if(1<this.histpos){var a=this.histlist[this.histpos-2];return a.cid?"back to "+a.cid:a.path?"back to /id"+
a.aid+"/path/"+a.path:"back to home"}return"go back"},hintforward:function(){if(this.histpos<this.histlist.length){var a=this.histlist[this.histpos];return a.cid?"forward to "+a.cid:a.path?"forward to /id"+a.aid+"/path/"+a.path:"forward to home"}return"go forward"},hintparent:function(){return this.curpathway.length?this.curpathway.map(function(a){return a.name}).join("/"):"to root folder"},hintauthcaret:function(){return this.showauth?"hide login fields":"show login fields"}},methods:{fetchicons:function(a){var b=
this,c;return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){if(1==d.nextAddress)return d.yield(fetch(a),2);if(3!=d.nextAddress){c=d.yieldResult;if(!c.ok)throw new HttpError(c.status,{what:"can not load icons mapping file",when:Date.now(),code:0});return d.yield(c.json(),3)}iconmapping=d.yieldResult;iconmapping.iconwebp=b.resmodel.iconwebp;iconmapping.iconpng=b.resmodel.iconpng;iconev.emit("plug");d.jumpToEnd()})},fetchishome:function(){var a=this,b;return $jscomp.asyncExecutePromiseGeneratorProgram(function(c){if(1==
c.nextAddress)return c.yield(fetchajaxauth("POST","/api/card/ishome",{aid:a.aid}),2);b=c.yieldResult;traceajax(b);if(!b.ok)throw new HttpError(b.status,b.data);a.ishome=b.data;c.jumpToEnd()})},fetchcategory:function(a){var b=this,c,d,e,f,h,g,k;return $jscomp.asyncExecutePromiseGeneratorProgram(function(l){if(1==l.nextAddress)return l.yield(fetchajaxauth("POST","/api/card/ctgr",{aid:a.aid,puid:a.puid,cid:a.cid}),2);c=l.yieldResult;traceajax(c);if(!c.ok)throw new HttpError(c.status,c.data);b.pathlist=
[];b.filelist=[];d=$jscomp.makeIterator(c.data||[]);for(e=d.next();!e.done;e=d.next())if(f=e.value,f.type!==FT.ctgr||"home"===a.cid)f.type?b.pathlist.push(f):b.filelist.push(f);"shares"===a.cid&&b.isadmin&&(b.shared=c.data||[]);b.curscan=new Date(Date.now());b.curcid=a.cid;b.curpuid=a.puid;b.curpath="";b.shrname="";b.$refs.mapcard.new();if(b.filelist.length){h=[];g=$jscomp.makeIterator(b.filelist);for(e=g.next();!e.done;e=g.next())k=e.value,k.latitude&&k.longitude&&1===k.ntmb&&h.push(k),".gpx"===
pathext(k.name)&&b.$refs.mapcard.addgpx(k);b.$refs.mapcard.addmarkers(h)}l.jumpToEnd()})},fetchfolder:function(a){var b=this,c,d,e,f,h,g,k;return $jscomp.asyncExecutePromiseGeneratorProgram(function(l){if(1==l.nextAddress)return l.yield(fetchajaxauth("POST","/api/card/folder",{aid:a.aid,puid:a.puid,path:a.path}),2);c=l.yieldResult;traceajax(c);if(!c.ok)throw new HttpError(c.status,c.data);b.pathlist=[];b.filelist=[];d=$jscomp.makeIterator(c.data.list||[]);for(e=d.next();!e.done;e=d.next())(f=e.value)&&
f.type!==FT.ctgr&&(f.type?b.pathlist.push(f):b.filelist.push(f));a.puid=c.data.puid;a.path=c.data.path;b.curscan=new Date(Date.now());b.curcid="";b.curpuid=a.puid;b.curpath=a.path;b.shrname=c.data.shrname;b.$refs.mapcard.new();if(b.filelist.length){h=[];g=$jscomp.makeIterator(b.filelist);for(e=g.next();!e.done;e=g.next())k=e.value,k.latitude&&k.longitude&&1===k.ntmb&&h.push(k),".gpx"===pathext(k.name)&&b.$refs.mapcard.addgpx(k);b.$refs.mapcard.addmarkers(h)}l.jumpToEnd()})},fetchopenroute:function(a){var b=
this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(c){switch(c.nextAddress){case 1:return a.cid||a.puid||a.path||(a.cid="home"),a.cid?c.yield(b.fetchcategory(a),6):c.yield(b.fetchfolder(a),4);case 4:return c.yield(b.fetchscanthumbs(),3);case 6:if("shares"!==a.cid){c.jumpTo(3);break}return c.yield(b.fetchscanthumbs(),3);case 3:b.seturl(),c.jumpToEnd()}})},fetchscanthumbs:function(){var a=this,b,c;return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){if(1==d.nextAddress)return a.uncached.length?
d.yield(fetchjsonauth("POST","/api/tmb/scn",{aid:a.aid,puids:a.uncached.map(function(a){return a.puid})}),2):d.return();b=d.yieldResult;traceajax(b);if(!b.ok)throw new HttpError(b.status,b.data);c=a.puid;(function(){var b,d,h,g,k,l,n,m,q;return $jscomp.asyncExecutePromiseGeneratorProgram(function(e){switch(e.nextAddress){case 1:e.setCatchFinallyBlocks(2);case 4:if(c!==a.puid||!a.uncached.length){e.leaveTryBlock(0);break}return e.yield(fetchajaxauth("POST","/api/tmb/chk",{tmbs:a.uncached.map(function(a){return{puid:a.puid}})}),
6);case 6:b=e.yieldResult;traceajax(b);if(!b.ok)throw new HttpError(b.status,b.data);d=[];h=$jscomp.makeIterator(b.data.tmbs);for(g=h.next();!g.done;g=h.next())if(k=g.value,k.ntmb)for(l=$jscomp.makeIterator(a.filelist),n=l.next();!n.done;n=l.next())if(m=n.value,m.puid===k.puid){Vue.set(m,"ntmb",k.ntmb);m.latitude&&m.longitude&&1===m.ntmb&&d.push(m);break}a.$refs.mapcard.addmarkers(d);return e.yield(new Promise(function(a){return setTimeout(a,1500)}),4);case 2:q=e.enterCatchBlock(),ajaxfail(q),e.jumpToEnd()}})})();
d.jumpToEnd()})},fetchshared:function(){var a=this,b;return $jscomp.asyncExecutePromiseGeneratorProgram(function(c){if(1==c.nextAddress)return c.yield(fetchajaxauth("POST","/api/share/lst",{aid:a.aid}),2);b=c.yieldResult;traceajax(b);if(!b.ok)throw new HttpError(b.status,b.data);a.shared=b.data||[];c.jumpToEnd()})},fetchshareadd:function(a){var b=this,c;return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){if(1==d.nextAddress)return d.yield(fetchajaxauth("POST","/api/share/add",{aid:b.aid,
puid:a.puid}),2);c=d.yieldResult;traceajax(c);if(!c.ok)throw new HttpError(c.status,c.data);b.shared.push(a);d.jumpToEnd()})},fetchsharedel:function(a){var b=this,c,d;return $jscomp.asyncExecutePromiseGeneratorProgram(function(e){if(1==e.nextAddress)return e.yield(fetchajaxauth("DELETE","/api/share/del",{aid:b.aid,puid:a.puid}),2);c=e.yieldResult;traceajax(c);if(!c.ok)throw new HttpError(c.status,c.data);if(c.data)for(d in b.shared)if(b.shared[d].puid===a.puid){b.shared.splice(d,1);break}e.jumpToEnd()})},
isshared:function(a){for(var b=$jscomp.makeIterator(this.shared),c=b.next();!c.done;c=b.next())if(c.value.puid===a.puid)return!0;return!1},setskin:function(a){for(var b=$jscomp.makeIterator(this.resmodel.skinlist),c=b.next();!c.done;c=b.next())c=c.value,c.id===a&&($("#skinmodel").attr("href",c.link),sessionStorage.setItem("skinid",a),this.skinid=a)},seticon:function(a){var b=this;(function(){var c,d,e,f;return $jscomp.asyncExecutePromiseGeneratorProgram(function(h){switch(h.nextAddress){case 1:ajaxcc.emit("ajax",
1),h.setCatchFinallyBlocks(2,3),c=$jscomp.makeIterator(b.resmodel.iconlist),d=c.next();case 5:if(d.done){h.jumpTo(3);break}e=d.value;if(e.id!==a){h.jumpTo(6);break}return h.yield(b.fetchicons(e.link),9);case 9:sessionStorage.setItem("iconid",a),b.iconid=a;case 6:d=c.next();h.jumpTo(5);break;case 3:h.enterFinallyBlock();ajaxcc.emit("ajax",-1);h.leaveFinallyBlock(0);break;case 2:f=h.enterCatchBlock(),ajaxfail(f),h.jumpTo(3)}})})()},seturl:function(){window.history.replaceState(null,this.curpath,this.curcid?
(devmode?"/dev":"")+"/id"+this.aid+"/ctgr/"+this.curcid+"/":this.curpath?this.curlongurl:(devmode?"/dev":"")+"/id"+this.aid+"/home/")},pushhist:function(a){this.histlist.splice(this.histpos);this.histlist.push(a);this.histpos=this.histlist.length},onhome:function(){var a=this;(function(){var b,c;return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){switch(d.nextAddress){case 1:return ajaxcc.emit("ajax",1),d.setCatchFinallyBlocks(2,3),b={cid:"home",aid:a.aid},d.yield(a.fetchopenroute(b),5);
case 5:a.pushhist(b);case 3:d.enterFinallyBlock();ajaxcc.emit("ajax",-1);d.leaveFinallyBlock(0);break;case 2:c=d.enterCatchBlock(),ajaxfail(c),d.jumpTo(3)}})})()},onback:function(){var a=this;(function(){var b,c;return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){if(1==d.nextAddress)return ajaxcc.emit("ajax",1),d.setCatchFinallyBlocks(2,3),a.histpos--,b=a.histlist[a.histpos-1],d.yield(a.fetchopenroute(b),3);if(2!=d.nextAddress)return d.enterFinallyBlock(),ajaxcc.emit("ajax",-1),d.leaveFinallyBlock(0);
c=d.enterCatchBlock();ajaxfail(c);return d.jumpTo(3)})})()},onforward:function(){var a=this;(function(){var b,c;return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){if(1==d.nextAddress)return ajaxcc.emit("ajax",1),d.setCatchFinallyBlocks(2,3),a.histpos++,b=a.histlist[a.histpos-1],d.yield(a.fetchopenroute(b),3);if(2!=d.nextAddress)return d.enterFinallyBlock(),ajaxcc.emit("ajax",-1),d.leaveFinallyBlock(0);c=d.enterCatchBlock();ajaxfail(c);return d.jumpTo(3)})})()},onparent:function(){var a=
this;(function(){var b,c,d;return $jscomp.asyncExecutePromiseGeneratorProgram(function(e){switch(e.nextAddress){case 1:return ajaxcc.emit("ajax",1),e.setCatchFinallyBlocks(2,3),b=a.curpathway.length?a.curpathway[a.curpathway.length-1].path:"",c={aid:a.aid,path:b},e.yield(a.fetchopenroute(c),5);case 5:a.pushhist(c);case 3:e.enterFinallyBlock();ajaxcc.emit("ajax",-1);e.leaveFinallyBlock(0);break;case 2:d=e.enterCatchBlock(),ajaxfail(d),e.jumpTo(3)}})})()},onrefresh:function(){var a=this;(function(){var b;
return $jscomp.asyncExecutePromiseGeneratorProgram(function(c){switch(c.nextAddress){case 1:return ajaxcc.emit("ajax",1),c.setCatchFinallyBlocks(2,3),c.yield(a.fetchopenroute({cid:a.curcid,aid:a.aid,puid:a.curpuid,path:a.curpath}),5);case 5:if(!a.isadmin||"shares"===a.curcid){c.jumpTo(6);break}return c.yield(a.fetchshared(),6);case 6:if(a.isadmin||"home"===a.curcid){c.jumpTo(3);break}return c.yield(a.fetchishome(),3);case 3:c.enterFinallyBlock();ajaxcc.emit("ajax",-1);c.leaveFinallyBlock(0);break;
case 2:b=c.enterCatchBlock(),ajaxfail(b),c.jumpTo(3)}})})()},onshare:function(a){var b=this;(function(){var c;return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){if(1==d.nextAddress)return ajaxcc.emit("ajax",1),d.setCatchFinallyBlocks(2,3),b.isshared(a)?d.yield(b.fetchsharedel(a),3):d.yield(b.fetchshareadd(a),3);if(2!=d.nextAddress)return d.enterFinallyBlock(),ajaxcc.emit("ajax",-1),d.leaveFinallyBlock(0);c=d.enterCatchBlock();ajaxfail(c);return d.jumpTo(3)})})()},onpathopen:function(a){var b=
this;(!a.latency||0<a.latency)&&function(){var c,d;return $jscomp.asyncExecutePromiseGeneratorProgram(function(e){switch(e.nextAddress){case 1:return ajaxcc.emit("ajax",1),e.setCatchFinallyBlocks(2,3),c={aid:b.aid},a.cid&&(c.cid=a.cid),a.puid&&(c.puid=a.puid),a.path&&(c.path=a.path),e.yield(b.fetchopenroute(c),5);case 5:b.pushhist(c);case 3:e.enterFinallyBlock();ajaxcc.emit("ajax",-1);e.leaveFinallyBlock(0);break;case 2:d=e.enterCatchBlock(),ajaxfail(d),e.jumpTo(3)}})}()},onauthcaret:function(){this.showauth=
!this.showauth}},mounted:function(){var a=this;auth.on("auth",function(b){(a.isauth=b)&&(b=auth.claims())&&"aid"in b&&(a.authid=b.aid,a.aid=b.aid)});ajaxcc.on("ajax",function(b){return a.loadcount+=b});auth.signload();this.login=auth.login;devmode&&this.isauth&&(console.log("token:",auth.token),console.log("login:",auth.login));var b=decodeURI(window.location.pathname).split("/");b.shift();0<b[b.length-1].length&&b.push("");"dev"===b[0]&&b.shift();"id"===b[0].substr(0,2)?(this.aid=Number(b[0].substr(2)),
b.shift()):this.aid=1;var c={aid:this.aid},d=b[0];b.shift();"ctgr"===d?(c.cid=b[0],b.shift()):"path"===d?c.path=b.join("/"):"main"===d&&(c.cid="home");c.cid||c.path||(c.cid="home");(function(){var b;return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){switch(d.nextAddress){case 1:return ajaxcc.emit("ajax",1),d.setCatchFinallyBlocks(2,3),d.yield(a.fetchopenroute(c),5);case 5:if(!a.isadmin||"share"===c.cid){d.jumpTo(6);break}return d.yield(a.fetchshared(),6);case 6:if(a.isadmin||"home"===
c.cid){d.jumpTo(8);break}return d.yield(a.fetchishome(),8);case 8:a.pushhist(c);case 3:d.enterFinallyBlock();ajaxcc.emit("ajax",-1);d.leaveFinallyBlock(0);break;case 2:b=d.enterCatchBlock(),ajaxfail(b),d.jumpTo(3)}})})();(function(){var b,c,d,g,k,l,n,m,q,r;return $jscomp.asyncExecutePromiseGeneratorProgram(function(e){switch(e.nextAddress){case 1:return ajaxcc.emit("ajax",1),e.setCatchFinallyBlocks(2,3),e.yield(fetch("/data/assets/resmodel.json"),5);case 5:b=e.yieldResult;if(!b.ok)throw new HttpError(b.status,
{what:"can not load resources model file",when:Date.now(),code:0});c=a;return e.yield(b.json(),6);case 6:c.resmodel=e.yieldResult;d=sessionStorage.getItem("skinid")||a.resmodel.defskinid;g=$jscomp.makeIterator(a.resmodel.skinlist);for(k=g.next();!k.done;k=g.next())l=k.value,l.id===d&&($("#skinmodel").attr("href",l.link),a.skinid=d);n=sessionStorage.getItem("iconid")||a.resmodel.deficonid;m=$jscomp.makeIterator(a.resmodel.iconlist);k=m.next();case 7:if(k.done){e.jumpTo(3);break}q=k.value;if(q.id!==
n){e.jumpTo(8);break}return e.yield(a.fetchicons(q.link),11);case 11:a.iconid=n;case 8:k=m.next();e.jumpTo(7);break;case 3:e.enterFinallyBlock();ajaxcc.emit("ajax",-1);e.leaveFinallyBlock(0);break;case 2:r=e.enterCatchBlock(),ajaxfail(r),e.jumpTo(3)}})})()}});$(document).ready(function(){$(".preloader-lock").hide("fast");$("#app").show("fast")});
