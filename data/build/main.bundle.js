var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.makeIterator=function(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};$jscomp.arrayFromIterator=function(a){for(var b,c=[];!(b=a.next()).done;)c.push(b.value);return c};
$jscomp.arrayFromIterable=function(a){return a instanceof Array?a:$jscomp.arrayFromIterator($jscomp.makeIterator(a))};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.objectCreate=$jscomp.ASSUME_ES5||"function"==typeof Object.create?Object.create:function(a){var b=function(){};b.prototype=a;return new b};$jscomp.underscoreProtoCanBeSet=function(){var a={a:!0},b={};try{return b.__proto__=a,b.a}catch(c){}return!1};
$jscomp.setPrototypeOf="function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null;
$jscomp.inherits=function(a,b){a.prototype=$jscomp.objectCreate(b.prototype);a.prototype.constructor=a;if($jscomp.setPrototypeOf){var c=$jscomp.setPrototypeOf;c(a,b)}else for(c in b)if("prototype"!=c)if(Object.defineProperties){var d=Object.getOwnPropertyDescriptor(b,c);d&&Object.defineProperty(a,c,d)}else a[c]=b[c];a.superClass_=b.prototype};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(a){function b(){this.batch_=null}function c(a){return a instanceof e?a:new e(function(b,c){b(a)})}if(a&&!$jscomp.FORCE_POLYFILL_PROMISE)return a;b.prototype.asyncExecute=function(a){if(null==this.batch_){this.batch_=[];var b=this;this.asyncExecuteFunction(function(){b.executeBatch_()})}this.batch_.push(a)};var d=$jscomp.global.setTimeout;b.prototype.asyncExecuteFunction=function(a){d(a,0)};b.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var a=
this.batch_;this.batch_=[];for(var b=0;b<a.length;++b){var c=a[b];a[b]=null;try{c()}catch(l){this.asyncThrow_(l)}}}this.batch_=null};b.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a;})};var e=function(a){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var b=this.createResolveAndReject_();try{a(b.resolve,b.reject)}catch(h){b.reject(h)}};e.prototype.createResolveAndReject_=function(){function a(a){return function(d){c||(c=!0,a.call(b,d))}}var b=this,c=!1;
return{resolve:a(this.resolveTo_),reject:a(this.reject_)}};e.prototype.resolveTo_=function(a){if(a===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(a instanceof e)this.settleSameAsPromise_(a);else{a:switch(typeof a){case "object":var b=null!=a;break a;case "function":b=!0;break a;default:b=!1}b?this.resolveToNonPromiseObj_(a):this.fulfill_(a)}};e.prototype.resolveToNonPromiseObj_=function(a){var b=void 0;try{b=a.then}catch(h){this.reject_(h);return}"function"==typeof b?
this.settleSameAsThenable_(b,a):this.fulfill_(a)};e.prototype.reject_=function(a){this.settle_(2,a)};e.prototype.fulfill_=function(a){this.settle_(1,a)};e.prototype.settle_=function(a,b){if(0!=this.state_)throw Error("Cannot settle("+a+", "+b+"): Promise already settled in state"+this.state_);this.state_=a;this.result_=b;this.executeOnSettledCallbacks_()};e.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var a=0;a<this.onSettledCallbacks_.length;++a)f.asyncExecute(this.onSettledCallbacks_[a]);
this.onSettledCallbacks_=null}};var f=new b;e.prototype.settleSameAsPromise_=function(a){var b=this.createResolveAndReject_();a.callWhenSettled_(b.resolve,b.reject)};e.prototype.settleSameAsThenable_=function(a,b){var c=this.createResolveAndReject_();try{a.call(b,c.resolve,c.reject)}catch(l){c.reject(l)}};e.prototype.then=function(a,b){function c(a,b){return"function"==typeof a?function(b){try{d(a(b))}catch(q){f(q)}}:b}var d,f,g=new e(function(a,b){d=a;f=b});this.callWhenSettled_(c(a,d),c(b,f));return g};
e.prototype.catch=function(a){return this.then(void 0,a)};e.prototype.callWhenSettled_=function(a,b){function c(){switch(d.state_){case 1:a(d.result_);break;case 2:b(d.result_);break;default:throw Error("Unexpected state: "+d.state_);}}var d=this;null==this.onSettledCallbacks_?f.asyncExecute(c):this.onSettledCallbacks_.push(c)};e.resolve=c;e.reject=function(a){return new e(function(b,c){c(a)})};e.race=function(a){return new e(function(b,d){for(var e=$jscomp.makeIterator(a),f=e.next();!f.done;f=e.next())c(f.value).callWhenSettled_(b,
d)})};e.all=function(a){var b=$jscomp.makeIterator(a),d=b.next();return d.done?c([]):new e(function(a,e){function f(b){return function(c){g[b]=c;h--;0==h&&a(g)}}var g=[],h=0;do g.push(void 0),h++,c(d.value).callWhenSettled_(f(g.length-1),e),d=b.next();while(!d.done)})};return e},"es6","es3");$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};
$jscomp.SymbolClass=function(a,b){this.$jscomp$symbol$id_=a;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:b})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};$jscomp.Symbol=function(){function a(c){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(c||"")+"_"+b++,c)}var b=0;return a}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.asyncIterator;a||(a=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.generator={};
$jscomp.generator.ensureIteratorResultIsObject_=function(a){if(!(a instanceof Object))throw new TypeError("Iterator result "+a+" is not an object");};$jscomp.generator.Context=function(){this.isRunning_=!1;this.yieldAllIterator_=null;this.yieldResult=void 0;this.nextAddress=1;this.finallyAddress_=this.catchAddress_=0;this.finallyContexts_=this.abruptCompletion_=null};
$jscomp.generator.Context.prototype.start_=function(){if(this.isRunning_)throw new TypeError("Generator is already running");this.isRunning_=!0};$jscomp.generator.Context.prototype.stop_=function(){this.isRunning_=!1};$jscomp.generator.Context.prototype.jumpToErrorHandler_=function(){this.nextAddress=this.catchAddress_||this.finallyAddress_};$jscomp.generator.Context.prototype.next_=function(a){this.yieldResult=a};
$jscomp.generator.Context.prototype.throw_=function(a){this.abruptCompletion_={exception:a,isException:!0};this.jumpToErrorHandler_()};$jscomp.generator.Context.prototype.return=function(a){this.abruptCompletion_={return:a};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.jumpThroughFinallyBlocks=function(a){this.abruptCompletion_={jumpTo:a};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.yield=function(a,b){this.nextAddress=b;return{value:a}};
$jscomp.generator.Context.prototype.yieldAll=function(a,b){a=$jscomp.makeIterator(a);var c=a.next();$jscomp.generator.ensureIteratorResultIsObject_(c);if(c.done)this.yieldResult=c.value,this.nextAddress=b;else return this.yieldAllIterator_=a,this.yield(c.value,b)};$jscomp.generator.Context.prototype.jumpTo=function(a){this.nextAddress=a};$jscomp.generator.Context.prototype.jumpToEnd=function(){this.nextAddress=0};
$jscomp.generator.Context.prototype.setCatchFinallyBlocks=function(a,b){this.catchAddress_=a;void 0!=b&&(this.finallyAddress_=b)};$jscomp.generator.Context.prototype.setFinallyBlock=function(a){this.catchAddress_=0;this.finallyAddress_=a||0};$jscomp.generator.Context.prototype.leaveTryBlock=function(a,b){this.nextAddress=a;this.catchAddress_=b||0};
$jscomp.generator.Context.prototype.enterCatchBlock=function(a){this.catchAddress_=a||0;a=this.abruptCompletion_.exception;this.abruptCompletion_=null;return a};$jscomp.generator.Context.prototype.enterFinallyBlock=function(a,b,c){c?this.finallyContexts_[c]=this.abruptCompletion_:this.finallyContexts_=[this.abruptCompletion_];this.catchAddress_=a||0;this.finallyAddress_=b||0};
$jscomp.generator.Context.prototype.leaveFinallyBlock=function(a,b){b=this.finallyContexts_.splice(b||0)[0];if(b=this.abruptCompletion_=this.abruptCompletion_||b){if(b.isException)return this.jumpToErrorHandler_();void 0!=b.jumpTo&&this.finallyAddress_<b.jumpTo?(this.nextAddress=b.jumpTo,this.abruptCompletion_=null):this.nextAddress=this.finallyAddress_}else this.nextAddress=a};$jscomp.generator.Context.prototype.forIn=function(a){return new $jscomp.generator.Context.PropertyIterator(a)};
$jscomp.generator.Context.PropertyIterator=function(a){this.object_=a;this.properties_=[];for(var b in a)this.properties_.push(b);this.properties_.reverse()};$jscomp.generator.Context.PropertyIterator.prototype.getNext=function(){for(;0<this.properties_.length;){var a=this.properties_.pop();if(a in this.object_)return a}return null};$jscomp.generator.Engine_=function(a){this.context_=new $jscomp.generator.Context;this.program_=a};
$jscomp.generator.Engine_.prototype.next_=function(a){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_.next,a,this.context_.next_);this.context_.next_(a);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.return_=function(a){this.context_.start_();var b=this.context_.yieldAllIterator_;if(b)return this.yieldAllStep_("return"in b?b["return"]:function(a){return{value:a,done:!0}},a,this.context_.return);this.context_.return(a);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.throw_=function(a){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_["throw"],a,this.context_.next_);this.context_.throw_(a);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.yieldAllStep_=function(a,b,c){try{var d=a.call(this.context_.yieldAllIterator_,b);$jscomp.generator.ensureIteratorResultIsObject_(d);if(!d.done)return this.context_.stop_(),d;var e=d.value}catch(f){return this.context_.yieldAllIterator_=null,this.context_.throw_(f),this.nextStep_()}this.context_.yieldAllIterator_=null;c.call(this.context_,e);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.nextStep_=function(){for(;this.context_.nextAddress;)try{var a=this.program_(this.context_);if(a)return this.context_.stop_(),{value:a.value,done:!1}}catch(b){this.context_.yieldResult=void 0,this.context_.throw_(b)}this.context_.stop_();if(this.context_.abruptCompletion_){a=this.context_.abruptCompletion_;this.context_.abruptCompletion_=null;if(a.isException)throw a.exception;return{value:a.return,done:!0}}return{value:void 0,done:!0}};
$jscomp.generator.Generator_=function(a){this.next=function(b){return a.next_(b)};this.throw=function(b){return a.throw_(b)};this.return=function(b){return a.return_(b)};$jscomp.initSymbolIterator();this[Symbol.iterator]=function(){return this}};$jscomp.generator.createGenerator=function(a,b){b=new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(b));$jscomp.setPrototypeOf&&$jscomp.setPrototypeOf(b,a.prototype);return b};
$jscomp.asyncExecutePromiseGenerator=function(a){function b(b){return a.next(b)}function c(b){return a.throw(b)}return new Promise(function(d,e){function f(a){a.done?d(a.value):Promise.resolve(a.value).then(b,c).then(f,e)}f(a.next())})};$jscomp.asyncExecutePromiseGeneratorFunction=function(a){return $jscomp.asyncExecutePromiseGenerator(a())};$jscomp.asyncExecutePromiseGeneratorProgram=function(a){return $jscomp.asyncExecutePromiseGenerator(new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(a)))};
$jscomp.checkStringArgs=function(a,b,c){if(null==a)throw new TypeError("The 'this' value for String.prototype."+c+" must not be null or undefined");if(b instanceof RegExp)throw new TypeError("First argument to String.prototype."+c+" must not be a regular expression");return a+""};
$jscomp.polyfill("String.prototype.repeat",function(a){return a?a:function(a){var b=$jscomp.checkStringArgs(this,null,"repeat");if(0>a||1342177279<a)throw new RangeError("Invalid count value");a|=0;for(var d="";a;)if(a&1&&(d+=b),a>>>=1)b+=b;return d}},"es6","es3");$jscomp.findInternal=function(a,b,c){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var f=a[e];if(b.call(c,f,e,a))return{i:e,v:f}}return{i:-1,v:void 0}};
$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).v}},"es6","es3");$jscomp.polyfill("Array.prototype.findIndex",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).i}},"es6","es3");var buildvers="0.5.7",builddate="2020.11.04",devmode=!1,traceajax=function(){};if("undefined"===typeof $.fn.popover)throw Error("Bootstrap library required");String.prototype.format||(String.prototype.format=function(){var a=arguments;return this.replace(/{(\d+)}/g,function(b,c){return"undefined"!==typeof a[c]?a[c]:b})});
String.prototype.printf||(String.prototype.printf=function(){var a=Array.prototype.slice.call(arguments),b=-1;return this.replace(/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g,function(c,d,e,f,k,g){if("%%"===c)return"%";if(void 0!==a[++b]){c=f?parseInt(f.substr(1)):void 0;f=k?parseInt(k.substr(1)):void 0;switch(g){case "s":var h=a[b];break;case "c":h=a[b][0];break;case "f":h=parseFloat(a[b]).toFixed(c);break;case "p":h=parseFloat(a[b]).toPrecision(c);break;case "e":h=parseFloat(a[b]).toExponential(c);
break;case "x":h=parseInt(a[b]).toString(f?f:16);break;case "d":h=parseFloat(parseInt(a[b],f?f:10).toPrecision(c)).toFixed(0)}h="object"===typeof h?JSON.stringify(h):h.toString(f);c=parseInt(e);for(e=e&&"0"===e[0]?"0":" ";h.length<c;)h=void 0!==d?h+e:e+h;return h}})});
var fmtfilesize=function(a){return 1536>a?a+" bytes":1048576>a?(a/1024).toPrecision(3)+" kB":1073741824>a?(a/1048576).toPrecision(3)+" MB":1099511627776>a?(a/1073741824).toPrecision(3)+" GB":(a/1099511627776).toPrecision(3)+" TB"},fmtitemsize=function(a){return 1536>a?fmtfilesize(a):"%s (%d bytes)".printf(fmtfilesize(a),a)},fmttime=function(a,b){var c=function(a,b){a=Math.floor(a).toString();b-=a.length;return 0<b?"0".repeat(b)+a:a};if(60>b)return c(a,2);if(3600>b)return b=a%60,c(a/60,2)+":"+c(b,
2);b=a%60;var d=a%3600/60;return c(a/3600,2)+":"+c(d,2)+":"+c(b,2)},makestrid=function(a){for(var b="",c=0;c<a;c++)b+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(62*Math.random()));return b},makeeventmodel=function(){var a=[];return{emit:function(b,c){for(var d=[],e=1;e<arguments.length;++e)d[e-1]=arguments[e];for(e=0;e<a.length;){var f=$jscomp.makeIterator(a[e]),k=f.next().value,g=f.next().value;f=f.next().value;if(k===b){f&&(a.splice(e,1),e--);try{g.apply(null,
$jscomp.arrayFromIterable(d))}catch(h){console.error(h)}}e++}},on:function(b,c,d){return a.push([b,c,void 0===d?!1:d])},once:function(b,c){return a.push([b,c,!0])},off:function(b,c){for(var d=0;d<a.length;){var e=$jscomp.makeIterator(a[d]),f=e.next().value;e=e.next().value;f!==b&&b||e!==c&&c?d++:a.splice(d,1)}},onmap:function(b){for(var c in b)a.push([c,b[c],!1])},offmap:function(b){for(var c in b){var d=b[c],e;for(e in a.length){var f=$jscomp.makeIterator(a[e]),k=f.next().value;f=f.next().value;
if(k===c&&f===d){a.splice(e,1);break}}}},listens:function(b,c){for(var d=0,e=$jscomp.makeIterator(a),f=e.next();!f.done;f=e.next()){var k=$jscomp.makeIterator(f.value);f=k.next().value;k=k.next().value;f!==b&&b||k!==c&&c||d++}return d},listenlen:function(){return a.length}}},extend=function(a,b){for(var c in b)a[c]=b[c];return a};var auth=extend({token:{access:null,refrsh:null},login:"",signed:function(){return!!this.token.access},claims:function(){try{var a=this.token.access.split(".");return JSON.parse(atob(a[1]))}catch(b){return null}},signin:function(a,b){sessionStorage.setItem("token",JSON.stringify(a));this.token.access=a.access;this.token.refrsh=a.refrsh;b&&(sessionStorage.setItem("login",b),this.login=b);this.emit("auth",!0)},signout:function(){sessionStorage.removeItem("token");this.token.access=null;this.token.refrsh=
null;this.emit("auth",!1)},signload:function(){try{var a=JSON.parse(sessionStorage.getItem("token"));this.token.access=a.access;this.token.refrsh=a.refrsh;this.login=sessionStorage.getItem("login")||"";this.emit("auth",!0)}catch(b){this.token.access=null,this.token.refrsh=null,this.login="",this.emit("auth",!1)}}},makeeventmodel()),ajaxcc=extend({},makeeventmodel()),HttpError=function(a,b){var c=Error.call(this,b.what);this.message=c.message;"stack"in c&&(this.stack=c.stack);this.name="HttpError";
this.status=a;extend(this,b)};$jscomp.inherits(HttpError,Error);
var ajaxheader=function(a){var b={Accept:"application/json;charset=utf-8","Content-Type":"application/json;charset=utf-8"};a&&auth.token.access&&(b.Authorization="Bearer "+auth.token.access);return b},fetchjson=function(a,b,c){return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){return 1==d.nextAddress?d.yield(fetch(b,{method:a,headers:ajaxheader(!1),body:JSON.stringify(c)}),2):d.return(d.yieldResult)})},fetchajax=function(a,b,c){var d,e;return $jscomp.asyncExecutePromiseGeneratorProgram(function(f){if(1==
f.nextAddress)return f.yield(fetch(b,{method:a,headers:ajaxheader(!1),body:c&&JSON.stringify(c)}),2);if(3!=f.nextAddress)return e=d=f.yieldResult,f.yield(d.json(),3);e.data=f.yieldResult;return f.return(d)})},fetchjsonauth=function(a,b,c){var d,e,f,k;return $jscomp.asyncExecutePromiseGeneratorProgram(function(g){switch(g.nextAddress){case 1:return g.yield(fetch(b,{method:a,headers:ajaxheader(!0),body:c&&JSON.stringify(c)}),2);case 2:d=g.yieldResult;if(401!==d.status||!auth.token.refrsh){g.jumpTo(3);
break}return g.yield(fetchjson("POST","/api/auth/refrsh",{refrsh:auth.token.refrsh}),4);case 4:return e=g.yieldResult,g.yield(e.json(),5);case 5:f=g.yieldResult;if(!e.ok)throw new HttpError(e.status,f);auth.signin(f);k=fetch(b,{method:a,headers:ajaxheader(!0),body:c&&JSON.stringify(c)});return g.return(k);case 3:return g.return(d)}})},fetchajaxauth=function(a,b,c){var d,e;return $jscomp.asyncExecutePromiseGeneratorProgram(function(f){if(1==f.nextAddress)return f.yield(fetchjsonauth(a,b,c),2);if(3!=
f.nextAddress)return e=d=f.yieldResult,f.yield(d.json(),3);e.data=f.yieldResult;return f.return(d)})};var filetmbwebp=function(a){return 1===a.ntmb?"":"/asst/file-webp/"+geticonname(a)+".webp"},filetmbpng=function(a){return 1===a.ntmb?"/id"+app.aid+"/thumb/"+a.puid:"/asst/file-png/"+geticonname(a)+".png"},makemarkercontent=function(a){return'\n<div class="photoinfo">\n\t<ul class="nav nav-tabs" role="tablist">\n\t\t<li class="nav-item"><a class="nav-link active" data-toggle="tab" href="#pict">Thumbnail</a></li>\n\t\t<li class="nav-item"><a class="nav-link" data-toggle="tab" href="#prop">Properties</a></li>\n\t</ul>\n\t<div class="tab-content">\n\t\t<div class="tab-pane active" id="pict">\n\t\t\t<picture>\n\t\t\t\t<source srcset="'+
filetmbwebp(a)+'" class="rounded thumb" type="image/webp">\n\t\t\t\t<source srcset="'+filetmbpng(a)+'" class="rounded thumb" type="image/png">\n\t\t\t\t<img src="/asst/file-png/doc-file.png" class="rounded thumb" alt="'+a.name+'">\n\t\t\t</picture>\n\t\t\t<div class="d-flex flex-wrap latlng">\n\t\t\t\t<div><div class="name">lat:</div> <div class="value">'+a.latitude.toFixed(6)+'</div></div>\n\t\t\t\t<div><div class="name">lng:</div> <div class="value">'+a.longitude.toFixed(6)+'</div></div>\n\t\t\t\t<div><div class="name">alt:</div> <div class="value">'+
(a.altitude||"N/A")+'</div></div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="tab-pane fade" id="prop">\n\t\t\t<ul class="prop p-0 m-0"><li>'+filehint(a).join("</li><li>")+"</li></ul>\n\t\t</div>\n\t</div>\n</div>\n"},filehint=function(a){var b=[];b.push(a.name);FTtoFG[a.type]!==FG.dir&&b.push("size: "+fmtitemsize(a.size||0));a.time&&b.push("time: "+(new Date(a.time)).toLocaleString());a.title&&b.push("title: "+a.title);a.album&&b.push("album: "+a.album);a.artist&&b.push("artist: "+a.artist);a.composer&&
b.push("composer: "+a.composer);a.genre&&b.push("genre: "+a.genre);a.year&&b.push("year: "+a.year);a.track&&(a.track.number||a.track.total)&&b.push("track: "+(a.track.number||"")+"/"+(a.track.total||""));a.disc&&(a.disc.number||a.disc.total)&&b.push("disc: "+(a.disc.number||"")+"/"+(a.disc.total||""));a.comment&&b.push("comment: "+a.comment.substring(0,80));a.width&&a.height&&b.push("dimension: "+a.width+"x"+a.height);a.model&&b.push("model: "+a.model);a.make&&b.push("manufacturer: "+a.make);a.datetime&&
b.push("photo taken: "+(new Date(a.datetime)).toLocaleString());if(a.orientation)switch(a.orientation){case 1:b.push("orientation: normal");break;case 2:b.push("orientation: horizontal reversed");break;case 3:b.push("orientation: flipped");break;case 4:b.push("orientation: flipped & horizontal reversed");break;case 5:b.push("orientation: clockwise turned & horizontal reversed");break;case 6:b.push("orientation: clockwise turned");break;case 7:b.push("orientation: anticlockwise turned & horizontal reversed");
break;case 8:b.push("orientation: anticlockwise turned")}if(a.exposureprog)switch(a.exposureprog){case 1:b.push("exposure program: manual");break;case 2:b.push("exposure program: normal program");break;case 3:b.push("exposure program: aperture priority");break;case 4:b.push("exposure program: shutter priority");break;case 5:b.push("exposure program: creative program (depth of field)");break;case 6:b.push("exposure program: action program (fast shutter speed)");break;case 7:b.push("exposure program: portrait mode (background out of focus)");
break;case 8:b.push("exposure program: landscape mode (background in focus)")}a.exposuretime&&b.push("exposure time: "+a.exposuretime+" sec");a.fnumber&&b.push("F-number: f/"+a.fnumber);a.isospeed&&b.push("ISO speed rating: ISO-"+a.isospeed);a.shutterspeed&&b.push("shutter speed: "+a.shutterspeed);a.aperture&&b.push("lens aperture: "+a.aperture);a.exposurebias&&b.push("exposure bias: "+a.exposurebias);if(a.lightsource)switch(a.lightsource){case 1:b.push("light source: daylight");break;case 2:b.push("light source: fluorescent");
break;case 3:b.push("light source: tungsten (incandescent light)");break;case 4:b.push("light source: flash");break;case 9:b.push("light source: fine weather");break;case 10:b.push("light source: cloudy weather");break;case 11:b.push("light source: shade");break;case 12:b.push("light source: daylight fluorescent (D 5700-7100K)");break;case 13:b.push("light source: day white fluorescent (N 4600-5700K)");break;case 14:b.push("light source: cool white fluorescent (W 3800-4600K)");break;case 15:b.push("light source: white fluorescent (WW 3250-3800K)");
break;case 16:b.push("light source: warm white fluorescent (L 2600-3250K)");break;case 17:b.push("light source: standard light A");break;case 18:b.push("light source: standard light B");break;case 19:b.push("light source: standard light C");break;case 20:b.push("light source: D55");break;case 21:b.push("light source: D65");break;case 22:b.push("light source: D75");break;case 23:b.push("light source: D50");break;case 24:b.push("light source: ISO studio tungsten");break;case 255:b.push("light source: other light source");
break;default:b.push("light source: light code #"+a.lightsource)}a.focal&&b.push("focal length: "+a.focal+" mm");a.focal35mm&&b.push("35mm equivalent focal length: "+a.focal35mm+" mm");a.digitalzoom&&b.push("digital zoom ratio: "+a.digitalzoom);a.flash&&(a.flash&1?b.push("flash fired"):b.push("flash did not fire"),4===(a.flash&6)?b.push("strobe return light: not detected"):6===(a.flash&6)&&b.push("strobe return light: detected"),8===(a.flash&24)?b.push("flash mode: compulsory flash firing"):16===
(a.flash&24)?b.push("flash mode: compulsory flash suppression"):24===(a.flash&24)&&b.push("flash mode: auto"),a.flash&64&&b.push("red-eye reduction supported"));a.uniqueid&&b.push("unique ID: "+a.uniqueid);return b};
Vue.component("file-icon-tag",{template:"#file-icon-tpl",props:["file","state","size"],computed:{fmttitle:function(){return filehint(this.file).join("\n")},webpicon:function(){return filetmbwebp(this.file)},pngicon:function(){return filetmbpng(this.file)},clsoverlay:function(){switch(this.size){case "smicon":return"smoverlay";case "mdicon":return"mdoverlay";case "lgicon":return"lgoverlay"}},clsimage:function(){switch(this.size){case "smicon":return"smimage";case "mdicon":return"mdimage";case "lgicon":return"lgimage"}},
itemview:function(){return{selected:this.state.selected}}},methods:{onselect:function(){this.$emit("select",this.file)},onopen:function(){this.$emit("open",this.file)}}});
Vue.component("img-icon-tag",{template:"#img-icon-tpl",props:["file","state"],computed:{fmttitle:function(){return filehint(this.file).join("\n")},webpicon:function(){return filetmbwebp(this.file)},pngicon:function(){return filetmbpng(this.file)},itemview:function(){return{selected:this.state.selected}}},methods:{onselect:function(){this.$emit("select",this.file)},onopen:function(){this.$emit("open",this.file)}}});var sortbyalpha="name",sortbysize="size",unsorted="",listmodetag={smicon:"file-icon-tag",mdicon:"file-icon-tag",lgicon:"img-icon-tag"},listmoderow={smicon:"align-items-start",mdicon:"align-items-start",lgicon:"align-items-center"},listmodeicon={smicon:"format_align_justify",mdicon:"view_comfy",lgicon:"view_module"},listmodehint={smicon:"small icons",mdicon:"middle icons",lgicon:"large icons"},listmodenext={smicon:"mdicon",mdicon:"lgicon",lgicon:"smicon"},copyTextToClipboard=function(a){var b=document.createElement("textarea");
b.value=a;b.style.position="fixed";b.style.left="0px";b.style.top="0px";document.body.appendChild(b);b.focus();b.select();try{return!document.execCommand("copy")&&"copying text command was failed"}catch(c){return c}finally{document.body.removeChild(b)}};
Vue.component("dir-card-tag",{template:"#dir-card-tpl",props:["list","shared"],data:function(){return{isauth:!1,selfile:null,order:1,listmode:"smicon",diskpath:"",diskpathstate:0,iid:makestrid(10)}},computed:{isadmin:function(){return this.isauth||"localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname},isvisible:function(){var a=this;(function(){a.list.find(function(b){return b===a.selfile})||(a.selfile=null)})();return 0<this.list.length},sortedlist:function(){var a=this;
return this.list.slice().sort(function(b,c){return a.order*(b.name.toLowerCase()>c.name.toLowerCase()?1:-1)})},clsfilelist:function(){return listmoderow[this.listmode]},dislink:function(){return!this.selfile||this.selfile.type===FT.cat},disshared:function(){return!this.selfile},clsshared:function(){return{active:this.selfile&&this.isshared(this.selfile)}},disdiskadd:function(){return!this.diskpath.length},disdiskremove:function(){return!this.selfile||this.selfile.type!==FT.drive},clsorder:function(){return 0<
this.order?"arrow_downward":"arrow_upward"},clslistmode:function(){return listmodeicon[this.listmode]},clsdiskpathedt:function(){return this.diskpathstate?-1===this.passstate?"is-invalid":"is-valid":""},iconmodetag:function(){return listmodetag[this.listmode]},hintorder:function(){return 0<this.order?"direct order":"reverse order"},hintlist:function(){return listmodehint[this.listmode]}},methods:{isshared:function(a){for(var b=$jscomp.makeIterator(this.shared),c=b.next();!c.done;c=b.next())if(c.value.puid===
a.puid)return!0;return!1},getstate:function(a){return{selected:this.selfile===a,playback:!1,shared:this.isshared(a)}},onlink:function(){copyTextToClipboard(window.location.origin+pathurl(this.selfile))},onshare:function(){this.$emit("share",this.selfile)},onorder:function(){this.order=-this.order},onlistmode:function(){this.listmode=listmodenext[this.listmode]},ondiskadd:function(){var a=this;(function(){var b,c,d;return $jscomp.asyncExecutePromiseGeneratorProgram(function(e){switch(e.nextAddress){case 1:return ajaxcc.emit("ajax",
1),e.setCatchFinallyBlocks(2,3),e.yield(fetchajaxauth("POST","/api/drive/add",{aid:app.aid,path:a.diskpath}),5);case 5:b=e.yieldResult,traceajax(b),b.ok?((c=b.data)&&a.list.push(c),$("#diskadd"+a.iid).modal("hide")):a.diskpathstate=-1;case 3:e.enterFinallyBlock();ajaxcc.emit("ajax",-1);e.leaveFinallyBlock(0);break;case 2:d=e.enterCatchBlock(),ajaxfail(d),e.jumpTo(3)}})})()},ondiskremove:function(){var a=this;(function(){var b,c;return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){switch(d.nextAddress){case 1:return ajaxcc.emit("ajax",
1),d.setCatchFinallyBlocks(2,3),d.yield(fetchajaxauth("POST","/api/drive/del",{aid:app.aid,puid:a.selfile.puid}),5);case 5:b=d.yieldResult;traceajax(b);if(!b.ok)throw new HttpError(b.status,b.data);if(!b.data){d.jumpTo(3);break}a.list.splice(a.list.findIndex(function(b){return b===a.selfile}),1);if(!a.isshared(a.selfile)){d.jumpTo(3);break}return d.yield(a.fetchsharedel(a.selfile),3);case 3:d.enterFinallyBlock();ajaxcc.emit("ajax",-1);d.leaveFinallyBlock(0);break;case 2:c=d.enterCatchBlock(),ajaxfail(c),
d.jumpTo(3)}})})()},ondiskpathchange:function(a){var b=this;(function(){var a,d;return $jscomp.asyncExecutePromiseGeneratorProgram(function(c){if(1==c.nextAddress)return c.setCatchFinallyBlocks(2),c.yield(fetchajaxauth("POST","/card/path/ispath",{aid:app.aid,path:b.diskpath}),4);if(2!=c.nextAddress)return a=c.yieldResult,b.diskpathstate=a.ok?a.data?1:0:-1,c.leaveTryBlock(0);d=c.enterCatchBlock();ajaxfail(d);c.jumpToEnd()})})()},onselect:function(a){this.selfile=a},onopen:function(a){this.$emit("open",
a)},onunselect:function(){this.onselect(null)}},mounted:function(){var a=this;this._authclosure=function(b){return a.isauth=b};auth.on("auth",this._authclosure);$("#diskadd"+this.iid).on("shown.bs.modal",function(){$(this).find("input").trigger("focus")})},beforeDestroy:function(){auth.off("auth",this._authclosure);$("#diskadd"+this.iid).off("shown.bs.modal")}});
Vue.component("file-card-tag",{template:"#file-card-tpl",props:["list","shared"],data:function(){return{isauth:!1,selfile:null,playbackfile:null,order:1,sortmode:sortbyalpha,listmode:"smicon",music:!0,video:!0,image:!0,books:!0,texts:!0,other:!1,audioonly:!1,viewer:null,iid:makestrid(10)}},computed:{isadmin:function(){return this.isauth||"localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname},isvisible:function(){var a=this;(function(){a.list.find(function(b){return b===a.selfile})||
(a.selfile=null,a.closeviewer())})();return 0<this.list.length},playlist:function(){for(var a=this,b=[],c=$jscomp.makeIterator(this.list),d=c.next();!d.done;d=c.next())d=d.value,this.showitem(d)&&b.push(d);this.sortmode===sortbyalpha?b.sort(function(b,c){return a.order*(b.name.toLowerCase()>c.name.toLowerCase()?1:-1)}):this.sortmode===sortbysize&&b.sort(function(b,c){return b.size===c.size?a.order*(b.name.toLowerCase()>c.name.toLowerCase()?1:-1):a.order*(b.size>c.size?1:-1)});return b},clsfilelist:function(){return listmoderow[this.listmode]},
dislink:function(){return!this.selfile||this.selfile.type===FT.cat},disshared:function(){return!this.selfile},clsshared:function(){return{active:this.selfile&&this.isshared(this.selfile)}},clsorder:function(){return 0<this.order?"arrow_downward":"arrow_upward"},clssortmode:function(){switch(this.sortmode){case sortbyalpha:return"sort_by_alpha";case sortbysize:return"sort";case unsorted:return"reorder"}},clslistmode:function(){return listmodeicon[this.listmode]},showmusic:function(){return!!this.list.find(function(a){return FTtoFG[a.type]===
FG.music})},showvideo:function(){return!!this.list.find(function(a){return FTtoFG[a.type]===FG.video})},showphoto:function(){return!!this.list.find(function(a){return FTtoFG[a.type]===FG.image})},showbooks:function(){return!!this.list.find(function(a){return FTtoFG[a.type]===FG.books})},showtexts:function(){return!!this.list.find(function(a){return FTtoFG[a.type]===FG.texts})},showother:function(){return!!this.list.find(function(a){return!a.type||FTtoFG[a.type]===FG.store||FTtoFG[a.type]===FG.other})},
clsaudio:function(){return{active:this.audioonly}},clsmusic:function(){return{active:this.music}},clsvideo:function(){return{active:this.video}},clsphoto:function(){return{active:this.image}},clsbooks:function(){return{active:this.books}},clstexts:function(){return{active:this.texts}},clsother:function(){return{active:this.other}},iconmodetag:function(){return listmodetag[this.listmode]},hintorder:function(){return 0<this.order?"direct order":"reverse order"},hintsortmode:function(){switch(this.sortmode){case sortbyalpha:return"sort by alpha";
case sortbysize:return"sort by size";case unsorted:return"as is unsorted"}},hintlist:function(){return listmodehint[this.listmode]}},methods:{showitem:function(a){switch(FTtoFG[a.type]){case FG.dir:return!0;case FG.music:return this.music;case FG.video:return this.video;case FG.image:return this.image;case FG.books:return this.books;case FG.texts:return this.texts;default:return this.other}},isshared:function(a){for(var b=$jscomp.makeIterator(this.shared),c=b.next();!c.done;c=b.next())if(c.value.puid===
a.puid)return!0;return!1},getstate:function(a){return{selected:this.selfile===a,playback:this.playbackfile&&this.playbackfile.name===a.name,shared:this.isshared(a)}},closeviewer:function(){this.viewer&&(this.viewer.close(),this.viewer.visible=!1,this.viewer=null)},onlink:function(){copyTextToClipboard(window.location.origin+fileurl(this.selfile))},onshare:function(){this.$emit("share",this.selfile)},onorder:function(){this.order=-this.order},onsortmode:function(){switch(this.sortmode){case sortbyalpha:this.sortmode=
sortbysize;break;case sortbysize:this.sortmode=unsorted;break;case unsorted:this.sortmode=sortbyalpha}},onlistmode:function(){this.listmode=listmodenext[this.listmode]},onaudio:function(){this.audioonly=!this.audioonly},onmusic:function(){this.music=!this.music},onvideo:function(){this.video=!this.video},onphoto:function(){this.image=!this.image},onbooks:function(){this.books=!this.books},ontexts:function(){this.texts=!this.texts},onother:function(){this.other=!this.other},onselect:function(a){if(this.selfile=
a)switch(FTtoFV[a.type]){case FV.none:this.closeviewer();break;case FV.music:this.viewer=this.$refs.mp3player;this.viewer.setup(a);this.viewer.visible=!0;break;case FV.video:this.audioonly?this.closeviewer():(this.viewer=this.$refs.mp3player,this.viewer.setup(a),this.viewer.visible=!0);break;case FV.image:this.closeviewer();break;default:this.closeviewer()}else this.closeviewer()},onopen:function(a){switch(FTtoFV[a.type]){case FV.image:this.closeviewer();this.$refs.slider.popup(a);break;default:var b=
mediaurl(a);window.open(b,a.name)}},onunselect:function(){this.onselect(null)},onplayback:function(a){this.playbackfile=a}},mounted:function(){var a=this;this._authclosure=function(b){return a.isauth=b};auth.on("auth",this._authclosure)},beforeDestroy:function(){auth.off("auth",this._authclosure)}});
Vue.component("map-card-tag",{template:"#map-card-tpl",data:function(){return{map:null,markers:null,markermode:"thumb",gpslist:[],iid:makestrid(10)}},computed:{isvisible:function(){return 0<this.gpslist.length},iconmarkermode:function(){switch(this.markermode){case "marker":return"place";case "thumb":return"local_see"}},hintmarkermode:function(){switch(this.markermode){case "marker":return"photo positions by markers";case "thumb":return"photo positions by thumbnails"}}},methods:{new:function(){if(!this.markers||
0<this.gpslist.length)this.markers&&this.map.removeLayer(this.markers),this.markers=L.markerClusterGroup(),this.map.addLayer(this.markers),this.gpslist=[]},addmarkers:function(a){var b=this;if(a.length){for(var c={},d=$jscomp.makeIterator(a),e=d.next();!e.done;c={$jscomp$loop$prop$file$25$37:c.$jscomp$loop$prop$file$25$37},e=d.next()){c.$jscomp$loop$prop$file$25$37=e.value;e={title:c.$jscomp$loop$prop$file$25$37.name,riseOnHover:!0};"thumb"===this.markermode&&c.$jscomp$loop$prop$file$25$37.puid&&
(e.icon=L.divIcon({html:'<img src="'+filetmbpng(c.$jscomp$loop$prop$file$25$37)+'">',className:"photomarker",iconSize:[60,60],iconAnchor:[30,30],popupAnchor:[0,-15]}));var f=document.createElement("template");f.innerHTML=makemarkercontent(c.$jscomp$loop$prop$file$25$37).trim();f=f.content.firstChild;f.querySelector(".photoinfo picture").addEventListener("click",function(a){return function(){b.$refs.slider.popup(a.$jscomp$loop$prop$file$25$37)}}(c));L.marker([c.$jscomp$loop$prop$file$25$37.latitude,
c.$jscomp$loop$prop$file$25$37.longitude],e).addTo(this.markers).bindPopup(f)}var k=!this.gpslist.length;Vue.nextTick(function(){k&&b.map.invalidateSize();b.map.flyToBounds(b.markers.getBounds(),{padding:[20,20]})});this.gpslist.push.apply(this.gpslist,$jscomp.arrayFromIterable(a))}},onmarkermode:function(){switch(this.markermode){case "marker":this.markermode="thumb";break;case "thumb":this.markermode="marker"}var a=this.gpslist;this.new();this.addmarkers(a)},onfitbounds:function(){this.map.flyToBounds(this.markers.getBounds(),
{padding:[20,20]})}},mounted:function(){var a=L.tileLayer("https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.jpg?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/" target="_blank">OpenStreetMap</a> contributors, Imagery &copy <a href="https://www.mapbox.com/" target="_blank">Mapbox</a>',minZoom:2,id:"mapbox.streets-satellite"});this.map=L.map(this.$refs.map,{center:[0,0],zoom:8,
layers:[a]})}});var mp3filter=function(a){return FTtoFV[a.type]===FV.music||FTtoFV[a.type]===FV.video};
Vue.component("mp3-player-tag",{template:"#mp3-player-tpl",props:["list"],data:function(){return{visible:!1,selfile:{},volval:100,ratval:6,repeatmode:0,seeking:!1,media:null,isplay:!1,isflowing:!1,ready:!1,timecur:0,timebuf:0,timeend:0,ratevals:[.4,.5,1/1.75,1/1.5,.8,1/1.15,1,1.15,1.25,1.5,1.75,2,2.5],iid:makestrid(10)}},computed:{selfilepos:function(){for(var a in this.list)if(this.selfile.puid===this.list[a].puid)return Number(a)},getprev:function(){var a=this,b=function(b,d){for(--b;b>d;b--){var c=
a.list[b];if(mp3filter(c))return c}};return b(this.selfilepos,-1)||2===this.repeatmode&&b(this.list.length,this.selfilepos)},getnext:function(){var a=this,b=function(b,d){for(b+=1;b<d;b++){var c=a.list[b];if(mp3filter(c))return c}};return b(this.selfilepos,this.list.length)||2===this.repeatmode&&b(-1,this.selfilepos)},volumelabel:function(){return this.volval},ratelabel:function(){return this.ratevals[this.ratval].toFixed(2)},iconplay:function(){return this.isplay?"pause":"play_arrow"},hintplay:function(){return this.isplay?
"pause":"play"},iconrepeat:function(){return 1===this.repeatmode?"repeat_one":"repeat"},hintrepeat:function(){switch(this.repeatmode){case 0:return"no any repeat";case 1:return"repeat one";case 2:return"repeat playlist"}},fmttimecur:function(){return fmttime(this.timecur,this.timeend)},fmttimeend:function(){return fmttime(this.timeend,this.timeend)},fmttrackinfo:function(){return this.selfile.title?(this.selfile.artist||this.selfile.album||this.selfile.genre||"")+" - "+this.selfile.title:this.selfile.name},
stlbarcur:function(){return{width:(Infinity===this.timeend?95:!this.timeend||isNaN(this.timeend)?5:this.timecur/this.timeend*100)+"%"}},stlbarbuf:function(){return{width:(Infinity===this.timeend?0:!this.timeend||isNaN(this.timeend)?0:this.timebuf/this.timeend*100)+"%"}}},methods:{setup:function(a){var b=this;this.selfile.puid!==a.puid&&(this.close(),this.selfile=a,this.media=new Audio(mediaurl(a)),this.media.volume=this.volval/100,this.media.playbackRate=this.ratevals[this.ratval],this.media.loop=
1===this.repeatmode,this.ready=!1,this.media.addEventListener("loadedmetadata",function(){b.updateprogress()}),this.media.addEventListener("canplay",function(){var a=b.media.duration;b.timecur=b.media.currentTime;b.timebuf=0;b.timeend=a;b.ready=!0;b.isflowing&&(b.media.play(),b.isplay=!0,b.$emit("playback",b.selfile))}),this.media.addEventListener("timeupdate",function(){return b.updateprogress()}),this.media.addEventListener("seeked",function(){return b.updateprogress()}),this.media.addEventListener("progress",
function(){return b.updateprogress()}),this.media.addEventListener("play",function(){}),this.media.addEventListener("pause",function(){}),this.media.addEventListener("ended",function(){b.isplay=!1;b.$emit("playback",null);b.onnext()}))},close:function(){return this.media&&!this.media.paused?(this.media.pause(),this.isplay=!1,this.$emit("playback",null),!0):!1},play:function(){this.media&&(this.media.paused?(this.media.play(),this.isflowing=this.isplay=!0,this.$emit("playback",this.selfile)):(this.media.pause(),
this.isflowing=this.isplay=!1,this.$emit("playback",null)))},updateprogress:function(){var a=this.media.currentTime;this.seeking||(this.timecur=a);if(0<this.media.buffered.length){var b=this.media.buffered.start(0),c=this.media.buffered.end(0);this.timebuf=b<=a&&c>a?c-a:0}else this.timebuf=0},onprev:function(){this.getprev&&this.$emit("select",this.getprev)},onplay:function(){this.play()},onnext:function(){this.getnext&&this.$emit("select",this.getnext)},onrepeat:function(){this.repeatmode=(this.repeatmode+
1)%(this.list?3:2);this.media&&(this.media.loop=1===this.repeatmode)},onseekerchange:function(a){this.media.currentTime=a.target.value;this.seeking=!1},onseekerinput:function(a){this.seeking=!0;this.timecur=Number(a.target.value)},onvolinp:function(a){this.volval=Number(a.target.value)},onvolval:function(a){this.media&&(this.media.volume=this.volval/100)},onratinp:function(a){this.ratval=Number(a.target.value)},onratval:function(a){this.media&&(this.media.playbackRate=this.ratevals[this.ratval])}}});var photofilter=function(a){return FTtoFV[a.type]===FV.image};
Vue.component("thumbslider-tag",{template:"#thumbslider-tpl",props:["selfile","list"],computed:{slide:function(){for(var a=[],b=$jscomp.makeIterator(this.list),c=b.next();!c.done;c=b.next())c=c.value,photofilter(c)&&a.push(c);return a}},methods:{getthumb:function(a){return filetmbpng(a)},onprev:function(){this.$refs.slide.scrollBy({left:-120,behavior:"smooth"})},onnext:function(){this.$refs.slide.scrollBy({left:120,behavior:"smooth"})},onthumb:function(a){this.$emit("select",a)}}});
Vue.component("photoslider-tag",{template:"#photoslider-tpl",props:["list"],data:function(){return{selfile:null,selfileurl:null,imgloading:!1,repeatmode:0}},computed:{selfilepos:function(){for(var a in this.list)if(this.selfile.puid===this.list[a].puid)return Number(a)},getprev:function(){var a=this,b=function(b,d){for(--b;b>d;b--){var c=a.list[b];if(photofilter(c))return c}};return this.selfile&&(b(this.selfilepos,-1)||2===this.repeatmode&&b(this.list.length,this.selfilepos))},getnext:function(){var a=
this,b=function(b,d){for(b+=1;b<d;b++){var c=a.list[b];if(photofilter(c))return c}};return this.selfile&&(b(this.selfilepos,this.list.length)||2===this.repeatmode&&b(-1,this.selfilepos))},islist:function(){return this.list&&1<this.list.length}},methods:{load:function(a){a&&(this.imgloading=!0);this.selfileurl=a},select:function(a){this.selfile=a;this.load(mediaurl(a));this.$emit("select",a)},popup:function(a){this.selfile=a;this.load(mediaurl(a));$(this.$refs.modal).modal("show")},close:function(){this.selfile=
null;this.load(mediaurl(file));$(this.$refs.modal).modal("hide")},onimgload:function(a){this.imgloading=!1},onimgerror:function(a){this.imgloading=!1},onkeyup:function(a){switch(a.code){case "ArrowLeft":this.onprev();break;case "ArrowRight":case "Space":this.onnext();break;case "Home":this.list&&this.select(this.list[0]);break;case "End":this.list&&this.select(this.list[this.list.length-1])}},onselect:function(a){this.select(a)},onprev:function(){this.getprev&&this.select(this.getprev)},onnext:function(){this.getnext&&
this.select(this.getnext)},onclose:function(){this.close()}}});var skinlist=[{name:"daylight",link:"/data/skin/daylight.css"},{name:"blue",link:"/data/skin/blue.css"},{name:"neon",link:"/data/skin/neon.css"},{name:"cup of coffee",link:"/data/skin/cup-of-coffee.css"},{name:"coffee beans",link:"/data/skin/coffee-beans.css"},{name:"old monitor",link:"/data/skin/old-monitor.css"}],FT={cat:-3,drive:-2,dir:-1,file:0,wave:1,flac:2,mp3:3,ogg:4,mp4:5,webm:6,tga:7,bmp:8,dds:9,tiff:10,jpeg:11,gif:12,png:13,webp:14,psd:15,pdf:16,html:17,text:18,scr:19,cfg:20,log:21,cab:22,
zip:23,rar:24},FG={other:0,music:1,video:2,image:3,books:4,texts:5,store:6,dir:7},$jscomp$compprop0={},FTtoFG=($jscomp$compprop0[FT.cat]=FG.dir,$jscomp$compprop0[FT.drive]=FG.dir,$jscomp$compprop0[FT.dir]=FG.dir,$jscomp$compprop0[FT.file]=FG.other,$jscomp$compprop0[FT.wave]=FG.music,$jscomp$compprop0[FT.flac]=FG.music,$jscomp$compprop0[FT.mp3]=FG.music,$jscomp$compprop0[FT.ogg]=FG.video,$jscomp$compprop0[FT.mp4]=FG.video,$jscomp$compprop0[FT.webm]=FG.video,$jscomp$compprop0[FT.tga]=FG.image,$jscomp$compprop0[FT.bmp]=
FG.image,$jscomp$compprop0[FT.dds]=FG.image,$jscomp$compprop0[FT.tiff]=FG.image,$jscomp$compprop0[FT.jpeg]=FG.image,$jscomp$compprop0[FT.gif]=FG.image,$jscomp$compprop0[FT.png]=FG.image,$jscomp$compprop0[FT.webp]=FG.image,$jscomp$compprop0[FT.psd]=FG.image,$jscomp$compprop0[FT.pdf]=FG.books,$jscomp$compprop0[FT.html]=FG.books,$jscomp$compprop0[FT.text]=FG.texts,$jscomp$compprop0[FT.scr]=FG.texts,$jscomp$compprop0[FT.cfg]=FG.texts,$jscomp$compprop0[FT.log]=FG.texts,$jscomp$compprop0[FT.cab]=FG.store,
$jscomp$compprop0[FT.zip]=FG.store,$jscomp$compprop0[FT.rar]=FG.store,$jscomp$compprop0),FV={none:0,music:1,video:2,image:3},$jscomp$compprop1={},FTtoFV=($jscomp$compprop1[FT.cat]=FV.none,$jscomp$compprop1[FT.drive]=FV.none,$jscomp$compprop1[FT.dir]=FV.none,$jscomp$compprop1[FT.file]=FV.none,$jscomp$compprop1[FT.wave]=FV.music,$jscomp$compprop1[FT.flac]=FV.music,$jscomp$compprop1[FT.mp3]=FV.music,$jscomp$compprop1[FT.ogg]=FV.video,$jscomp$compprop1[FT.mp4]=FV.video,$jscomp$compprop1[FT.webm]=FV.video,
$jscomp$compprop1[FT.tga]=FV.image,$jscomp$compprop1[FT.bmp]=FV.image,$jscomp$compprop1[FT.dds]=FV.image,$jscomp$compprop1[FT.tiff]=FV.image,$jscomp$compprop1[FT.jpeg]=FV.image,$jscomp$compprop1[FT.gif]=FV.image,$jscomp$compprop1[FT.png]=FV.image,$jscomp$compprop1[FT.webp]=FV.image,$jscomp$compprop1[FT.psd]=FV.image,$jscomp$compprop1[FT.pdf]=FV.none,$jscomp$compprop1[FT.html]=FV.none,$jscomp$compprop1[FT.text]=FV.none,$jscomp$compprop1[FT.scr]=FV.none,$jscomp$compprop1[FT.cfg]=FV.none,$jscomp$compprop1[FT.log]=
FV.none,$jscomp$compprop1[FT.cab]=FV.none,$jscomp$compprop1[FT.zip]=FV.none,$jscomp$compprop1[FT.rar]=FV.none,$jscomp$compprop1),DS={yellow:3E3,red:1E4},shareprefix="/file/",geticonname=function(a){switch(a.type){case FT.cat:switch(a.cid){case "drives":return"drives";case "shares":return"shares";default:return"folder-close"}case FT.drive:return 0>a.latency?"drive-off":a.latency<DS.yellow?"drive":a.latency<DS.red?"drive-yellow":"drive-red";case FT.dir:var b=app.shrname.length?"-pub":"";if(a.scan){var c=
0;a=a.fgrp;for(var d=$jscomp.makeIterator(a),e=d.next();!e.done;e=d.next())c+=e.value;return c?.5<a[FG.music]/c?"folder-mp3"+b:.5<a[FG.video]/c?"folder-movies"+b:.5<a[FG.image]/c?"folder-photo"+b:.5<a[FG.books]/c?"folder-doc"+b:.5<a[FG.texts]/c?"folder-doc"+b:.5<a[FG.dir]/c?"folder-sub"+b:.5<(a[FG.music]+a[FG.video]+a[FG.image])/c?"folder-media"+b:"folder-empty"+b:"folder-empty"+b}return"folder-close"+b;case FT.wave:return"doc-wave";case FT.flac:return"doc-flac";case FT.mp3:return"doc-mp3";case FT.ogg:return"doc-music";
case FT.mp4:return"doc-mp4";case FT.webm:return"doc-movie";case FT.tga:case FT.bmp:case FT.dds:return"doc-bitmap";case FT.tiff:case FT.jpeg:return"doc-jpeg";case FT.gif:return"doc-gif";case FT.png:return"doc-png";case FT.webp:return"doc-webp";case FT.psd:return"doc-psd";case FT.pdf:return"doc-pdf";case FT.html:return"doc-html";case FT.text:return"doc-text";case FT.scr:return"doc-script";case FT.cfg:return"doc-config";case FT.log:return"doc-log";case FT.cab:return"doc-cab";case FT.zip:return"doc-zip";
case FT.rar:return"doc-rar";default:return"doc-file"}},encode=function(a){return encodeURI(a).replace("#","%23").replace("&","%26").replace("+","%2B")},fileurl=function(a){return"/id"+app.aid+"/file/"+a.puid},pathurl=function(a){return(devmode?"/dev":"")+"/id"+app.aid+"/path/"+a.puid},mediaurl=function(a){return"/id"+app.aid+"/media/"+a.puid},showmsgbox=function(a,b,c){var d=$("#msgbox");d.find(".modal-title").text(a);d.find(".message").text(b);d.find(".details").text(c||"");d.modal("show")},ajaxfail=
function(a){console.error(a.name,a);if(a instanceof SyntaxError)showmsgbox("Syntax error","Application function failed with syntax error in javascript.");else{if(a instanceof HttpError){var b=function(b,d){var c=$("#msgbox");c.find(".modal-title").text(b);c.find(".message").text(d);c.find(".errcode").text(a.code);c.find(".errmsg").text(a.what);c.modal("show")};switch(a.status){case 400:b("Application error","Action is rejected by server. This error is caused by wrong parameters in application ajax-call to server.");
return;case 401:b("Unauthorized","Action can be done only after authorization.");return;case 403:b("404 resource forbidden","Resource referenced by application ajax-call is forbidden. It can be accessible after authorization, or for other authorization.");return;case 404:b("404 resource not found","Resource referenced by application ajax-call is not found on server.");return;case 500:b("Internal server error","Action could not be completed due to an internal error on the server side.");return;default:b("Error "+
a.status,"Action is rejected with HTTP status "+a.status+".")}}showmsgbox("Server unavailable","Server is currently not available, action can not be done now.")}};
Vue.component("auth-tag",{template:"#auth-tpl",data:function(){return{isauth:!1,login:"",password:"",namestate:0,passstate:0}},computed:{clsname:function(){return this.namestate?-1===this.namestate?"is-invalid":"is-valid":""},clspass:function(){return this.passstate?-1===this.passstate?"is-invalid":"is-valid":""}},methods:{onauthchange:function(){this.passstate=this.namestate=0},onlogin:function(){var a=this;(function(){var b,c,d,e,f,k;return $jscomp.asyncExecutePromiseGeneratorProgram(function(g){switch(g.nextAddress){case 1:return ajaxcc.emit("ajax",
1),g.setCatchFinallyBlocks(2,3),g.yield(fetchjson("POST","/api/auth/pubkey"),5);case 5:return b=g.yieldResult,g.yield(b.json(),6);case 6:c=g.yieldResult;traceajax(b,c);if(!b.ok)throw new HttpError(b.status,c);d=sha256.hmac.create(c);d.update(a.password);return g.yield(fetchjson("POST","/api/auth/signin",{name:a.login,pubk:c,hash:d.digest()}),7);case 7:return e=g.yieldResult,g.yield(e.json(),8);case 8:if(f=g.yieldResult,traceajax(e,f),200===e.status)auth.signin(f,a.login),a.namestate=1,a.passstate=
1,a.$emit("refresh");else if(403===e.status)switch(auth.signout(),f.code){case 13:a.namestate=-1;a.passstate=0;break;case 15:a.namestate=1;a.passstate=-1;break;default:a.namestate=-1,a.passstate=-1}else throw new HttpError(e.status,f);case 3:g.enterFinallyBlock();ajaxcc.emit("ajax",-1);g.leaveFinallyBlock(0);break;case 2:k=g.enterCatchBlock(),ajaxfail(k),g.jumpTo(3)}})})()},onlogout:function(){auth.signout();this.passstate=this.namestate=0;this.$emit("refresh")}},mounted:function(){var a=this;this._authclosure=
function(b){if(a.isauth=b)a.login=auth.login};auth.on("auth",this._authclosure)},beforeDestroy:function(){auth.off("auth",this._authclosure)}});
var app=new Vue({el:"#app",template:"#app-tpl",data:{skinlink:"",skinlist:skinlist,showauth:!1,isauth:!1,authid:0,aid:0,loadcount:0,shared:[],histpos:0,histlist:[],route:"path",pathlist:[],filelist:[],curscan:new Date,curpuid:"",curpath:"",curstate:2,shrname:""},computed:{isadmin:function(){return this.isauth||"localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname},curshorturl:function(){return(devmode?"/dev":"")+"/id"+this.aid+"/path/"+this.curpuid},curlongurl:function(){return(devmode?
"/dev":"")+"/id"+this.aid+"/path/"+this.curpath},curbasename:function(){switch(this.route){case "path":var a=this.curpath.split("/"),b=a.pop()||a.pop();return!a.length&&this.shrname||b;case "home":return"home page";case "drive":return"drives list";case "share":return"shares list"}},curpathway:function(){if(!this.curpath)return[];var a=this.curpath.split("/");a.pop()||a.pop();var b=[],c="";a=$jscomp.makeIterator(a);for(var d=a.next();!d.done;d=a.next())d=d.value,c+=d+"/",b.push({name:d,path:c});b.length&&
(b[0].name=this.shrname||b[0].name);return b},uncached:function(){for(var a=[],b=$jscomp.makeIterator(this.filelist),c=b.next();!c.done;c=b.next())c=c.value,c.ntmb||a.push(c);return a},sumsize:function(){for(var a=0,b=$jscomp.makeIterator(this.filelist),c=b.next();!c.done;c=b.next())a+=c.value.size||0;return fmtitemsize(a)},dishome:function(){return"home"===this.route},disback:function(){return 2>this.histpos},disforward:function(){return this.histpos>=this.histlist.length},disparent:function(){return!this.curpathway.length},
textauthcaret:function(){return this.showauth?"arrow_right":"arrow_left"},hintback:function(){if(1<this.histpos){var a=this.histlist[this.histpos-2];switch(a.route){case "path":return"back to /id"+a.aid+"/path/"+a.path;case "home":return"back to home";case "drive":return"back to drives";case "share":return"back to shares"}}return"go back"},hintforward:function(){if(this.histpos<this.histlist.length){var a=this.histlist[this.histpos];switch(a.route){case "path":return"forward to /id"+a.aid+"/path/"+
a.path;case "home":return"forward to home";case "drive":return"forward to drives";case "share":return"forward to shares"}}return"go forward"},hintparent:function(){return this.curpathway.length?this.curpathway.map(function(a){return a.name}).join("/"):"to root folder"},hintauthcaret:function(){return this.showauth?"hide login fields":"show login fields"}},methods:{fetchfolder:function(a){var b=this,c,d,e,f,k,g,h;return $jscomp.asyncExecutePromiseGeneratorProgram(function(l){if(1==l.nextAddress)return l.yield(fetchajaxauth("POST",
"/api/card/folder",{aid:a.aid,puid:a.puid||"",path:a.path||""}),2);c=l.yieldResult;traceajax(c);if(!c.ok)throw new HttpError(c.status,c.data);b.pathlist=[];b.filelist=[];b.$refs.mapcard.new();b.route="path";b.curscan=new Date(Date.now());d=$jscomp.makeIterator(c.data.list||[]);for(e=d.next();!e.done;e=d.next())(f=e.value)&&f.type!==FT.cat&&(0>f.type?b.pathlist.push(f):b.filelist.push(f));b.curpuid=a.puid=c.data.puid;b.curpath=a.path=c.data.path;b.curstate=c.data.state;b.shrname=c.data.shrname;k=[];
g=$jscomp.makeIterator(b.filelist);for(e=g.next();!e.done;e=g.next())h=e.value,h.latitude&&h.longitude&&1===h.ntmb&&k.push(h);b.$refs.mapcard.addmarkers(k);l.jumpToEnd()})},fetchscanthumbs:function(){var a=this,b,c;return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){if(1==d.nextAddress)return a.uncached.length?d.yield(fetchjsonauth("POST","/api/tmb/scn",{aid:a.aid,puids:a.uncached.map(function(a){return a.puid})}),2):d.return();b=d.yieldResult;traceajax(b);if(!b.ok)throw new HttpError(b.status,
b.data);c=a.puid;(function(){var b,d,k,g,h,l,n,m,p;return $jscomp.asyncExecutePromiseGeneratorProgram(function(e){switch(e.nextAddress){case 1:e.setCatchFinallyBlocks(2);case 4:if(c!==a.puid||!a.uncached.length){e.leaveTryBlock(0);break}return e.yield(fetchajaxauth("POST","/api/tmb/chk",{tmbs:a.uncached.map(function(a){return{puid:a.puid}})}),6);case 6:b=e.yieldResult;traceajax(b);if(!b.ok)throw new HttpError(b.status,b.data);d=[];k=$jscomp.makeIterator(b.data.tmbs);for(g=k.next();!g.done;g=k.next())if(h=
g.value,h.ntmb)for(l=$jscomp.makeIterator(a.filelist),n=l.next();!n.done;n=l.next())if(m=n.value,m.puid===h.puid){Vue.set(m,"ntmb",h.ntmb);m.latitude&&m.longitude&&1===m.ntmb&&d.push(m);break}a.$refs.mapcard.addmarkers(d);return e.yield(new Promise(function(a){return setTimeout(a,1500)}),4);case 2:p=e.enterCatchBlock(),ajaxfail(p),e.jumpToEnd()}})})();d.jumpToEnd()})},fetchshared:function(){var a=this,b;return $jscomp.asyncExecutePromiseGeneratorProgram(function(c){if(1==c.nextAddress)return c.yield(fetchajaxauth("POST",
"/api/share/lst",{aid:a.aid}),2);b=c.yieldResult;traceajax(b);if(!b.ok)throw new HttpError(b.status,b.data);a.shared=b.data||[];c.jumpToEnd()})},fetchhome:function(){var a=this,b;return $jscomp.asyncExecutePromiseGeneratorProgram(function(c){if(1==c.nextAddress)return c.yield(fetchajaxauth("POST","/api/card/home",{aid:a.aid}),2);b=c.yieldResult;traceajax(b);if(!b.ok)throw new HttpError(b.status,b.data);a.pathlist=b.data||[];a.filelist=[];a.$refs.mapcard.new();a.route="home";a.curscan=new Date(Date.now());
a.curpuid="";a.curpath="";a.curstate="";a.shrname="";c.jumpToEnd()})},fetchdrivepage:function(){var a=this,b;return $jscomp.asyncExecutePromiseGeneratorProgram(function(c){if(1==c.nextAddress)return c.yield(fetchajaxauth("POST","/api/drive/lst",{aid:a.aid}),2);b=c.yieldResult;traceajax(b);if(!b.ok)throw new HttpError(b.status,b.data);a.pathlist=b.data||[];a.filelist=[];a.$refs.mapcard.new();a.route="drive";a.curscan=new Date(Date.now());a.curpuid="";a.curpath="";a.curstate="";a.shrname="";c.jumpToEnd()})},
fetchsharepage:function(){var a=this,b,c,d,e,f,k,g;return $jscomp.asyncExecutePromiseGeneratorProgram(function(h){if(1==h.nextAddress)return h.yield(fetchajaxauth("POST","/api/share/lst",{aid:a.aid}),2);b=h.yieldResult;traceajax(b);if(!b.ok)throw new HttpError(b.status,b.data);a.pathlist=[];a.filelist=[];a.$refs.mapcard.new();a.route="share";a.curscan=new Date(Date.now());c=$jscomp.makeIterator(b.data||[]);for(d=c.next();!d.done;d=c.next())(e=d.value)&&e.type!==FT.cat&&(0>e.type?a.pathlist.push(e):
a.filelist.push(e));a.curpuid="";a.curpath="";a.curstate="";a.shrname="";a.shared=b.data||[];f=[];k=$jscomp.makeIterator(a.filelist);for(d=k.next();!d.done;d=k.next())g=d.value,g.latitude&&g.longitude&&1===g.ntmb&&f.push(g);a.$refs.mapcard.addmarkers(f);h.jumpToEnd()})},fetchopenroute:function(a){var b=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(c){switch(c.nextAddress){case 1:switch(a.route){case "path":return c.jumpTo(2);case "home":return c.jumpTo(3);case "drive":return c.jumpTo(4);
case "share":return c.jumpTo(5);default:throw Error("try to open undefined route");}case 2:return c.yield(b.fetchfolder(a),7);case 7:return c.yield(b.fetchscanthumbs(),8);case 8:c.jumpTo(6);break;case 3:return c.yield(b.fetchhome(),9);case 9:c.jumpTo(6);break;case 4:return c.yield(b.fetchdrivepage(),10);case 10:c.jumpTo(6);break;case 5:return c.yield(b.fetchsharepage(),11);case 11:return c.yield(b.fetchscanthumbs(),12);case 12:c.jumpTo(6);break;case 6:b.seturl(),c.jumpToEnd()}})},fetchshareadd:function(a){var b=
this,c;return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){if(1==d.nextAddress)return d.yield(fetchajaxauth("POST","/api/share/add",{aid:b.aid,puid:a.puid}),2);c=d.yieldResult;traceajax(c);if(!c.ok)throw new HttpError(c.status,c.data);b.shared.push(a);d.jumpToEnd()})},fetchsharedel:function(a){var b=this,c,d;return $jscomp.asyncExecutePromiseGeneratorProgram(function(e){if(1==e.nextAddress)return e.yield(fetchajaxauth("DELETE","/api/share/del",{aid:b.aid,puid:a.puid}),2);c=e.yieldResult;
traceajax(c);if(!c.ok)throw new HttpError(c.status,c.data);if(c.data)for(d in b.shared)if(b.shared[d].puid===a.puid){b.shared.splice(d,1);break}e.jumpToEnd()})},isshared:function(a){for(var b=$jscomp.makeIterator(this.shared),c=b.next();!c.done;c=b.next())if(c.value.puid===a.puid)return!0;return!1},setskin:function(a){this.skinlink=a;$("#skinlink").attr("href",a);sessionStorage.setItem("skinlink",a)},seturl:function(){var a=this,b=function(){switch(a.route){case "path":return a.curlongurl;case "home":return(devmode?
"/dev":"")+"/id"+a.aid+"/home/";case "drive":return(devmode?"/dev":"")+"/id"+a.aid+"/drive/";case "share":return(devmode?"/dev":"")+"/id"+a.aid+"/share/"}}();window.history.replaceState(null,this.curpath,b)},pushroute:function(a){this.histlist.splice(this.histpos);this.histlist.push(a);this.histpos=this.histlist.length},onhome:function(){var a=this;(function(){var b,c;return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){switch(d.nextAddress){case 1:return ajaxcc.emit("ajax",1),d.setCatchFinallyBlocks(2,
3),b={route:"home",aid:a.aid},d.yield(a.fetchopenroute(b),5);case 5:a.pushroute(b);case 3:d.enterFinallyBlock();ajaxcc.emit("ajax",-1);d.leaveFinallyBlock(0);break;case 2:c=d.enterCatchBlock(),ajaxfail(c),d.jumpTo(3)}})})()},onback:function(){var a=this;(function(){var b,c;return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){if(1==d.nextAddress)return ajaxcc.emit("ajax",1),d.setCatchFinallyBlocks(2,3),a.histpos--,b=a.histlist[a.histpos-1],d.yield(a.fetchopenroute(b),3);if(2!=d.nextAddress)return d.enterFinallyBlock(),
ajaxcc.emit("ajax",-1),d.leaveFinallyBlock(0);c=d.enterCatchBlock();ajaxfail(c);return d.jumpTo(3)})})()},onforward:function(){var a=this;(function(){var b,c;return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){if(1==d.nextAddress)return ajaxcc.emit("ajax",1),d.setCatchFinallyBlocks(2,3),a.histpos++,b=a.histlist[a.histpos-1],d.yield(a.fetchopenroute(b),3);if(2!=d.nextAddress)return d.enterFinallyBlock(),ajaxcc.emit("ajax",-1),d.leaveFinallyBlock(0);c=d.enterCatchBlock();ajaxfail(c);return d.jumpTo(3)})})()},
onparent:function(){var a=this;(function(){var b,c,d;return $jscomp.asyncExecutePromiseGeneratorProgram(function(e){switch(e.nextAddress){case 1:return ajaxcc.emit("ajax",1),e.setCatchFinallyBlocks(2,3),b=a.curpathway.length?a.curpathway[a.curpathway.length-1].path:"",c={route:"home",aid:a.aid,path:b},e.yield(a.fetchopenroute(c),5);case 5:a.pushroute(c);case 3:e.enterFinallyBlock();ajaxcc.emit("ajax",-1);e.leaveFinallyBlock(0);break;case 2:d=e.enterCatchBlock(),ajaxfail(d),e.jumpTo(3)}})})()},onrefresh:function(){var a=
this;(function(){var b;return $jscomp.asyncExecutePromiseGeneratorProgram(function(c){switch(c.nextAddress){case 1:return ajaxcc.emit("ajax",1),c.setCatchFinallyBlocks(2,3),c.yield(a.fetchopenroute({route:a.route,aid:a.aid,path:a.curpath}),5);case 5:if(!a.isauth||"share"===a.route){c.jumpTo(3);break}return c.yield(a.fetchshared(),3);case 3:c.enterFinallyBlock();ajaxcc.emit("ajax",-1);c.leaveFinallyBlock(0);break;case 2:b=c.enterCatchBlock(),ajaxfail(b),c.jumpTo(3)}})})()},onshare:function(a){var b=
this;(function(){var c;return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){if(1==d.nextAddress)return ajaxcc.emit("ajax",1),d.setCatchFinallyBlocks(2,3),b.isshared(a)?d.yield(b.fetchsharedel(a),3):d.yield(b.fetchshareadd(a),3);if(2!=d.nextAddress)return d.enterFinallyBlock(),ajaxcc.emit("ajax",-1),d.leaveFinallyBlock(0);c=d.enterCatchBlock();ajaxfail(c);return d.jumpTo(3)})})()},onpathopen:function(a){var b=this;(!a.latency||0<a.latency)&&function(){var c,d;return $jscomp.asyncExecutePromiseGeneratorProgram(function(e){switch(e.nextAddress){case 1:ajaxcc.emit("ajax",
1);e.setCatchFinallyBlocks(2,3);c={route:"path",aid:b.aid,puid:a.puid||"",path:a.path||""};if(a.type===FT.cat)switch(a.cid){case "drives":c.route="drive";break;case "shares":c.route="share";break;default:return e.return()}return e.yield(b.fetchopenroute(c),5);case 5:b.pushroute(c);case 3:e.enterFinallyBlock();ajaxcc.emit("ajax",-1);e.leaveFinallyBlock(0);break;case 2:d=e.enterCatchBlock(),ajaxfail(d),e.jumpTo(3)}})}()},onauthcaret:function(){this.showauth=!this.showauth}},mounted:function(){var a=
this;this.skinlink=sessionStorage.getItem("skinlink")||"/data/skin/neon.css";$("#skinlink").attr("href",this.skinlink);auth.on("auth",function(b){(a.isauth=b)&&(b=auth.claims())&&"aid"in b&&(a.authid=b.aid,a.aid=b.aid)});ajaxcc.on("ajax",function(b){return a.loadcount+=b});auth.signload();this.login=auth.login;devmode&&this.isauth&&(console.log("token:",auth.token),console.log("login:",auth.login));var b=decodeURI(window.location.pathname).split("/");b.shift();0<b[b.length-1].length&&b.push("");"dev"===
b[0]&&b.shift();"id"===b[0].substr(0,2)?(this.aid=Number(b[0].substr(2)),b.shift()):this.aid=0;var c=b[0]||"home";b.shift();(function(){var d,e;return $jscomp.asyncExecutePromiseGeneratorProgram(function(f){switch(f.nextAddress){case 1:return ajaxcc.emit("ajax",1),f.setCatchFinallyBlocks(2,3),d={route:c,aid:a.aid,path:b.join("/")},f.yield(a.fetchopenroute(d),5);case 5:if(!a.isauth||"share"===c){f.jumpTo(6);break}return f.yield(a.fetchshared(),6);case 6:a.pushroute(d);case 3:f.enterFinallyBlock();
ajaxcc.emit("ajax",-1);f.leaveFinallyBlock(0);break;case 2:e=f.enterCatchBlock(),ajaxfail(e),f.jumpTo(3)}})})()}});$(document).ready(function(){$(".preloader-lock").hide("fast");$("#app").show("fast")});
